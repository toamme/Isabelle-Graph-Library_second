%
\begin{isabellebody}%
\setisabellecontext{Usage{\isacharunderscore}{\kern0pt}Capacitated}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Flows in Multigraphs with Capacities%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Usage{\isacharunderscore}{\kern0pt}Capacitated\isanewline
\ \ \isakeywordTWO{imports}\ Instantiation\ \isanewline
\ \ \ \ \ \ \ \ \ \ Flow{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}Hitchcock{\isacharunderscore}{\kern0pt}Reduction\ Flow{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}STFlow\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\ \ \isakeywordONE{instantiation}\isamarkupfalse%
\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}linorder{\isacharcomma}{\kern0pt}\ linorder{\isacharparenright}{\kern0pt}\ linorder\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymge}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}vertex\ u{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u\ {\isasymge}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isachargreater}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}vertex\ u{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u\ {\isachargreater}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}vertex\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}\isanewline
\isakeywordONE{instance}\isamarkupfalse%
\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ Orderings{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}class\ \ class{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}order{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}preorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}linorder{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ auto\ \isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ z\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ z{\isacartoucheclose}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ a\ b\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ a{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ b{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\ \isakeywordONE{instantiation}\isamarkupfalse%
\ hitchcock{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}linorder{\isacharcomma}{\kern0pt}\ linorder{\isacharparenright}{\kern0pt}\ linorder\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}outedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}outedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymle}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymle}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vtovedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymle}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dummy\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}outedge\ e{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}outedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}outedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}outedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isacharless}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isacharless}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vtovedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isacharless}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dummy\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}outedge\ e{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}outedge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}inedge\ e{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}dummy\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{instance}\isamarkupfalse%
\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ Orderings{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}class\ \ class{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}order{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}preorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}linorder{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ x\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ x\ y\ z{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ z{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metis\ order{\isachardot}{\kern0pt}trans{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ x\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metis\ nle{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{5}}\ x\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ with{\isacharunderscore}{\kern0pt}capacity\ {\isacharequal}{\kern0pt}\isanewline
\isakeywordTWO{fixes}\ fst{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ snd{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ list{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}type{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymtimes}\ ereal{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymtimes}\ real{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ option{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}filter\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}filter\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ map\ inedge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ map\ outedge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}vtovedge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharat}{\kern0pt}{\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharat}{\kern0pt}{\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ c\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ e\ of\ inedge\ d\ {\isasymRightarrow}\ Some\ {\isadigit{0}}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outedge\ d\ {\isasymRightarrow}\ c{\isacharunderscore}{\kern0pt}lookup\ c\ d\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vtovedge\ d\ {\isasymRightarrow}\ c{\isacharunderscore}{\kern0pt}lookup\ c\ d\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dummy\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharunderscore}{\kern0pt}lifted\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ tree{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}vertex{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}vs\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ Leaf{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}\ vertices{\isacharunderscore}{\kern0pt}done\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ let\ u\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ xy{\isacharparenright}{\kern0pt}\ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ tree\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}ereal\ u{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite\ b{\isacharunderscore}{\kern0pt}lifted{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite\ vertices{\isacharunderscore}{\kern0pt}done{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap\ {\isacharequal}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\ {\isacharequal}{\kern0pt}\ \ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ finite{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ foldr\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\ {\isacharparenleft}{\kern0pt}outedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite\ flow{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ in\ \ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\ {\isacharparenleft}{\kern0pt}vtovedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty\ finite{\isacharunderscore}{\kern0pt}flow\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ dom{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ dom{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ dom{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}lookup\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}AS\ T{\isacharparenright}{\kern0pt}\ e\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ e\ {\isasymin}\ set\ AS\ then\ Some\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ else\ flow{\isacharunderscore}{\kern0pt}lookup\ T\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ AS{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ b{\isacharprime}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}general{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ES\ T{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ x\ of\ edge\ e\ {\isasymRightarrow}\ if\ e\ {\isasymin}\ set\ ES\ then\ Some\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ else\ bal{\isacharunderscore}{\kern0pt}lookup\ T\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ T\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ES{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ES\ T{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ if\ e\ {\isasymin}\ set\ ES\ then\ Some\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ else\ bal{\isacharunderscore}{\kern0pt}lookup\ T\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ES{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs\ {\isacharequal}{\kern0pt}\isanewline
with{\isacharunderscore}{\kern0pt}capacity\ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}fst{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ \isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}\ fst\isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\isakeywordTWO{and}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isasymE}\isanewline
\isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\isanewline
\isakeywordTWO{and}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ {\isasymc}\isanewline
\isanewline
\isakeywordTWO{for}\ fst\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}\ {\isasymu}\ {\isasymc}{\isacharplus}{\kern0pt}\isanewline
\isakeywordTWO{fixes}\ {\isasymb}\isanewline
\isakeywordTWO{assumes}\ c{\isacharunderscore}{\kern0pt}domain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymE}\ {\isasymsubseteq}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ \ \ \ u{\isacharunderscore}{\kern0pt}domain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ \ \ \ b{\isacharunderscore}{\kern0pt}domain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymV}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ \ \ \ \ \ Es{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymE}\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ cs{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymc}\ {\isacharequal}{\kern0pt}\ the\ o\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ us{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymu}\ {\isacharequal}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ PInfty\ o\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ bs{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymb}\ {\isacharequal}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ o\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty\ {\isacharequal}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ \ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}filter\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite\ {\isacharequal}{\kern0pt}\ {\isasymE}\ {\isacharminus}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}filter\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}gen\ {\isasymE}\ {\isasymu}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}gen\ {\isasymE}\ {\isasymu}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}gen\ {\isasymE}\ {\isasymu}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Es{\isacharunderscore}{\kern0pt}are\ b{\isacharunderscore}{\kern0pt}domain\ E{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ \ multigraph{\isacharunderscore}{\kern0pt}axioms\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}axioms{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}N{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}axioms{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b\ \ domD\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es\ {\isacharequal}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es{\isacharbrackleft}{\kern0pt}OF\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OF\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}es{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}axioms{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}Are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}vs\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymV}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}def\ vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}def\ dVs{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}image\ vertex{\isachardoublequoteclose}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymUnion}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ OF\ refl{\isacharbrackright}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isasymUnion}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ OF\ refl{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}listed{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharunderscore}{\kern0pt}lifted{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ dom{\isacharunderscore}{\kern0pt}fold{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ vs{\isacharunderscore}{\kern0pt}Are\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ pre{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}vertex\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ T{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}case\ x\ of\ edge\ edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ T\ x\ {\isacharbar}{\kern0pt}\ vertex\ y\ {\isasymRightarrow}\ if\ y\ {\isasymin}\ set\ xs\ then\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ else\ \ bal{\isacharunderscore}{\kern0pt}lookup\ T\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharunderscore}{\kern0pt}lifted\ x\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ x\ of\ vertex\ y\ {\isasymRightarrow}\ if\ y\ {\isasymin}\ {\isasymV}\ then\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ None\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ \ pre{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ \ vs{\isacharunderscore}{\kern0pt}Are\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}OF\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ vertices{\isacharunderscore}{\kern0pt}done{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ bs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}invar\ bs\ {\isasymLongrightarrow}\ distinct\ ES\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}xy\ tree{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ let\ u\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ xy{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ in\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ tree\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}ereal\ u{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ES\ bs{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}case\ x\ of\ vertex\ u\ {\isasymRightarrow}\ Some\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ bs\ {\isacharparenleft}{\kern0pt}vertex\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharminus}{\kern0pt}\ \ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ \ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ES\ {\isasymand}\ u\ {\isacharequal}{\kern0pt}\ fst\ e{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
{\isacharbar}{\kern0pt}\ \ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ bs\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ES{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ ES{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ minus{\isacharunderscore}{\kern0pt}distr{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ add{\isachardot}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ sym{\isacharbrackleft}{\kern0pt}OF\ sum{\isachardot}{\kern0pt}insert{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}force\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ uminus{\isacharcomma}{\kern0pt}\ OF\ refl{\isacharbrackright}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sum\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ OF\ refl{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ metis{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ b{\isacharunderscore}{\kern0pt}lifted{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ simp\ add{\isacharcolon}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}def\ \ \ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ PInfty\ {\isasymcirc}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms\ us{\isacharunderscore}{\kern0pt}are\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ \ {\isasymV}\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}lookup\ vertices{\isacharunderscore}{\kern0pt}done\ {\isacharparenleft}{\kern0pt}vertex\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharparenleft}{\kern0pt}{\isasymb}\ x\ {\isacharminus}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}ereal\ o\ {\isasymu}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}delta{\isacharunderscore}{\kern0pt}plus\ \ x{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}delta{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}infty\ \ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ vertices{\isacharunderscore}{\kern0pt}done{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ vertices{\isacharunderscore}{\kern0pt}done{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}listed\ \ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{3}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ b{\isacharunderscore}{\kern0pt}domain\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}lifted{\isacharunderscore}{\kern0pt}lookup\ bs{\isacharunderscore}{\kern0pt}are\ us{\isacharunderscore}{\kern0pt}are{\isacharcomma}{\kern0pt}\ unfold\ delta{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}delta{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ x{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ blast{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}intro\ sum{\isacharunderscore}{\kern0pt}cong{\isacharunderscore}{\kern0pt}extensive{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ Es{\isacharunderscore}{\kern0pt}are\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ delta{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ vertices{\isacharunderscore}{\kern0pt}done{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}V\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ vertices{\isacharunderscore}{\kern0pt}done{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}fold\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted\ dom{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}listed\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ vertices{\isacharunderscore}{\kern0pt}done{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}lifted\ vertices{\isacharunderscore}{\kern0pt}done{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}\ {\isasymunion}\ edge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ bal{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}fold{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ dom{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ us{\isacharunderscore}{\kern0pt}are\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}\ {\isasymunion}\ edge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ infty{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ the\ {\isacharparenleft}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}gen\ fst\ {\isasymE}\ {\isasymu}\ {\isasymb}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are\ \ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}done\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b{\isacharprime}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}general\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ old{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ {\isasymE}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ old{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen\ {\isasymE}\ {\isasymu}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap{\isacharparenright}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ old{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ \ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}sym{\isacharbrackleft}{\kern0pt}OF\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are{\isacharcomma}{\kern0pt}\ simplified\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ \ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ finite{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ distinct{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}filter\ distinct{\isacharunderscore}{\kern0pt}filter\ simp\ add{\isacharcolon}{\kern0pt}\ distinct{\isacharunderscore}{\kern0pt}map\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ \ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ V{\isacharunderscore}{\kern0pt}new{\isacharunderscore}{\kern0pt}graph{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dVs\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}\ {\isasymunion}\ edge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ {\isasymE}\isactrlsub {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymnotin}\ edge\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ {\isasyminfinity}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ vertex\ {\isacharbackquote}{\kern0pt}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ edge\ e\ {\isasymor}\ x\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ edge\ e{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ case{\isacharunderscore}{\kern0pt}simp{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ dVs{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ imageI\ intro{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymnotin}\ edge\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ {\isasyminfinity}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ vertex\ {\isacharbackquote}{\kern0pt}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ edge\ e\ {\isasymor}\ x\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ edge\ e{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ case{\isacharunderscore}{\kern0pt}simp{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ dVs{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ imageI\ intro{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{3}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymnotin}\ edge\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ {\isasyminfinity}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ vertex\ {\isacharbackquote}{\kern0pt}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\isanewline
\ \ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{3}}{\isacharequal}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ {\isachardoublequoteopen}\ x\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isasymor}\ x\ {\isacharequal}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ dVs{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ imageI\ intro{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{4}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}vertex\ xa\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymnotin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ vertex\ xa\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymnotin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ xa\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ vertex\ xa\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ xa\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{4}}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ e{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}xa\ {\isacharequal}{\kern0pt}\ fst\ e\ {\isasymor}\ xa\ {\isacharequal}{\kern0pt}\ snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}e\ {\isasymin}\ \ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ disjE{\isacharbrackleft}{\kern0pt}OF\ e{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ e{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ e{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ e{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{2}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ e{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{5}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}edge\ e\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymnotin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ edge\ e\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymnotin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vertex\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ edge\ e\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymnotin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edge\ x{\isacharcomma}{\kern0pt}\ vertex\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ the{\isacharunderscore}{\kern0pt}default\ {\isasyminfinity}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{5}}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{5}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{5}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}dVs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}e\ {\isasymin}\ dom{\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ Es{\isacharunderscore}{\kern0pt}are\ {\isadigit{5}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ \ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ \ new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ image{\isacharunderscore}{\kern0pt}Un\ image{\isacharunderscore}{\kern0pt}comp\ Es{\isacharunderscore}{\kern0pt}are\ us{\isacharunderscore}{\kern0pt}are\ intro{\isacharcolon}{\kern0pt}\ {\isadigit{1}}\ {\isadigit{2}}\ {\isadigit{3}}\ {\isadigit{4}}\ {\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ filter{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}filter\ P\ xs\ {\isacharequal}{\kern0pt}\ ys\ {\isasymLongrightarrow}\ filter\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isasymnot}\ P\ x{\isacharparenright}{\kern0pt}\ xs\ {\isacharequal}{\kern0pt}\ zs\ \isanewline
\ \ \ \ \ \ {\isasymLongrightarrow}\ ys\ {\isacharequal}{\kern0pt}\ \ \ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymLongrightarrow}\ zs\ \ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymLongrightarrow}\ xs\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ys{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}induction\ xs{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}meson\ list{\isachardot}{\kern0pt}discI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ E{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ filter{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}E{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}multigraph\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}E{\isacharprime}{\kern0pt}\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ multigraph{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ collapse{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}ofE{\isadigit{1}}E{\isadigit{2}}E{\isadigit{3}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl\ {\isasymunion}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl\ {\isasymunion}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Un{\isacharunderscore}{\kern0pt}assoc\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ inedge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ {\isasymE}\isactrlsub {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ outedge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ {\isasymE}\isactrlsub {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ vtovedge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ {\isasymE}\isactrlsub {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ infty{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}red{\isacharcolon}{\kern0pt}\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo\isanewline
\ \ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}{\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}{\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ \ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen\isanewline
\isakeywordTWO{and}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E{\isacharprime}{\kern0pt}\ \ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ \ b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom\ V{\isacharunderscore}{\kern0pt}new{\isacharunderscore}{\kern0pt}graph\ \ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt\ \ multigraph{\isacharprime}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}N{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}cost{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymLongrightarrow}\ e\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}domain\ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\isanewline
dom{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ image{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ inedge\ {\isacharbackquote}{\kern0pt}\ UNIV\ {\isasymunion}\ vtovedge\ {\isacharbackquote}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isasymunion}\ outedge\ {\isacharbackquote}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}rule{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}outedge\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ outedge\ c{\isacharunderscore}{\kern0pt}domain\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}inedge\ x{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}vtovedge\ x{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x{\isadigit{3}}\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vtovedge\ c{\isacharunderscore}{\kern0pt}domain\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}dummy\ x{\isadigit{4}}{\isadigit{1}}\ x{\isadigit{4}}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}domain\ \isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ dom{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ image{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymLongrightarrow}\ the\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}{\isasymc}{\isacharunderscore}{\kern0pt}gen\ D\ fst\ {\isasymE}\ {\isasymu}\ {\isasymc}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ cs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}{\isasymc}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ new{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}c{\isacharunderscore}{\kern0pt}unfold{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}{\isasymc}{\isacharunderscore}{\kern0pt}gen\ {\isacharparenleft}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ fst\ {\isasymE}\ {\isasymu}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}{\isasymc}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymc}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}cost{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ \ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup{\isacharbrackleft}{\kern0pt}of\ e\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}Some{\isacharunderscore}{\kern0pt}theE{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \isakeywordONE{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}domain\ \ \ \ \isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\ cs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sym{\isacharbrackleft}{\kern0pt}OF\ collapse{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}ofE{\isadigit{1}}E{\isadigit{2}}E{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simplified\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymc}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ new{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ vertex\ {\isacharbackquote}{\kern0pt}\ {\isasymV}\ {\isasymunion}\ edge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isacharminus}{\kern0pt}\ {\isasymE}\isactrlsub {\isasyminfinity}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ new{\isacharunderscore}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}gen\ fst\ {\isasymE}\ {\isasymu}\ {\isasymb}\ x\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymb}\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ x\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ \ b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}lookup\ b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}simplified\ dom{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}gen\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ hitchcock{\isacharunderscore}{\kern0pt}edge{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{context}\isamarkupfalse%
\isanewline
\isakeywordTWO{assumes}\ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}cycle\ make{\isacharunderscore}{\kern0pt}pair\ {\isasymE}\ {\isasymc}\ {\isasymu}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}reduction{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}condI{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ C{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymc}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycleI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ C{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ add{\isachardot}{\kern0pt}commute{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}cycle\ local{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isasymE}\ {\isasymc}\ {\isasymu}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ sym{\isacharbrackleft}{\kern0pt}OF\ reduction{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}mincost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}general{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isasymc}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ \ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ \ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ \ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ collapse{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}ofE{\isadigit{1}}E{\isadigit{2}}E{\isadigit{3}}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}c{\isacharunderscore}{\kern0pt}unfold\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Es{\isacharunderscore}{\kern0pt}are\ cs{\isacharunderscore}{\kern0pt}are\ {\isasymc}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{corollary}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}success{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ success\ {\isasymLongrightarrow}\ \ \isanewline
\ \ \ \ \ \ \ \ is{\isacharunderscore}{\kern0pt}Opt\ {\isasymb}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}old{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen\ {\isasymE}\ {\isasymu}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharcomma}{\kern0pt}\ OF\ \ old{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}cong\ refl{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ reduction{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}mincost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}general{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms\ refl{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isasymc}\ {\isasymb}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ collapse{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}ofE{\isadigit{1}}E{\isadigit{2}}E{\isadigit{3}}\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ \ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ new{\isacharunderscore}{\kern0pt}gen{\isacharunderscore}{\kern0pt}c{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ V{\isacharunderscore}{\kern0pt}new{\isacharunderscore}{\kern0pt}graph\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}reduction\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ refl\ sym{\isacharbrackleft}{\kern0pt}OF\ new{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}cong{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}OF\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}red{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}axioms{\isacharcomma}{\kern0pt}\ of\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simplified\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\ {\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{corollary}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}infeasible{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ infeasible\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isasymnexists}\ f{\isachardot}{\kern0pt}\ isbflow\ \ f\ {\isasymb}\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ nexistsI{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}gen\ fst\ {\isasymE}\ {\isasymu}\ \ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymb}\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ V{\isacharunderscore}{\kern0pt}new{\isacharunderscore}{\kern0pt}graph\ \ \ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ reduction{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}mincost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}hitchcock{\isacharunderscore}{\kern0pt}general{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}cong\ \isanewline
\ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{1}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{2}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ E{\isadigit{3}}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}\ collapse{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}ofE{\isadigit{1}}E{\isadigit{2}}E{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}fstv{\isacharunderscore}{\kern0pt}gen\ fst{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}sndv{\isacharunderscore}{\kern0pt}gen\ fst\ snd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ \ f\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymb}\ {\isasymb}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}reduction\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}OF\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}red{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}axioms{\isacharcomma}{\kern0pt}\ of\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simplified\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{corollary}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap\ {\isacharequal}{\kern0pt}\ notyetterm\ {\isasymLongrightarrow}\ \ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}reduction\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}OF\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}red{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}axioms{\isacharcomma}{\kern0pt}\ of\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ \ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation\ {\isacharequal}{\kern0pt}\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}success\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}infeasible\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case\isanewline
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}capacity\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ \ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}capacity{\isacharcolon}{\kern0pt}\ with{\isacharunderscore}{\kern0pt}capacity\isanewline
\ \ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}\ fst\isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup\isanewline
\isakeywordTWO{for}\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\isanewline
\isakeywordTWO{defines}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}capacity{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\isanewline
\isakeywordTWO{and}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}capacity{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap\isanewline
\isakeywordTWO{and}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}capacity{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ \isanewline
%
\isadelimproof
\isanewline
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ \ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{2}}{\isadigit{8}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isadigit{3}}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isadigit{3}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isadigit{6}}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}list\ Leaf{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}c{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}list\ Leaf{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}u{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isadigit{0}}{\isadigit{8}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{4}}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}list\ Leaf{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap\ fst\ snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ flow{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}cap\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ flow{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ fst\ snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ flow{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}inorder\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ fst\ snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{instantiation}\isamarkupfalse%
\ edge{\isacharunderscore}{\kern0pt}wrapper{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ linorder\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ edge{\isacharunderscore}{\kern0pt}wrapper\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ edge{\isacharunderscore}{\kern0pt}wrapper\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymle}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isasymle}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ edge{\isacharunderscore}{\kern0pt}wrapper\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ edge{\isacharunderscore}{\kern0pt}wrapper\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isacharless}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\ {\isacharless}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{instance}\isamarkupfalse%
\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ Orderings{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}class\ \ class{\isachardot}{\kern0pt}linorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}order{\isachardot}{\kern0pt}intro\ class{\isachardot}{\kern0pt}preorder{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ class{\isachardot}{\kern0pt}linorder{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ z\isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ x{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ y{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ z{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ a\ b\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ a{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ b{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ a\ b\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}cases\ a{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}cases\ b{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{datatype}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}dummy\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}dummy\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ solve{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\isanewline
\isakeywordTWO{fixes}\ fst{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ snd{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ list{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymtimes}\ ereal{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ s{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\isanewline
\isakeywordTWO{and}\ t{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ old{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}dummy{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ c\ {\isacharparenleft}{\kern0pt}e{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ edge{\isacharunderscore}{\kern0pt}wrapper{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ Some\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ Some\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ tree{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\ x\ {\isadigit{0}}\ tree{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vs\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ Leaf{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}u{\isacharunderscore}{\kern0pt}sum\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ acc{\isachardot}{\kern0pt}\ acc\ {\isacharplus}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}sum\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ Leaf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap\ \isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ fst\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ fst\ e{\isacharparenright}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ snd\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ snd\ e{\isacharparenright}{\kern0pt}\isanewline
{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ \ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original\ \isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ fst\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ fst\ e{\isacharparenright}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ snd\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ snd\ e{\isacharparenright}{\kern0pt}\isanewline
{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ flow{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ solve{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}orlins{\isacharcolon}{\kern0pt}\ solve{\isacharunderscore}{\kern0pt}maxflow\ \isakeywordTWO{where}\isanewline
\ \ \ \ fst\ {\isacharequal}{\kern0pt}\ fst\ \isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ s\ {\isacharequal}{\kern0pt}\ s\isanewline
\isakeywordTWO{and}\ t\ {\isacharequal}{\kern0pt}\ t\isanewline
\isakeywordTWO{for}\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ s\ t\isanewline
\isakeywordTWO{defines}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ solve{\isacharunderscore}{\kern0pt}maxflow{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\isanewline
\isakeywordTWO{and}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ solve{\isacharunderscore}{\kern0pt}maxflow{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\isanewline
\isakeywordTWO{and}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\ {\isacharequal}{\kern0pt}\ solve{\isacharunderscore}{\kern0pt}maxflow{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ capacity{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ fst\ snd\ make{\isacharunderscore}{\kern0pt}pair\ u\ c\ E\ b\ f\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\ \ \isakeywordTWO{assumes}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ \ fst\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ u\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ \ fst\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ u{\isacharprime}{\kern0pt}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ E\ {\isasymLongrightarrow}\ u\ e\ {\isacharequal}{\kern0pt}\ u{\isacharprime}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt\ fst\ snd\ \ u\ E\ c\ b\ f{\isachardoublequoteclose}\ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt\ fst\ snd\ \ u{\isacharprime}{\kern0pt}\ E\ c\ b\ f{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isuflow{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ capacity{\isacharunderscore}{\kern0pt}bflow{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ fst\ snd\ make{\isacharunderscore}{\kern0pt}pair\ u\ c\ E\ b\ f\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\ \ \isakeywordTWO{assumes}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network\ \ fst\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ u\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network\ \ fst\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ u{\isacharprime}{\kern0pt}\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ E\ {\isasymLongrightarrow}\ u\ e\ {\isacharequal}{\kern0pt}\ u{\isacharprime}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst\ snd\ \ E\ u\ \ b\ f{\isachardoublequoteclose}\ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst\ snd\ \ E\ u{\isacharprime}{\kern0pt}\ b\ f{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow{\isacharunderscore}{\kern0pt}def\ \ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isuflow{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ solve{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}proofs\ {\isacharequal}{\kern0pt}\isanewline
solve{\isacharunderscore}{\kern0pt}maxflow\ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}fst{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}snd{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ \isanewline
\isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
flow{\isacharunderscore}{\kern0pt}network\ \isakeywordTWO{where}\ fst\ {\isacharequal}{\kern0pt}\ fst\isanewline
\isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\isanewline
\isakeywordTWO{and}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isasymE}\isanewline
\isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\isanewline
\isanewline
\isakeywordTWO{for}\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}\ {\isasymu}{\isacharplus}{\kern0pt}\isanewline
\isakeywordTWO{assumes}\ \ u{\isacharunderscore}{\kern0pt}domain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ Es{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymE}\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ us{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymu}\ {\isacharequal}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ PInfty\ o\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{assumes}\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{assumes}\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{assumes}\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ the\ o\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}dummy{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}default\ PInfty\ o\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cap{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ foldr{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old{\isacharunderscore}{\kern0pt}edge{\isacharcomma}{\kern0pt}\ simplified\ comp{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ intro{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ dom{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}capacity{\isachardot}{\kern0pt}dom{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ abstract{\isacharunderscore}{\kern0pt}flows{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\ {\isacharequal}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}def\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}multigraph\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isasymcirc}\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isasymcirc}\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}intro\ simp\ add{\isacharcolon}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}E\ \ fst{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ snd{\isacharunderscore}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}pos\ u{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}neg\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ \ split{\isacharcolon}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}u{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ \ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ dom{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}insert{\isacharbrackleft}{\kern0pt}simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharbrackleft}{\kern0pt}simplified\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ {\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymV}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ dVs{\isacharunderscore}{\kern0pt}eq\ dVs{\isacharunderscore}{\kern0pt}swap\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vs{\isacharunderscore}{\kern0pt}def\ \ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}es{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}specs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}fold\ \ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image{\isacharunderscore}{\kern0pt}comp\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}invar{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ distinct{\isacharunderscore}{\kern0pt}map\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}u{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ u\ {\isasymLongrightarrow}\ {\isasymu}\ e\ {\isacharequal}{\kern0pt}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ old{\isacharunderscore}{\kern0pt}edge{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simplified\ comp{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ old{\isacharunderscore}{\kern0pt}edge\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ \ \ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}u{\isacharunderscore}{\kern0pt}sum\ {\isacharequal}{\kern0pt}\ sum\ {\isasymu}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}E\ \ u{\isacharunderscore}{\kern0pt}domain\ us{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ distinct{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}force\ intro{\isacharcolon}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}cong\ simp\ add{\isacharcolon}{\kern0pt}\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ \ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ u\ {\isasymLongrightarrow}\ sum\ {\isasymu}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ e\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ old{\isacharunderscore}{\kern0pt}edge{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simplified\ comp{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}is\ \ image{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\ \isanewline
{\isachardoublequoteopen}with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharunderscore}{\kern0pt}axioms\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ o\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ o\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ x\ {\isasymRightarrow}\ {\isadigit{0}}\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}u{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ \ same{\isacharunderscore}{\kern0pt}Vs{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharbrackleft}{\kern0pt}OF\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ set{\isacharunderscore}{\kern0pt}invar{\isacharprime}{\kern0pt}\ \ bal{\isacharunderscore}{\kern0pt}invar{\isacharprime}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}u\ u{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sum\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ split{\isacharcolon}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs\ snd{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ fst{\isacharprime}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}b{\isachardot}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharprime}{\kern0pt}\ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}intro\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\ \ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}wrapper\ {\isasymu}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}b{\isachardot}{\kern0pt}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharprime}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}pos\ u{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}neg\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ split{\isacharcolon}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\isanewline
\ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharunderscore}{\kern0pt}\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isacharprime}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharprime}{\kern0pt}\ u{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}pos\ u{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}neg\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ split{\isacharcolon}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\isanewline
\ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ capacity{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ dom{\isacharunderscore}{\kern0pt}u{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ \ in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cap\ u{\isacharunderscore}{\kern0pt}domain\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ \ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymE}{\isacharprime}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ {\isasymE}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharprime}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}Vs{\isacharbrackleft}{\kern0pt}OF\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ o{\isacharunderscore}{\kern0pt}apply\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ \ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ \ \ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}def\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}es{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ function{\isacharunderscore}{\kern0pt}generation{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ dVs{\isacharunderscore}{\kern0pt}eq\ \ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ \ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ image{\isacharunderscore}{\kern0pt}Un\ image{\isacharunderscore}{\kern0pt}comp\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ lookup{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ capacity{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}rewrite{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}the{\isacharunderscore}{\kern0pt}default\ PInfty\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cap\ dom{\isacharunderscore}{\kern0pt}u{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}impl\ u{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sum\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{context}\isamarkupfalse%
\isanewline
\ \ \isakeywordTWO{assumes}\ no{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymnot}\ has{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}st{\isacharunderscore}{\kern0pt}path\ make{\isacharunderscore}{\kern0pt}pair\ {\isasymE}\ {\isasymu}\ s\ t{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}cycle\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ not{\isacharunderscore}{\kern0pt}has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}cycleI{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ D{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ top{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ D\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymc}{\isacharprime}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ D\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}closed{\isacharunderscore}{\kern0pt}w\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ D{\isachardot}{\kern0pt}\ {\isasymu}{\isacharprime}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ D{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ top{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ D{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ D{\isadigit{1}}\ D{\isadigit{2}}\ \isakeywordTWO{where}\ D{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}D\ {\isacharequal}{\kern0pt}\ D{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}D{\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ set\ D{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ single{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}append\ split{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}first{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ u\ \isakeywordTWO{where}\ u{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ u\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}D{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}D{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ length\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}D{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}D{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ top{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ closed{\isacharunderscore}{\kern0pt}w{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}u{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ u\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ D{\isadigit{1}}{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}Cons{\isacharunderscore}{\kern0pt}iff\ \ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ D{\isadigit{2}}{\isadigit{1}}\ D{\isadigit{2}}{\isadigit{2}}\ \isakeywordTWO{where}\ D{\isadigit{2}}{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}D{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ D{\isadigit{2}}{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ set\ D{\isadigit{2}}{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ append{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}neutral\ append{\isacharunderscore}{\kern0pt}Cons\ split{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}last{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}u{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ D{\isadigit{2}}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ u{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}Cons{\isacharunderscore}{\kern0pt}iff\ \ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}u{\isacharunderscore}{\kern0pt}t\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}\ {\isacharat}{\kern0pt}\ D{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ old{\isacharunderscore}{\kern0pt}edge\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}e\ {\isasymnoteq}\ new{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ t\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ D{\isacharunderscore}{\kern0pt}prop\ D{\isadigit{2}}{\isacharunderscore}{\kern0pt}prop\ top{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}\ {\isacharat}{\kern0pt}\ D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge{\isacharbrackleft}{\kern0pt}OF\ in{\isacharunderscore}{\kern0pt}E{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}nil{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}\ {\isasymnoteq}\ Nil{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}nil\ \ in{\isacharunderscore}{\kern0pt}E\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ same{\isacharunderscore}{\kern0pt}path{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ subset{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}awalk{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ awalk{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isasymu}\ e\ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ set\ D{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E\ D{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ D{\isadigit{2}}{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ top{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}\ Es{\isacharunderscore}{\kern0pt}are\ path{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cap{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ the{\isacharunderscore}{\kern0pt}default{\isacharunderscore}{\kern0pt}def\ us{\isacharunderscore}{\kern0pt}are\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ Es{\isacharunderscore}{\kern0pt}are\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}st{\isacharunderscore}{\kern0pt}path\ local{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isasymE}\ {\isasymu}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}nil\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}st{\isacharunderscore}{\kern0pt}pathI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}map\ get{\isacharunderscore}{\kern0pt}old{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}D{\isadigit{2}}{\isadigit{2}}{\isacharat}{\kern0pt}D{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}path\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ capacity{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}rewrite\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}success{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ success\ {\isasymLongrightarrow}\ is{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}flow\ s\ t\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ maxflow{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}mincost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}reduction{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ {\isacharunderscore}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flows{\isacharunderscore}{\kern0pt}are{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ capacity{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{1}}\ \ capacity{\isacharunderscore}{\kern0pt}cong{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ o\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ b{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}are\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}def\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}original{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}success{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}def\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}cs{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}us{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ capacity{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}rewrite\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{notation}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}flow\ {\isacharparenleft}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ is\ {\isacharunderscore}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ flow{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}infeasible{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ infeasible\ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}\ \ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ is\ s\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ t\ flow{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ \ u{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}neg\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}def\ isuflow{\isacharunderscore}{\kern0pt}def\ ex{\isacharunderscore}{\kern0pt}def\ zero{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}flow{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymnexists}f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}f\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}infeasible{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}cs{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}us{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}def\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ ex\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ maxflow{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}mincost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}reduction{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}V\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ f{\isacharunderscore}{\kern0pt}prop\ refl{\isacharbrackright}{\kern0pt}\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}are\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ ex\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ capacity{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}rewrite\ capacity{\isacharunderscore}{\kern0pt}cong\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}axioms{\isacharbrackleft}{\kern0pt}OF\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}axioms{\isacharbrackleft}{\kern0pt}OF\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ intro{\isacharcolon}{\kern0pt}\ capacity{\isacharunderscore}{\kern0pt}bflow{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ fst{\isacharprime}{\kern0pt}\ snd{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ e\ of\ None\ {\isasymRightarrow}\ PInfty\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ Some\ x\ {\isasymRightarrow}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isasymu}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ sum\ {\isasymu}\ {\isasymE}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ case\ e\ of\ old{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ e\ {\isacharbar}{\kern0pt}\ new{\isacharunderscore}{\kern0pt}edge\ b\ {\isasymRightarrow}\ ex\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}cong\ E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ \ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ b{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}flow\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ {\isacharequal}{\kern0pt}\ notyetterm\ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle{\isacharbrackleft}{\kern0pt}simplified\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ o{\isacharunderscore}{\kern0pt}apply\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ edge{\isacharunderscore}{\kern0pt}wrapper{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}distrib{\isacharbrackleft}{\kern0pt}of\ the{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ option{\isachardot}{\kern0pt}sel\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ \ make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ no{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}cycle\isanewline
\ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}cs{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}us{\isacharunderscore}{\kern0pt}are{\isacharbrackleft}{\kern0pt}OF\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ with{\isacharunderscore}{\kern0pt}capacity{\isacharunderscore}{\kern0pt}proofs{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case{\isacharbrackleft}{\kern0pt}of\ snd{\isacharprime}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharprime}{\kern0pt}\ fst{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ create{\isacharunderscore}{\kern0pt}edge{\isacharprime}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ \ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}the{\isacharunderscore}{\kern0pt}default\ {\isadigit{0}}\ {\isasymcirc}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}cap{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ {\isasymu}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ fst{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}def\ \ \ snd{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation\ {\isacharequal}{\kern0pt}\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}success\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}infeasible\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharunderscore}{\kern0pt}excluded{\isacharunderscore}{\kern0pt}case\isanewline
\ \ \isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\ \isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}maxflow\ fst\ snd\ Pair\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isadigit{1}}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow\ fst\ snd\ Pair\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isadigit{1}}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\ fst\ snd\ Pair\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isadigit{1}}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}inorder\ \ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}maxflow{\isacharunderscore}{\kern0pt}original\ fst\ snd\ Pair\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymu}{\isacharunderscore}{\kern0pt}impl\ {\isadigit{1}}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Isabelle-Graph-Library_second/Mincost_Flow_Algorithms/Use_Orlins_Algorithm/Usage_Capacitated.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%36=6%:%
%:%39=7%:%
%:%40=8%:%
%:%41=8%:%
%:%42=9%:%
%:%43=10%:%
%:%44=11%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=16%:%
%:%51=17%:%
%:%52=17%:%
%:%53=18%:%
%:%54=19%:%
%:%55=20%:%
%:%56=21%:%
%:%57=22%:%
%:%58=22%:%
%:%61=23%:%
%:%65=23%:%
%:%66=23%:%
%:%67=24%:%
%:%68=25%:%
%:%69=26%:%
%:%70=26%:%
%:%71=27%:%
%:%72=27%:%
%:%73=28%:%
%:%74=28%:%
%:%75=29%:%
%:%76=29%:%
%:%77=30%:%
%:%78=30%:%
%:%79=31%:%
%:%80=31%:%
%:%81=32%:%
%:%82=32%:%
%:%83=33%:%
%:%84=33%:%
%:%85=34%:%
%:%86=35%:%
%:%87=35%:%
%:%88=36%:%
%:%89=36%:%
%:%90=37%:%
%:%91=38%:%
%:%97=38%:%
%:%100=39%:%
%:%101=39%:%
%:%102=40%:%
%:%103=41%:%
%:%104=41%:%
%:%105=42%:%
%:%106=43%:%
%:%107=44%:%
%:%108=44%:%
%:%109=45%:%
%:%110=46%:%
%:%111=47%:%
%:%112=48%:%
%:%113=49%:%
%:%114=50%:%
%:%115=51%:%
%:%116=52%:%
%:%117=53%:%
%:%118=54%:%
%:%119=55%:%
%:%120=56%:%
%:%121=56%:%
%:%122=57%:%
%:%123=58%:%
%:%124=59%:%
%:%125=60%:%
%:%126=61%:%
%:%127=62%:%
%:%128=63%:%
%:%129=64%:%
%:%130=65%:%
%:%131=66%:%
%:%132=67%:%
%:%133=68%:%
%:%134=68%:%
%:%141=69%:%
%:%142=69%:%
%:%143=70%:%
%:%144=71%:%
%:%145=72%:%
%:%146=72%:%
%:%147=73%:%
%:%148=73%:%
%:%149=73%:%
%:%150=74%:%
%:%151=74%:%
%:%152=75%:%
%:%153=75%:%
%:%154=76%:%
%:%155=76%:%
%:%156=77%:%
%:%157=77%:%
%:%158=77%:%
%:%159=78%:%
%:%160=78%:%
%:%161=79%:%
%:%162=79%:%
%:%163=80%:%
%:%164=80%:%
%:%165=81%:%
%:%166=81%:%
%:%167=81%:%
%:%168=82%:%
%:%169=82%:%
%:%170=83%:%
%:%171=83%:%
%:%172=84%:%
%:%173=84%:%
%:%174=85%:%
%:%175=85%:%
%:%176=86%:%
%:%177=86%:%
%:%178=86%:%
%:%179=87%:%
%:%180=87%:%
%:%181=88%:%
%:%182=88%:%
%:%183=89%:%
%:%184=89%:%
%:%185=90%:%
%:%186=90%:%
%:%187=91%:%
%:%188=91%:%
%:%189=91%:%
%:%190=92%:%
%:%191=92%:%
%:%192=93%:%
%:%193=94%:%
%:%199=94%:%
%:%202=95%:%
%:%203=95%:%
%:%204=96%:%
%:%205=97%:%
%:%206=97%:%
%:%207=98%:%
%:%208=99%:%
%:%209=100%:%
%:%210=101%:%
%:%211=102%:%
%:%212=103%:%
%:%213=104%:%
%:%214=105%:%
%:%215=106%:%
%:%216=107%:%
%:%217=108%:%
%:%218=108%:%
%:%219=109%:%
%:%220=110%:%
%:%221=110%:%
%:%222=111%:%
%:%223=112%:%
%:%224=112%:%
%:%225=113%:%
%:%226=113%:%
%:%227=114%:%
%:%228=114%:%
%:%229=115%:%
%:%230=115%:%
%:%231=116%:%
%:%232=117%:%
%:%233=117%:%
%:%234=118%:%
%:%235=119%:%
%:%236=119%:%
%:%239=122%:%
%:%240=123%:%
%:%241=124%:%
%:%242=124%:%
%:%243=125%:%
%:%244=126%:%
%:%245=127%:%
%:%246=127%:%
%:%249=130%:%
%:%250=131%:%
%:%251=132%:%
%:%252=132%:%
%:%254=134%:%
%:%255=135%:%
%:%256=136%:%
%:%257=137%:%
%:%258=137%:%
%:%259=138%:%
%:%260=139%:%
%:%261=140%:%
%:%262=141%:%
%:%263=141%:%
%:%264=142%:%
%:%265=143%:%
%:%266=144%:%
%:%267=144%:%
%:%272=149%:%
%:%273=150%:%
%:%274=151%:%
%:%275=151%:%
%:%278=152%:%
%:%282=152%:%
%:%283=152%:%
%:%284=153%:%
%:%285=153%:%
%:%286=154%:%
%:%287=154%:%
%:%288=155%:%
%:%289=155%:%
%:%290=156%:%
%:%291=156%:%
%:%292=157%:%
%:%297=157%:%
%:%300=158%:%
%:%301=159%:%
%:%302=159%:%
%:%303=160%:%
%:%304=161%:%
%:%305=161%:%
%:%306=162%:%
%:%309=163%:%
%:%313=163%:%
%:%314=163%:%
%:%315=164%:%
%:%320=164%:%
%:%323=165%:%
%:%324=166%:%
%:%325=166%:%
%:%326=167%:%
%:%329=170%:%
%:%332=171%:%
%:%336=171%:%
%:%337=171%:%
%:%338=172%:%
%:%343=172%:%
%:%346=173%:%
%:%347=174%:%
%:%348=174%:%
%:%349=175%:%
%:%351=177%:%
%:%354=178%:%
%:%358=178%:%
%:%359=178%:%
%:%360=179%:%
%:%365=179%:%
%:%368=180%:%
%:%369=181%:%
%:%370=181%:%
%:%371=182%:%
%:%372=183%:%
%:%373=184%:%
%:%374=185%:%
%:%375=186%:%
%:%376=187%:%
%:%377=188%:%
%:%378=189%:%
%:%379=190%:%
%:%380=191%:%
%:%381=192%:%
%:%382=193%:%
%:%383=194%:%
%:%384=195%:%
%:%385=196%:%
%:%386=197%:%
%:%387=198%:%
%:%388=199%:%
%:%389=200%:%
%:%390=201%:%
%:%391=202%:%
%:%392=203%:%
%:%393=204%:%
%:%394=205%:%
%:%395=206%:%
%:%396=207%:%
%:%397=207%:%
%:%400=208%:%
%:%404=208%:%
%:%405=208%:%
%:%406=209%:%
%:%407=209%:%
%:%408=210%:%
%:%409=210%:%
%:%414=210%:%
%:%417=211%:%
%:%418=212%:%
%:%419=212%:%
%:%422=213%:%
%:%426=213%:%
%:%427=213%:%
%:%428=213%:%
%:%433=213%:%
%:%436=214%:%
%:%437=215%:%
%:%438=215%:%
%:%441=216%:%
%:%445=216%:%
%:%446=216%:%
%:%447=217%:%
%:%448=217%:%
%:%449=218%:%
%:%450=218%:%
%:%455=218%:%
%:%458=219%:%
%:%459=220%:%
%:%460=220%:%
%:%463=221%:%
%:%467=221%:%
%:%468=221%:%
%:%469=221%:%
%:%474=221%:%
%:%477=222%:%
%:%478=223%:%
%:%479=223%:%
%:%482=224%:%
%:%486=224%:%
%:%487=224%:%
%:%488=225%:%
%:%489=225%:%
%:%494=225%:%
%:%497=226%:%
%:%498=227%:%
%:%499=227%:%
%:%502=228%:%
%:%506=228%:%
%:%507=228%:%
%:%508=229%:%
%:%509=229%:%
%:%514=229%:%
%:%517=230%:%
%:%518=231%:%
%:%519=231%:%
%:%522=232%:%
%:%526=232%:%
%:%527=232%:%
%:%528=233%:%
%:%529=233%:%
%:%534=233%:%
%:%537=234%:%
%:%538=235%:%
%:%539=235%:%
%:%542=236%:%
%:%546=236%:%
%:%547=236%:%
%:%548=237%:%
%:%549=237%:%
%:%550=238%:%
%:%551=239%:%
%:%552=240%:%
%:%557=240%:%
%:%560=241%:%
%:%561=242%:%
%:%562=242%:%
%:%563=243%:%
%:%564=244%:%
%:%565=245%:%
%:%566=245%:%
%:%567=246%:%
%:%568=247%:%
%:%569=247%:%
%:%572=248%:%
%:%576=248%:%
%:%577=248%:%
%:%578=249%:%
%:%579=249%:%
%:%580=250%:%
%:%585=250%:%
%:%588=251%:%
%:%589=252%:%
%:%590=252%:%
%:%593=253%:%
%:%597=253%:%
%:%598=253%:%
%:%599=254%:%
%:%600=254%:%
%:%601=255%:%
%:%602=255%:%
%:%603=256%:%
%:%604=256%:%
%:%609=256%:%
%:%612=257%:%
%:%613=258%:%
%:%614=258%:%
%:%616=260%:%
%:%619=261%:%
%:%623=261%:%
%:%624=261%:%
%:%625=262%:%
%:%626=262%:%
%:%627=263%:%
%:%628=263%:%
%:%629=264%:%
%:%630=264%:%
%:%631=265%:%
%:%632=265%:%
%:%633=266%:%
%:%634=266%:%
%:%635=267%:%
%:%636=268%:%
%:%637=269%:%
%:%642=269%:%
%:%645=270%:%
%:%646=271%:%
%:%647=271%:%
%:%650=274%:%
%:%653=275%:%
%:%657=275%:%
%:%658=275%:%
%:%659=276%:%
%:%660=276%:%
%:%661=277%:%
%:%662=277%:%
%:%663=278%:%
%:%664=278%:%
%:%665=279%:%
%:%670=279%:%
%:%673=280%:%
%:%674=281%:%
%:%675=281%:%
%:%676=282%:%
%:%685=291%:%
%:%692=292%:%
%:%693=292%:%
%:%694=293%:%
%:%695=293%:%
%:%696=294%:%
%:%697=294%:%
%:%698=294%:%
%:%699=295%:%
%:%700=295%:%
%:%701=296%:%
%:%702=296%:%
%:%703=297%:%
%:%704=297%:%
%:%705=298%:%
%:%706=298%:%
%:%707=298%:%
%:%708=299%:%
%:%709=299%:%
%:%710=300%:%
%:%711=300%:%
%:%712=301%:%
%:%713=301%:%
%:%714=302%:%
%:%715=302%:%
%:%716=303%:%
%:%717=303%:%
%:%718=304%:%
%:%719=305%:%
%:%720=306%:%
%:%721=307%:%
%:%727=307%:%
%:%730=308%:%
%:%731=309%:%
%:%732=309%:%
%:%735=310%:%
%:%739=310%:%
%:%740=310%:%
%:%741=311%:%
%:%742=311%:%
%:%747=311%:%
%:%750=312%:%
%:%751=313%:%
%:%752=313%:%
%:%753=314%:%
%:%756=315%:%
%:%760=315%:%
%:%761=315%:%
%:%762=315%:%
%:%767=315%:%
%:%770=316%:%
%:%771=317%:%
%:%772=317%:%
%:%774=319%:%
%:%777=320%:%
%:%781=320%:%
%:%782=320%:%
%:%783=321%:%
%:%784=321%:%
%:%785=322%:%
%:%786=322%:%
%:%787=323%:%
%:%788=323%:%
%:%789=324%:%
%:%790=324%:%
%:%791=325%:%
%:%792=325%:%
%:%793=326%:%
%:%794=327%:%
%:%795=328%:%
%:%800=328%:%
%:%803=329%:%
%:%804=330%:%
%:%805=330%:%
%:%808=331%:%
%:%812=331%:%
%:%813=331%:%
%:%814=332%:%
%:%815=332%:%
%:%820=332%:%
%:%823=333%:%
%:%824=334%:%
%:%825=334%:%
%:%828=335%:%
%:%832=335%:%
%:%833=335%:%
%:%838=335%:%
%:%841=336%:%
%:%842=337%:%
%:%843=337%:%
%:%846=338%:%
%:%850=338%:%
%:%851=338%:%
%:%852=339%:%
%:%853=339%:%
%:%854=340%:%
%:%855=340%:%
%:%856=341%:%
%:%857=341%:%
%:%858=342%:%
%:%859=342%:%
%:%864=342%:%
%:%867=343%:%
%:%868=344%:%
%:%869=345%:%
%:%870=345%:%
%:%873=346%:%
%:%877=346%:%
%:%878=346%:%
%:%883=346%:%
%:%886=347%:%
%:%887=348%:%
%:%888=348%:%
%:%889=349%:%
%:%892=350%:%
%:%896=350%:%
%:%897=350%:%
%:%898=351%:%
%:%899=351%:%
%:%900=352%:%
%:%901=353%:%
%:%906=353%:%
%:%909=354%:%
%:%910=355%:%
%:%911=355%:%
%:%912=356%:%
%:%915=357%:%
%:%919=357%:%
%:%920=357%:%
%:%921=358%:%
%:%922=358%:%
%:%923=359%:%
%:%924=359%:%
%:%929=359%:%
%:%932=360%:%
%:%933=361%:%
%:%934=361%:%
%:%937=362%:%
%:%941=362%:%
%:%942=362%:%
%:%943=363%:%
%:%944=363%:%
%:%945=364%:%
%:%950=364%:%
%:%953=365%:%
%:%954=366%:%
%:%955=366%:%
%:%956=367%:%
%:%963=368%:%
%:%964=368%:%
%:%965=369%:%
%:%966=369%:%
%:%970=373%:%
%:%971=374%:%
%:%972=374%:%
%:%973=375%:%
%:%974=375%:%
%:%975=376%:%
%:%976=376%:%
%:%977=376%:%
%:%978=377%:%
%:%979=377%:%
%:%980=378%:%
%:%981=378%:%
%:%982=378%:%
%:%983=378%:%
%:%984=379%:%
%:%985=379%:%
%:%986=380%:%
%:%987=380%:%
%:%988=380%:%
%:%989=381%:%
%:%990=381%:%
%:%991=382%:%
%:%992=382%:%
%:%993=383%:%
%:%994=383%:%
%:%995=384%:%
%:%996=384%:%
%:%997=384%:%
%:%1001=388%:%
%:%1002=389%:%
%:%1003=389%:%
%:%1004=390%:%
%:%1005=390%:%
%:%1006=391%:%
%:%1007=391%:%
%:%1008=392%:%
%:%1009=392%:%
%:%1010=392%:%
%:%1011=393%:%
%:%1012=393%:%
%:%1013=394%:%
%:%1014=394%:%
%:%1015=394%:%
%:%1016=394%:%
%:%1017=395%:%
%:%1018=395%:%
%:%1019=396%:%
%:%1020=396%:%
%:%1021=396%:%
%:%1022=397%:%
%:%1023=397%:%
%:%1024=398%:%
%:%1025=398%:%
%:%1026=399%:%
%:%1027=399%:%
%:%1028=400%:%
%:%1029=400%:%
%:%1030=400%:%
%:%1034=404%:%
%:%1035=405%:%
%:%1036=405%:%
%:%1037=406%:%
%:%1038=406%:%
%:%1039=407%:%
%:%1040=407%:%
%:%1041=408%:%
%:%1042=408%:%
%:%1043=408%:%
%:%1044=409%:%
%:%1045=409%:%
%:%1046=410%:%
%:%1047=410%:%
%:%1048=411%:%
%:%1049=411%:%
%:%1050=412%:%
%:%1051=412%:%
%:%1052=413%:%
%:%1053=413%:%
%:%1054=414%:%
%:%1055=414%:%
%:%1056=414%:%
%:%1065=423%:%
%:%1066=424%:%
%:%1067=424%:%
%:%1068=425%:%
%:%1069=425%:%
%:%1070=426%:%
%:%1071=426%:%
%:%1072=427%:%
%:%1073=427%:%
%:%1074=428%:%
%:%1075=428%:%
%:%1076=428%:%
%:%1077=429%:%
%:%1078=429%:%
%:%1079=430%:%
%:%1080=430%:%
%:%1081=431%:%
%:%1082=431%:%
%:%1083=432%:%
%:%1084=432%:%
%:%1085=433%:%
%:%1086=433%:%
%:%1087=434%:%
%:%1088=434%:%
%:%1089=435%:%
%:%1090=435%:%
%:%1091=435%:%
%:%1092=436%:%
%:%1093=436%:%
%:%1094=437%:%
%:%1095=437%:%
%:%1096=438%:%
%:%1097=438%:%
%:%1098=438%:%
%:%1099=438%:%
%:%1100=439%:%
%:%1101=439%:%
%:%1102=440%:%
%:%1103=440%:%
%:%1104=441%:%
%:%1105=441%:%
%:%1106=442%:%
%:%1107=442%:%
%:%1108=443%:%
%:%1109=443%:%
%:%1110=444%:%
%:%1111=444%:%
%:%1112=444%:%
%:%1113=445%:%
%:%1114=445%:%
%:%1115=445%:%
%:%1116=446%:%
%:%1117=446%:%
%:%1118=447%:%
%:%1119=447%:%
%:%1120=448%:%
%:%1121=448%:%
%:%1122=448%:%
%:%1132=458%:%
%:%1133=459%:%
%:%1134=459%:%
%:%1135=460%:%
%:%1136=460%:%
%:%1137=461%:%
%:%1138=461%:%
%:%1139=462%:%
%:%1140=462%:%
%:%1141=463%:%
%:%1142=463%:%
%:%1143=463%:%
%:%1144=464%:%
%:%1145=464%:%
%:%1146=464%:%
%:%1147=465%:%
%:%1148=465%:%
%:%1149=466%:%
%:%1150=466%:%
%:%1151=467%:%
%:%1152=467%:%
%:%1153=467%:%
%:%1154=468%:%
%:%1155=468%:%
%:%1156=469%:%
%:%1157=469%:%
%:%1158=470%:%
%:%1159=470%:%
%:%1160=471%:%
%:%1161=471%:%
%:%1162=472%:%
%:%1163=473%:%
%:%1164=474%:%
%:%1165=475%:%
%:%1171=475%:%
%:%1174=476%:%
%:%1175=477%:%
%:%1176=478%:%
%:%1177=478%:%
%:%1178=479%:%
%:%1181=480%:%
%:%1185=480%:%
%:%1186=480%:%
%:%1187=481%:%
%:%1192=481%:%
%:%1195=482%:%
%:%1196=483%:%
%:%1197=483%:%
%:%1200=484%:%
%:%1204=484%:%
%:%1205=484%:%
%:%1206=485%:%
%:%1207=485%:%
%:%1208=486%:%
%:%1213=486%:%
%:%1216=487%:%
%:%1217=488%:%
%:%1218=488%:%
%:%1221=489%:%
%:%1225=489%:%
%:%1226=489%:%
%:%1227=490%:%
%:%1232=490%:%
%:%1235=491%:%
%:%1236=492%:%
%:%1237=492%:%
%:%1239=494%:%
%:%1242=495%:%
%:%1246=495%:%
%:%1247=495%:%
%:%1248=496%:%
%:%1249=496%:%
%:%1250=497%:%
%:%1251=498%:%
%:%1256=498%:%
%:%1259=499%:%
%:%1260=500%:%
%:%1261=500%:%
%:%1264=501%:%
%:%1268=501%:%
%:%1269=501%:%
%:%1274=501%:%
%:%1277=502%:%
%:%1278=503%:%
%:%1279=503%:%
%:%1282=504%:%
%:%1286=504%:%
%:%1287=504%:%
%:%1288=505%:%
%:%1289=505%:%
%:%1290=506%:%
%:%1295=506%:%
%:%1298=507%:%
%:%1299=508%:%
%:%1300=508%:%
%:%1303=509%:%
%:%1307=509%:%
%:%1308=509%:%
%:%1309=510%:%
%:%1310=510%:%
%:%1311=511%:%
%:%1316=511%:%
%:%1319=512%:%
%:%1320=513%:%
%:%1321=513%:%
%:%1324=514%:%
%:%1328=514%:%
%:%1329=514%:%
%:%1330=515%:%
%:%1331=515%:%
%:%1332=516%:%
%:%1337=516%:%
%:%1340=517%:%
%:%1341=518%:%
%:%1342=518%:%
%:%1343=519%:%
%:%1344=520%:%
%:%1345=521%:%
%:%1346=522%:%
%:%1347=523%:%
%:%1348=524%:%
%:%1349=525%:%
%:%1352=526%:%
%:%1356=526%:%
%:%1357=526%:%
%:%1358=527%:%
%:%1359=527%:%
%:%1360=528%:%
%:%1365=528%:%
%:%1368=529%:%
%:%1369=530%:%
%:%1370=530%:%
%:%1373=531%:%
%:%1377=531%:%
%:%1378=531%:%
%:%1379=532%:%
%:%1380=532%:%
%:%1381=533%:%
%:%1386=533%:%
%:%1389=534%:%
%:%1390=535%:%
%:%1391=535%:%
%:%1392=536%:%
%:%1399=537%:%
%:%1400=537%:%
%:%1401=538%:%
%:%1402=538%:%
%:%1403=539%:%
%:%1404=539%:%
%:%1405=540%:%
%:%1406=540%:%
%:%1407=541%:%
%:%1408=541%:%
%:%1409=542%:%
%:%1410=542%:%
%:%1411=543%:%
%:%1412=543%:%
%:%1413=543%:%
%:%1414=544%:%
%:%1415=544%:%
%:%1416=544%:%
%:%1417=545%:%
%:%1418=545%:%
%:%1419=545%:%
%:%1420=546%:%
%:%1421=546%:%
%:%1422=547%:%
%:%1423=547%:%
%:%1424=548%:%
%:%1425=548%:%
%:%1426=548%:%
%:%1427=548%:%
%:%1428=549%:%
%:%1429=549%:%
%:%1430=550%:%
%:%1431=550%:%
%:%1432=551%:%
%:%1433=551%:%
%:%1434=552%:%
%:%1435=552%:%
%:%1436=552%:%
%:%1437=553%:%
%:%1438=553%:%
%:%1439=553%:%
%:%1440=554%:%
%:%1441=554%:%
%:%1442=554%:%
%:%1443=555%:%
%:%1444=555%:%
%:%1445=556%:%
%:%1446=556%:%
%:%1447=557%:%
%:%1448=557%:%
%:%1449=557%:%
%:%1450=558%:%
%:%1451=558%:%
%:%1452=558%:%
%:%1453=559%:%
%:%1454=559%:%
%:%1455=560%:%
%:%1456=560%:%
%:%1457=561%:%
%:%1458=561%:%
%:%1459=562%:%
%:%1460=562%:%
%:%1461=562%:%
%:%1462=563%:%
%:%1463=563%:%
%:%1464=564%:%
%:%1465=564%:%
%:%1466=565%:%
%:%1467=566%:%
%:%1473=566%:%
%:%1476=567%:%
%:%1477=568%:%
%:%1478=568%:%
%:%1481=569%:%
%:%1485=569%:%
%:%1486=569%:%
%:%1487=570%:%
%:%1488=571%:%
%:%1489=572%:%
%:%1494=572%:%
%:%1497=573%:%
%:%1498=574%:%
%:%1499=574%:%
%:%1502=575%:%
%:%1506=575%:%
%:%1507=575%:%
%:%1508=576%:%
%:%1509=576%:%
%:%1510=577%:%
%:%1511=577%:%
%:%1512=578%:%
%:%1513=578%:%
%:%1514=579%:%
%:%1515=579%:%
%:%1516=580%:%
%:%1517=580%:%
%:%1518=581%:%
%:%1519=581%:%
%:%1520=582%:%
%:%1521=582%:%
%:%1522=583%:%
%:%1523=583%:%
%:%1524=584%:%
%:%1525=584%:%
%:%1526=585%:%
%:%1527=586%:%
%:%1528=587%:%
%:%1529=587%:%
%:%1530=588%:%
%:%1536=588%:%
%:%1539=589%:%
%:%1540=590%:%
%:%1541=590%:%
%:%1544=591%:%
%:%1548=591%:%
%:%1549=591%:%
%:%1554=591%:%
%:%1557=592%:%
%:%1558=593%:%
%:%1559=593%:%
%:%1560=594%:%
%:%1563=595%:%
%:%1567=595%:%
%:%1568=595%:%
%:%1569=596%:%
%:%1570=596%:%
%:%1571=597%:%
%:%1572=597%:%
%:%1573=598%:%
%:%1574=598%:%
%:%1575=599%:%
%:%1576=599%:%
%:%1577=600%:%
%:%1578=601%:%
%:%1579=602%:%
%:%1580=602%:%
%:%1585=602%:%
%:%1588=603%:%
%:%1589=604%:%
%:%1590=604%:%
%:%1591=605%:%
%:%1592=606%:%
%:%1593=607%:%
%:%1594=608%:%
%:%1595=609%:%
%:%1596=609%:%
%:%1603=610%:%
%:%1604=610%:%
%:%1605=611%:%
%:%1606=611%:%
%:%1607=612%:%
%:%1608=612%:%
%:%1609=613%:%
%:%1610=614%:%
%:%1611=614%:%
%:%1612=615%:%
%:%1613=616%:%
%:%1614=617%:%
%:%1615=617%:%
%:%1616=618%:%
%:%1617=618%:%
%:%1618=619%:%
%:%1619=619%:%
%:%1620=620%:%
%:%1621=621%:%
%:%1622=622%:%
%:%1623=622%:%
%:%1624=623%:%
%:%1625=623%:%
%:%1626=624%:%
%:%1627=624%:%
%:%1628=624%:%
%:%1629=625%:%
%:%1635=625%:%
%:%1638=626%:%
%:%1639=627%:%
%:%1640=627%:%
%:%1641=628%:%
%:%1642=629%:%
%:%1645=630%:%
%:%1649=630%:%
%:%1650=630%:%
%:%1651=631%:%
%:%1652=632%:%
%:%1653=632%:%
%:%1654=633%:%
%:%1655=633%:%
%:%1656=634%:%
%:%1657=635%:%
%:%1658=635%:%
%:%1659=636%:%
%:%1660=636%:%
%:%1661=637%:%
%:%1662=637%:%
%:%1663=638%:%
%:%1664=639%:%
%:%1665=640%:%
%:%1666=641%:%
%:%1667=642%:%
%:%1672=642%:%
%:%1675=643%:%
%:%1676=644%:%
%:%1677=644%:%
%:%1678=645%:%
%:%1679=646%:%
%:%1686=647%:%
%:%1687=647%:%
%:%1688=648%:%
%:%1689=648%:%
%:%1690=649%:%
%:%1691=649%:%
%:%1693=651%:%
%:%1694=652%:%
%:%1695=652%:%
%:%1696=653%:%
%:%1697=653%:%
%:%1698=654%:%
%:%1699=655%:%
%:%1700=655%:%
%:%1701=656%:%
%:%1702=657%:%
%:%1703=657%:%
%:%1704=657%:%
%:%1705=658%:%
%:%1706=659%:%
%:%1707=659%:%
%:%1708=660%:%
%:%1709=660%:%
%:%1710=661%:%
%:%1711=662%:%
%:%1712=663%:%
%:%1713=664%:%
%:%1714=665%:%
%:%1715=665%:%
%:%1716=665%:%
%:%1717=665%:%
%:%1718=666%:%
%:%1724=666%:%
%:%1727=667%:%
%:%1728=668%:%
%:%1729=669%:%
%:%1730=669%:%
%:%1731=670%:%
%:%1734=671%:%
%:%1738=671%:%
%:%1739=671%:%
%:%1740=672%:%
%:%1741=672%:%
%:%1742=673%:%
%:%1747=673%:%
%:%1750=674%:%
%:%1751=675%:%
%:%1752=675%:%
%:%1753=676%:%
%:%1754=677%:%
%:%1755=683%:%
%:%1756=684%:%
%:%1757=684%:%
%:%1758=685%:%
%:%1759=685%:%
%:%1760=686%:%
%:%1761=686%:%
%:%1762=687%:%
%:%1763=687%:%
%:%1764=688%:%
%:%1765=688%:%
%:%1766=689%:%
%:%1767=690%:%
%:%1768=691%:%
%:%1769=692%:%
%:%1770=693%:%
%:%1771=694%:%
%:%1772=695%:%
%:%1773=696%:%
%:%1774=697%:%
%:%1775=698%:%
%:%1776=699%:%
%:%1777=700%:%
%:%1780=701%:%
%:%1781=702%:%
%:%1785=702%:%
%:%1791=702%:%
%:%1794=703%:%
%:%1795=704%:%
%:%1796=704%:%
%:%1797=705%:%
%:%1798=706%:%
%:%1799=706%:%
%:%1800=707%:%
%:%1801=708%:%
%:%1802=708%:%
%:%1803=709%:%
%:%1804=710%:%
%:%1805=710%:%
%:%1806=711%:%
%:%1807=711%:%
%:%1808=712%:%
%:%1809=713%:%
%:%1810=713%:%
%:%1812=715%:%
%:%1813=716%:%
%:%1814=717%:%
%:%1815=717%:%
%:%1816=718%:%
%:%1817=718%:%
%:%1818=719%:%
%:%1819=720%:%
%:%1820=720%:%
%:%1822=722%:%
%:%1823=723%:%
%:%1824=724%:%
%:%1825=724%:%
%:%1826=725%:%
%:%1827=725%:%
%:%1828=726%:%
%:%1829=727%:%
%:%1830=727%:%
%:%1831=728%:%
%:%1832=728%:%
%:%1833=729%:%
%:%1834=729%:%
%:%1835=730%:%
%:%1836=730%:%
%:%1837=731%:%
%:%1838=732%:%
%:%1839=732%:%
%:%1840=733%:%
%:%1841=734%:%
%:%1842=735%:%
%:%1843=735%:%
%:%1844=736%:%
%:%1845=737%:%
%:%1846=738%:%
%:%1847=739%:%
%:%1848=740%:%
%:%1849=741%:%
%:%1850=741%:%
%:%1851=742%:%
%:%1852=743%:%
%:%1853=744%:%
%:%1854=745%:%
%:%1855=746%:%
%:%1856=747%:%
%:%1857=747%:%
%:%1860=748%:%
%:%1864=748%:%
%:%1865=748%:%
%:%1866=749%:%
%:%1867=750%:%
%:%1868=751%:%
%:%1869=751%:%
%:%1870=752%:%
%:%1871=752%:%
%:%1872=753%:%
%:%1873=753%:%
%:%1874=754%:%
%:%1875=754%:%
%:%1876=755%:%
%:%1877=755%:%
%:%1878=756%:%
%:%1879=756%:%
%:%1880=757%:%
%:%1881=758%:%
%:%1882=758%:%
%:%1883=759%:%
%:%1884=759%:%
%:%1885=760%:%
%:%1886=761%:%
%:%1887=761%:%
%:%1888=762%:%
%:%1889=762%:%
%:%1890=763%:%
%:%1891=764%:%
%:%1897=764%:%
%:%1900=765%:%
%:%1901=765%:%
%:%1902=766%:%
%:%1903=767%:%
%:%1904=767%:%
%:%1905=768%:%
%:%1906=769%:%
%:%1907=769%:%
%:%1908=770%:%
%:%1909=771%:%
%:%1910=772%:%
%:%1911=773%:%
%:%1912=774%:%
%:%1913=775%:%
%:%1914=776%:%
%:%1915=777%:%
%:%1916=778%:%
%:%1917=779%:%
%:%1918=779%:%
%:%1919=780%:%
%:%1920=781%:%
%:%1921=781%:%
%:%1922=782%:%
%:%1923=783%:%
%:%1924=783%:%
%:%1925=784%:%
%:%1926=785%:%
%:%1927=786%:%
%:%1928=786%:%
%:%1929=787%:%
%:%1930=788%:%
%:%1931=788%:%
%:%1932=789%:%
%:%1933=790%:%
%:%1934=790%:%
%:%1935=791%:%
%:%1936=792%:%
%:%1937=793%:%
%:%1938=793%:%
%:%1941=796%:%
%:%1942=797%:%
%:%1943=798%:%
%:%1944=798%:%
%:%1947=801%:%
%:%1948=802%:%
%:%1949=803%:%
%:%1950=803%:%
%:%1953=806%:%
%:%1954=807%:%
%:%1955=807%:%
%:%1956=808%:%
%:%1957=809%:%
%:%1958=809%:%
%:%1959=810%:%
%:%1960=811%:%
%:%1961=812%:%
%:%1962=813%:%
%:%1963=814%:%
%:%1964=815%:%
%:%1965=816%:%
%:%1966=817%:%
%:%1967=818%:%
%:%1968=819%:%
%:%1969=820%:%
%:%1972=821%:%
%:%1976=821%:%
%:%1982=821%:%
%:%1985=822%:%
%:%1986=823%:%
%:%1987=823%:%
%:%1988=824%:%
%:%1989=825%:%
%:%1990=826%:%
%:%1991=827%:%
%:%1992=828%:%
%:%1993=829%:%
%:%1996=830%:%
%:%2000=830%:%
%:%2001=830%:%
%:%2002=831%:%
%:%2003=831%:%
%:%2004=832%:%
%:%2009=832%:%
%:%2012=833%:%
%:%2013=834%:%
%:%2014=834%:%
%:%2015=835%:%
%:%2016=836%:%
%:%2017=837%:%
%:%2018=838%:%
%:%2019=839%:%
%:%2020=840%:%
%:%2023=841%:%
%:%2027=841%:%
%:%2028=841%:%
%:%2029=842%:%
%:%2030=842%:%
%:%2035=842%:%
%:%2038=843%:%
%:%2039=844%:%
%:%2040=844%:%
%:%2041=845%:%
%:%2042=846%:%
%:%2043=847%:%
%:%2044=848%:%
%:%2045=849%:%
%:%2046=850%:%
%:%2047=851%:%
%:%2048=852%:%
%:%2049=853%:%
%:%2050=854%:%
%:%2051=855%:%
%:%2052=856%:%
%:%2053=857%:%
%:%2054=858%:%
%:%2055=859%:%
%:%2056=860%:%
%:%2057=861%:%
%:%2058=862%:%
%:%2059=863%:%
%:%2060=864%:%
%:%2061=865%:%
%:%2062=866%:%
%:%2063=867%:%
%:%2064=867%:%
%:%2065=868%:%
%:%2066=868%:%
%:%2067=869%:%
%:%2068=870%:%
%:%2069=870%:%
%:%2072=871%:%
%:%2076=871%:%
%:%2077=871%:%
%:%2078=872%:%
%:%2079=872%:%
%:%2080=873%:%
%:%2081=874%:%
%:%2082=874%:%
%:%2083=875%:%
%:%2084=875%:%
%:%2085=876%:%
%:%2086=876%:%
%:%2087=877%:%
%:%2092=877%:%
%:%2095=878%:%
%:%2096=879%:%
%:%2097=879%:%
%:%2100=880%:%
%:%2104=880%:%
%:%2105=880%:%
%:%2110=880%:%
%:%2113=881%:%
%:%2114=882%:%
%:%2115=882%:%
%:%2116=883%:%
%:%2119=884%:%
%:%2123=884%:%
%:%2124=884%:%
%:%2125=885%:%
%:%2126=885%:%
%:%2127=886%:%
%:%2128=887%:%
%:%2133=887%:%
%:%2136=888%:%
%:%2137=889%:%
%:%2138=889%:%
%:%2141=890%:%
%:%2145=890%:%
%:%2146=890%:%
%:%2151=890%:%
%:%2154=891%:%
%:%2155=892%:%
%:%2156=892%:%
%:%2158=894%:%
%:%2161=895%:%
%:%2165=895%:%
%:%2166=895%:%
%:%2167=896%:%
%:%2168=896%:%
%:%2173=896%:%
%:%2176=897%:%
%:%2177=898%:%
%:%2178=898%:%
%:%2181=899%:%
%:%2185=899%:%
%:%2186=899%:%
%:%2187=900%:%
%:%2188=900%:%
%:%2189=901%:%
%:%2190=901%:%
%:%2191=902%:%
%:%2192=903%:%
%:%2197=903%:%
%:%2200=904%:%
%:%2201=905%:%
%:%2202=905%:%
%:%2205=906%:%
%:%2209=906%:%
%:%2210=906%:%
%:%2211=907%:%
%:%2212=908%:%
%:%2213=909%:%
%:%2214=910%:%
%:%2215=911%:%
%:%2216=912%:%
%:%2217=913%:%
%:%2222=913%:%
%:%2225=914%:%
%:%2226=915%:%
%:%2227=915%:%
%:%2230=916%:%
%:%2234=916%:%
%:%2235=916%:%
%:%2236=917%:%
%:%2237=917%:%
%:%2242=917%:%
%:%2245=918%:%
%:%2246=919%:%
%:%2247=919%:%
%:%2250=920%:%
%:%2254=920%:%
%:%2255=920%:%
%:%2260=920%:%
%:%2263=921%:%
%:%2264=922%:%
%:%2265=922%:%
%:%2268=923%:%
%:%2272=923%:%
%:%2273=923%:%
%:%2274=924%:%
%:%2275=924%:%
%:%2276=925%:%
%:%2277=925%:%
%:%2278=926%:%
%:%2279=926%:%
%:%2280=927%:%
%:%2281=928%:%
%:%2282=928%:%
%:%2283=929%:%
%:%2284=929%:%
%:%2285=930%:%
%:%2286=930%:%
%:%2287=931%:%
%:%2288=931%:%
%:%2289=932%:%
%:%2290=933%:%
%:%2295=933%:%
%:%2298=934%:%
%:%2299=935%:%
%:%2300=935%:%
%:%2303=936%:%
%:%2307=936%:%
%:%2308=936%:%
%:%2309=937%:%
%:%2310=937%:%
%:%2311=938%:%
%:%2312=938%:%
%:%2317=938%:%
%:%2320=939%:%
%:%2321=940%:%
%:%2322=940%:%
%:%2325=941%:%
%:%2329=941%:%
%:%2330=941%:%
%:%2331=942%:%
%:%2332=942%:%
%:%2333=943%:%
%:%2334=943%:%
%:%2335=944%:%
%:%2336=944%:%
%:%2337=945%:%
%:%2338=946%:%
%:%2339=946%:%
%:%2340=947%:%
%:%2341=947%:%
%:%2342=948%:%
%:%2343=948%:%
%:%2344=949%:%
%:%2345=949%:%
%:%2350=949%:%
%:%2353=950%:%
%:%2354=951%:%
%:%2355=952%:%
%:%2356=952%:%
%:%2357=953%:%
%:%2362=958%:%
%:%2365=959%:%
%:%2369=959%:%
%:%2370=959%:%
%:%2371=960%:%
%:%2372=960%:%
%:%2373=961%:%
%:%2374=962%:%
%:%2379=962%:%
%:%2382=963%:%
%:%2383=964%:%
%:%2384=964%:%
%:%2390=970%:%
%:%2393=971%:%
%:%2397=971%:%
%:%2398=971%:%
%:%2399=972%:%
%:%2400=972%:%
%:%2401=973%:%
%:%2406=973%:%
%:%2409=974%:%
%:%2410=975%:%
%:%2411=975%:%
%:%2414=976%:%
%:%2418=976%:%
%:%2419=976%:%
%:%2420=977%:%
%:%2421=977%:%
%:%2422=978%:%
%:%2427=978%:%
%:%2430=979%:%
%:%2431=980%:%
%:%2432=980%:%
%:%2435=983%:%
%:%2438=984%:%
%:%2442=984%:%
%:%2443=984%:%
%:%2444=985%:%
%:%2445=985%:%
%:%2446=986%:%
%:%2451=986%:%
%:%2454=987%:%
%:%2455=988%:%
%:%2456=988%:%
%:%2458=990%:%
%:%2461=991%:%
%:%2465=991%:%
%:%2466=991%:%
%:%2467=992%:%
%:%2468=992%:%
%:%2473=992%:%
%:%2476=993%:%
%:%2477=994%:%
%:%2478=994%:%
%:%2481=995%:%
%:%2485=995%:%
%:%2486=995%:%
%:%2487=996%:%
%:%2488=996%:%
%:%2493=996%:%
%:%2496=997%:%
%:%2497=998%:%
%:%2498=998%:%
%:%2501=999%:%
%:%2505=999%:%
%:%2506=999%:%
%:%2507=1000%:%
%:%2508=1000%:%
%:%2509=1001%:%
%:%2510=1001%:%
%:%2511=1002%:%
%:%2512=1002%:%
%:%2513=1003%:%
%:%2514=1004%:%
%:%2515=1005%:%
%:%2520=1005%:%
%:%2523=1006%:%
%:%2524=1007%:%
%:%2525=1007%:%
%:%2526=1008%:%
%:%2529=1009%:%
%:%2533=1009%:%
%:%2534=1009%:%
%:%2535=1010%:%
%:%2536=1010%:%
%:%2537=1011%:%
%:%2542=1011%:%
%:%2545=1012%:%
%:%2546=1013%:%
%:%2547=1014%:%
%:%2548=1014%:%
%:%2549=1015%:%
%:%2550=1016%:%
%:%2551=1017%:%
%:%2552=1018%:%
%:%2553=1018%:%
%:%2560=1019%:%
%:%2561=1019%:%
%:%2562=1020%:%
%:%2563=1020%:%
%:%2564=1021%:%
%:%2565=1021%:%
%:%2566=1022%:%
%:%2567=1023%:%
%:%2568=1024%:%
%:%2569=1024%:%
%:%2570=1024%:%
%:%2571=1025%:%
%:%2572=1025%:%
%:%2573=1026%:%
%:%2574=1026%:%
%:%2575=1027%:%
%:%2576=1027%:%
%:%2577=1028%:%
%:%2578=1028%:%
%:%2579=1028%:%
%:%2580=1029%:%
%:%2581=1029%:%
%:%2582=1030%:%
%:%2583=1030%:%
%:%2584=1030%:%
%:%2585=1031%:%
%:%2586=1032%:%
%:%2587=1033%:%
%:%2588=1033%:%
%:%2589=1033%:%
%:%2590=1034%:%
%:%2591=1034%:%
%:%2592=1035%:%
%:%2593=1035%:%
%:%2594=1036%:%
%:%2595=1036%:%
%:%2596=1037%:%
%:%2597=1038%:%
%:%2598=1038%:%
%:%2599=1039%:%
%:%2600=1039%:%
%:%2601=1040%:%
%:%2602=1040%:%
%:%2603=1040%:%
%:%2604=1041%:%
%:%2605=1041%:%
%:%2606=1042%:%
%:%2607=1042%:%
%:%2608=1042%:%
%:%2609=1043%:%
%:%2610=1043%:%
%:%2611=1044%:%
%:%2612=1044%:%
%:%2613=1045%:%
%:%2614=1045%:%
%:%2615=1046%:%
%:%2616=1046%:%
%:%2617=1047%:%
%:%2618=1047%:%
%:%2619=1047%:%
%:%2620=1048%:%
%:%2621=1048%:%
%:%2622=1049%:%
%:%2623=1049%:%
%:%2624=1050%:%
%:%2625=1050%:%
%:%2626=1051%:%
%:%2627=1051%:%
%:%2628=1052%:%
%:%2629=1052%:%
%:%2630=1052%:%
%:%2631=1053%:%
%:%2632=1053%:%
%:%2633=1054%:%
%:%2634=1054%:%
%:%2635=1054%:%
%:%2636=1055%:%
%:%2637=1055%:%
%:%2638=1056%:%
%:%2639=1056%:%
%:%2640=1057%:%
%:%2641=1057%:%
%:%2642=1058%:%
%:%2643=1058%:%
%:%2644=1058%:%
%:%2645=1059%:%
%:%2646=1059%:%
%:%2647=1059%:%
%:%2648=1060%:%
%:%2649=1060%:%
%:%2650=1060%:%
%:%2651=1061%:%
%:%2652=1061%:%
%:%2653=1062%:%
%:%2654=1062%:%
%:%2655=1063%:%
%:%2656=1063%:%
%:%2657=1064%:%
%:%2658=1064%:%
%:%2659=1064%:%
%:%2660=1065%:%
%:%2661=1065%:%
%:%2662=1066%:%
%:%2663=1066%:%
%:%2664=1066%:%
%:%2665=1067%:%
%:%2666=1067%:%
%:%2667=1067%:%
%:%2668=1068%:%
%:%2669=1068%:%
%:%2670=1068%:%
%:%2671=1069%:%
%:%2672=1069%:%
%:%2673=1069%:%
%:%2674=1070%:%
%:%2675=1070%:%
%:%2676=1071%:%
%:%2677=1071%:%
%:%2678=1072%:%
%:%2679=1072%:%
%:%2680=1073%:%
%:%2681=1073%:%
%:%2682=1073%:%
%:%2683=1074%:%
%:%2684=1074%:%
%:%2685=1075%:%
%:%2686=1075%:%
%:%2687=1076%:%
%:%2688=1076%:%
%:%2689=1077%:%
%:%2690=1077%:%
%:%2691=1077%:%
%:%2692=1078%:%
%:%2698=1078%:%
%:%2701=1079%:%
%:%2702=1080%:%
%:%2703=1080%:%
%:%2704=1081%:%
%:%2707=1082%:%
%:%2711=1082%:%
%:%2712=1082%:%
%:%2713=1082%:%
%:%2718=1082%:%
%:%2721=1083%:%
%:%2722=1084%:%
%:%2723=1084%:%
%:%2724=1085%:%
%:%2727=1086%:%
%:%2731=1086%:%
%:%2732=1086%:%
%:%2733=1087%:%
%:%2734=1087%:%
%:%2735=1088%:%
%:%2736=1088%:%
%:%2737=1089%:%
%:%2738=1089%:%
%:%2739=1090%:%
%:%2740=1090%:%
%:%2741=1091%:%
%:%2742=1091%:%
%:%2743=1092%:%
%:%2744=1092%:%
%:%2745=1093%:%
%:%2746=1093%:%
%:%2747=1094%:%
%:%2748=1094%:%
%:%2749=1095%:%
%:%2750=1095%:%
%:%2751=1096%:%
%:%2752=1097%:%
%:%2753=1098%:%
%:%2758=1098%:%
%:%2761=1099%:%
%:%2762=1100%:%
%:%2763=1100%:%
%:%2764=1101%:%
%:%2765=1102%:%
%:%2766=1102%:%
%:%2767=1103%:%
%:%2774=1104%:%
%:%2775=1104%:%
%:%2776=1105%:%
%:%2777=1105%:%
%:%2778=1106%:%
%:%2779=1106%:%
%:%2780=1107%:%
%:%2781=1107%:%
%:%2782=1108%:%
%:%2783=1108%:%
%:%2784=1109%:%
%:%2785=1109%:%
%:%2788=1112%:%
%:%2789=1113%:%
%:%2790=1113%:%
%:%2791=1114%:%
%:%2792=1114%:%
%:%2793=1115%:%
%:%2794=1115%:%
%:%2795=1115%:%
%:%2796=1116%:%
%:%2797=1116%:%
%:%2798=1117%:%
%:%2799=1117%:%
%:%2800=1118%:%
%:%2801=1119%:%
%:%2802=1120%:%
%:%2803=1120%:%
%:%2804=1121%:%
%:%2805=1121%:%
%:%2806=1122%:%
%:%2807=1122%:%
%:%2808=1123%:%
%:%2809=1123%:%
%:%2810=1124%:%
%:%2811=1124%:%
%:%2812=1125%:%
%:%2813=1125%:%
%:%2814=1126%:%
%:%2815=1126%:%
%:%2817=1128%:%
%:%2818=1129%:%
%:%2819=1129%:%
%:%2820=1129%:%
%:%2821=1130%:%
%:%2822=1130%:%
%:%2825=1133%:%
%:%2826=1134%:%
%:%2827=1134%:%
%:%2828=1135%:%
%:%2829=1136%:%
%:%2830=1136%:%
%:%2831=1137%:%
%:%2832=1137%:%
%:%2835=1140%:%
%:%2836=1141%:%
%:%2837=1141%:%
%:%2838=1142%:%
%:%2839=1142%:%
%:%2840=1143%:%
%:%2841=1143%:%
%:%2842=1144%:%
%:%2843=1144%:%
%:%2844=1145%:%
%:%2845=1145%:%
%:%2846=1146%:%
%:%2852=1146%:%
%:%2855=1147%:%
%:%2856=1148%:%
%:%2857=1148%:%
%:%2858=1149%:%
%:%2861=1150%:%
%:%2865=1150%:%
%:%2866=1150%:%
%:%2867=1151%:%
%:%2868=1152%:%
%:%2869=1153%:%
%:%2870=1154%:%
%:%2871=1155%:%
%:%2872=1156%:%
%:%2873=1156%:%
%:%2874=1157%:%
%:%2875=1158%:%
%:%2876=1159%:%
%:%2881=1159%:%
%:%2884=1160%:%
%:%2885=1161%:%
%:%2886=1161%:%
%:%2887=1162%:%
%:%2888=1163%:%
%:%2889=1164%:%
%:%2890=1165%:%
%:%2891=1165%:%
%:%2892=1166%:%
%:%2893=1166%:%
%:%2894=1167%:%
%:%2895=1168%:%
%:%2896=1168%:%
%:%2897=1169%:%
%:%2898=1169%:%
%:%2899=1170%:%
%:%2900=1170%:%
%:%2901=1171%:%
%:%2902=1171%:%
%:%2909=1172%:%
