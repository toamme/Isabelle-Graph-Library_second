%
\begin{isabellebody}%
\setisabellecontext{Instantiation}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Orlin's Algorithm Executable%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Instantiation\isanewline
\ \ \isakeywordTWO{imports}\ Graph{\isacharunderscore}{\kern0pt}Algorithms{\isacharunderscore}{\kern0pt}Dev{\isachardot}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Extension\isanewline
\ \ \ \ \ \ \ \ \ \ Directed{\isacharunderscore}{\kern0pt}Set{\isacharunderscore}{\kern0pt}Graphs{\isachardot}{\kern0pt}Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}RBT\isanewline
\ \ \ \ \ \ \ \ \ \ Graph{\isacharunderscore}{\kern0pt}Algorithms{\isacharunderscore}{\kern0pt}Dev{\isachardot}{\kern0pt}Bellman{\isacharunderscore}{\kern0pt}Ford{\isacharunderscore}{\kern0pt}Example\isanewline
\ \ \ \ \ \ \ \ \ \ Graph{\isacharunderscore}{\kern0pt}Algorithms{\isacharunderscore}{\kern0pt}Dev{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}Example\isanewline
\ \ \ \ \ \ \ \ \ \ Mincost{\isacharunderscore}{\kern0pt}Flow{\isacharunderscore}{\kern0pt}Algorithms{\isachardot}{\kern0pt}Orlins\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definitions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty\ Set{\isachardot}{\kern0pt}empty\ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\isanewline
\isakeywordONE{notation}\isamarkupfalse%
\ vset{\isacharunderscore}{\kern0pt}empty\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymemptyset}\isactrlsub N{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rbt{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Leaf{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}insert\ x\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}vset{\isacharunderscore}{\kern0pt}diff\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharcomma}{\kern0pt}\ {\isadigit{3}}{\isacharcomma}{\kern0pt}\ {\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
set of edges%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ List{\isachardot}{\kern0pt}find{\isachardoublequoteclose}\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ are{\isacharunderscore}{\kern0pt}all\ \isakeywordTWO{where}\ {\isachardoublequoteopen}are{\isacharunderscore}{\kern0pt}all\ P\ {\isacharparenleft}{\kern0pt}Nil{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}are{\isacharunderscore}{\kern0pt}all\ P\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}P\ x\ {\isasymand}\ are{\isacharunderscore}{\kern0pt}all\ P\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ distinct{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{notation}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}empty\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymemptyset}\isactrlsub G{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}t{\isachardot}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ t\ {\isasymand}\ \ rbt{\isacharunderscore}{\kern0pt}red\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}t{\isachardot}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ t\ {\isasymand}\ \ rbt{\isacharunderscore}{\kern0pt}red\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}t{\isachardot}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ t\ {\isasymand}\ \ rbt{\isacharunderscore}{\kern0pt}red\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}t{\isachardot}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ t\ {\isasymand}\ \ rbt{\isacharunderscore}{\kern0pt}red\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}t{\isachardot}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ t\ {\isasymand}\ \ rbt{\isacharunderscore}{\kern0pt}red\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree\isanewline
\ \ \ \ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bool\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymtimes}\ bool{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree\isanewline
\ \ \ \ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymtimes}\ bool{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymtimes}\ real{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree\isanewline
\ \ \ \ \ \ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymtimes}\ real{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ rep\ f{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ rep{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharparenleft}{\kern0pt}f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ rep\ f\ g{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharparenright}{\kern0pt}\ \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ rep\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ g\ rep\ {\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ rep\ f{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep\ {\isasymLongrightarrow}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ rep{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ rep\ f{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ rep{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ nblckd\ f{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ nblckd\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ nblckd{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharparenleft}{\kern0pt}f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ nblckd\ f\ g{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ nblckd\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd{\isacharparenright}{\kern0pt}\ \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ nblckd\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ g\ nblckd\ {\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ nblckd\ f{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ nblckd\ {\isasymLongrightarrow}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ nblckd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ nblckd\ f{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ nblckd\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ f\ nblckd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ nblckd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ fl\ f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ fl\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ f\ fl{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharparenleft}{\kern0pt}f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ fl\ f\ g{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ fl\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl{\isacharparenright}{\kern0pt}\ \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ x\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ f\ fl\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ g\ fl\ {\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ fl\ f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ fl\ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ f\ fl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymAnd}\ fl\ f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ fl\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ f\ fl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ fl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}max{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ b\ f{\isachardot}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\ b\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
\ {\isasymLongrightarrow}\ get{\isacharunderscore}{\kern0pt}max\ f\ b\ {\isacharequal}{\kern0pt}\ Max\ {\isacharbraceleft}{\kern0pt}f\ y\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ y{\isachardot}{\kern0pt}\ y\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}list{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ E{\isachardot}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar\ E\ {\isasymLongrightarrow}\ to{\isacharunderscore}{\kern0pt}set\ E\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ E{\isachardot}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar\ E\ {\isasymLongrightarrow}\ distinct\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ update{\isacharunderscore}{\kern0pt}all{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}def\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ update{\isacharunderscore}{\kern0pt}all{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ color{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}change\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ \ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ update{\isacharunderscore}{\kern0pt}all{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}correct{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ adj{\isacharcolon}{\kern0pt}\ Map\ \isanewline
\ \ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ \isanewline
\ \ \ \ \ \ \ \ delete{\isacharequal}{\kern0pt}delete\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ lookup\ \isakeywordTWO{and}\ invar{\isacharequal}{\kern0pt}adj{\isacharunderscore}{\kern0pt}inv\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def\ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ adj{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}def\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}satisfied\ {\isacharequal}{\kern0pt}\ adj{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}satisified\ {\isacharequal}{\kern0pt}\ dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}vset{\isachardot}{\kern0pt}set{\isachardot}{\kern0pt}Set{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}axioms\ vset{\isacharunderscore}{\kern0pt}empty\ isin\ sel{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ \isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ s\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ rule{\isacharcolon}{\kern0pt}\ sel{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}satisfied\ {\isacharequal}{\kern0pt}\ dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}vset{\isachardot}{\kern0pt}Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs\ map{\isacharunderscore}{\kern0pt}empty\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete\ lookup\ vset{\isacharunderscore}{\kern0pt}insert\ isin\ t{\isacharunderscore}{\kern0pt}set\ sel\isanewline
\ \ \ \ \ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ adj{\isacharunderscore}{\kern0pt}inv\ vset{\isacharunderscore}{\kern0pt}empty\ vset{\isacharunderscore}{\kern0pt}delete\ vset{\isacharunderscore}{\kern0pt}inv\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}satisfied\ Map{\isacharunderscore}{\kern0pt}satisfied\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}def\ map{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied\ {\isacharequal}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Set{\isadigit{2}}{\isacharunderscore}{\kern0pt}satisfied\ {\isacharequal}{\kern0pt}\ dfs{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}ops{\isachardot}{\kern0pt}Set{\isadigit{2}}{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vset{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ list{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ M{\isachardot}{\kern0pt}invar{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}\ \isanewline
\ Map\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ \ \ \ \ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}connection\ {\isacharequal}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}connection{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec\ {\isacharequal}{\kern0pt}\ bellford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation\ {\isacharequal}{\kern0pt}\isanewline
\isanewline
\ Map{\isacharunderscore}{\kern0pt}realising{\isacharcolon}{\kern0pt}\ Map\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}realising{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}realising{\isacharunderscore}{\kern0pt}type{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
\ Map{\isacharunderscore}{\kern0pt}bal{\isacharcolon}{\kern0pt}\ Map\ bal{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}bal{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}bal{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}delete\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
\ Map{\isacharunderscore}{\kern0pt}flow{\isacharcolon}{\kern0pt}\ Map\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}\ Map\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bool\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}nb{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}nb{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
\ Map\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}rcomp{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}rcomp{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
\isakeywordTWO{for}\ \isanewline
\isanewline
realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\ \isanewline
realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ \isanewline
realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\ \isanewline
realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ \isanewline
realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
bal{\isacharunderscore}{\kern0pt}empty\ \isanewline
bal{\isacharunderscore}{\kern0pt}update\ \isanewline
bal{\isacharunderscore}{\kern0pt}delete\ \isanewline
bal{\isacharunderscore}{\kern0pt}lookup\ \isanewline
bal{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
flow{\isacharunderscore}{\kern0pt}empty\ \isanewline
flow{\isacharunderscore}{\kern0pt}update\ \isanewline
flow{\isacharunderscore}{\kern0pt}delete\ \isanewline
flow{\isacharunderscore}{\kern0pt}lookup\ \isanewline
flow{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ \isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ \isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ \isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ \isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar{\isacharplus}{\kern0pt}\isanewline
\isanewline
\isakeywordTWO{fixes}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}impl\ \isanewline
\isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}list{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ list{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ fst{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isakeywordTWO{and}\ snd{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ \ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}bal{\isacharunderscore}{\kern0pt}impl\isanewline
\isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ set{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ option{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ e\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymu}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isachardot}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymc}\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}c{\isacharunderscore}{\kern0pt}lookup\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ e{\isacharparenright}{\kern0pt}\ \ of\ Some\ c\ {\isasymRightarrow}\ c\ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isasymE}\ \isakeywordTWO{where}\ {\isachardoublequoteopen}{\isasymE}\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}N\ {\isacharequal}{\kern0pt}\ length\ {\isacharparenleft}{\kern0pt}remdups\ {\isacharparenleft}{\kern0pt}map\ fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ map\ snd\ \ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}max\ {\isadigit{3}}\ {\isacharparenleft}{\kern0pt}real\ N{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymb}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ if\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ v\ {\isasymnoteq}\ None\ then\ the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ v{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}EEE\ {\isasymequiv}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}{\isasymEE}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}fstv\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}fstv\ fst\ snd{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sndv\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}sndv\ fst\ snd{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}VV\ {\isasymequiv}\ dVs\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}es\ {\isacharequal}{\kern0pt}\ remdups{\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}vs\ {\isacharequal}{\kern0pt}\ remdups\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}fst\ es{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}dfs\ F\ t\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dfs{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}impl\ F\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ F\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}dfs{\isacharunderscore}{\kern0pt}initial\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}dfs{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state\ \ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}path\ u\ v\ E\ {\isacharequal}{\kern0pt}\ rev\ {\isacharparenleft}{\kern0pt}stack\ {\isacharparenleft}{\kern0pt}dfs\ E\ v\ {\isacharparenleft}{\kern0pt}dfs{\isacharunderscore}{\kern0pt}initial\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ \isakeywordTWO{where}\ \isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}v{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}if\ b\ v\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ then\ Some\ v\ else\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ \ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ \isakeywordTWO{where}\ \isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}v{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}if\ b\ v\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ then\ Some\ v\ else\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ found{\isacharunderscore}{\kern0pt}edges{\isachardot}{\kern0pt}\ let\ ee\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair\ e\ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ found{\isacharunderscore}{\kern0pt}edges\ ee\ of\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ ee\ {\isacharbrackleft}{\kern0pt}e{\isacharbrackright}{\kern0pt}\ found{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}Some\ ds\ {\isasymRightarrow}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ ee\ {\isacharparenleft}{\kern0pt}e{\isacharhash}{\kern0pt}ds{\isacharparenright}{\kern0pt}\ found{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ list\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ list\ e\ c{\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ {\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ if\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ bestc\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ list\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ list\ e\ c{\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ {\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ if\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ bestc\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ list\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ {\isacharparenleft}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharsemicolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ {\isacharparenleft}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v\ u{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharsemicolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ nb\ {\isacharparenleft}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ es\ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo\ vs\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ nb\ {\isacharparenleft}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ es\ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo\ vs\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ \isakeywordTWO{where}\isanewline
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ \ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}v{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}if\ b\ v\ {\isacharless}{\kern0pt}\ \ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty\ then\ Some\ v\ else\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\ the{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ \isakeywordTWO{where}\isanewline
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ \ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}v{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}if\ b\ v\ {\isachargreater}{\kern0pt}\ \ \ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty\ then\ Some\ v\ else\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ the\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source\ state\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isachardoublequoteclose}\isanewline
\ \isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target\ state\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward\ state{\isacharequal}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\isanewline
\ \ \ \ \ \ in\ case\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}\ of\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Some\ t\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}let\ Pbf\ {\isacharequal}{\kern0pt}\ search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ s\ bf\ t\ Nil{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ Some\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward\ state\ {\isacharequal}{\kern0pt}\isanewline
{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t\isanewline
\ \ \ \ \ \ \ in\ case\ {\isacharparenleft}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ Some\ s\ {\isasymRightarrow}\ let\ Pbf\ {\isacharequal}{\kern0pt}itrev\ {\isacharparenleft}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ t\ bf\ s\ Nil{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ P\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ Some\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ \isakeywordTWO{where}\isanewline
{\isachardoublequoteopen}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ b\ Nil\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\isanewline
{\isachardoublequoteopen}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ b\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ b\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ state{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ vs{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}ees\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ x\ \ {\isadigit{0}}\ fl{\isacharparenright}{\kern0pt}\ ees\ flow{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}bal\ {\isacharequal}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ x\ \ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ fl{\isacharparenright}{\kern0pt}\ vs\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ x\ False\ fl{\isacharparenright}{\kern0pt}\ ees\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Choose\ {\isacharequal}{\kern0pt}\ Set{\isacharunderscore}{\kern0pt}Choose{\isacharunderscore}{\kern0pt}satisfied\isanewline
\isanewline
\isakeywordONE{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ \isanewline
\ \ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isacharcolon}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}\ lookup\ t{\isacharunderscore}{\kern0pt}set\ sel\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ adj{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vset{\isacharunderscore}{\kern0pt}empty\ vset{\isacharunderscore}{\kern0pt}delete\ vset{\isacharunderscore}{\kern0pt}insert\ vset{\isacharunderscore}{\kern0pt}inv\ isin\ \isanewline
\ \ \isakeywordTWO{defines}\ neighbourhood{\isacharequal}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}neighbourhood\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Choose\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ Map{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}adjmap{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}adjmap{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}filter{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isasymrbrakk}\ {\isasymLongrightarrow}\ set{\isacharunderscore}{\kern0pt}invar{\isacharparenleft}{\kern0pt}filter\ P\ s{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}get{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isacharsemicolon}{\kern0pt}\ {\isasymexists}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}\ {\isasymand}\ P\ x\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isasymexists}\ y{\isachardot}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ P\ s{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Some\ y{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isacharsemicolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ P\ s{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Some\ x{\isasymrbrakk}\ {\isasymLongrightarrow}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isacharsemicolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ P\ s{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Some\ x{\isasymrbrakk}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isacharsemicolon}{\kern0pt}\ {\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}\ {\isasymLongrightarrow}\ P\ x\ {\isacharequal}{\kern0pt}\ Q\ x{\isasymrbrakk}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ P\ s{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ Q\ s{\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}Some{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ P\ s{\isadigit{1}}\ x{\isacharbrackright}{\kern0pt}\ \ find{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ refl{\isacharcomma}{\kern0pt}\ of\ s{\isadigit{1}}\ P\ Q{\isacharbrackright}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ P\ s{\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ are{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}set{\isacharunderscore}{\kern0pt}invar\ S{\isasymrbrakk}\ {\isasymLongrightarrow}\ are{\isacharunderscore}{\kern0pt}all\ P\ S\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ S{\isachardot}{\kern0pt}\ P\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ S{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isacharcolon}{\kern0pt}\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}filter\ invar{\isacharunderscore}{\kern0pt}filter\ \ set{\isacharunderscore}{\kern0pt}get{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ filter{\isacharunderscore}{\kern0pt}cong\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isachardot}{\kern0pt}intro\ intro{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}get{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}filter\ simp\ add{\isacharcolon}{\kern0pt}\ are{\isacharunderscore}{\kern0pt}all\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ fastforce{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ {\isacharequal}{\kern0pt}\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isachardot}{\kern0pt}Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ Map\isanewline
\ \ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}lookup\ \isakeywordTWO{and}\ \isanewline
\ \ \ \ \ \ \ \ delete{\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ bal{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}bal\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ Map\ conv{\isacharunderscore}{\kern0pt}empty\ conv{\isacharunderscore}{\kern0pt}update\ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ conv{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ conv{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conv{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ conv{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}conv\ {\isacharequal}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}conv{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ Map\ \isanewline
\ \ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup\ \isakeywordTWO{and}\ \isanewline
\ \ \ \ \ \ \ \ delete{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ flow{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flow{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}\ \isanewline
\ Map\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ {\isacharequal}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ Map\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}M{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ \ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp\ {\isacharequal}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ selection{\isacharunderscore}{\kern0pt}functions{\isacharcolon}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation\isanewline
\ \ \isakeywordTWO{where}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}list{\isacharequal}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\isanewline
\ \ \ \ \isakeywordTWO{and}\ fst{\isacharequal}{\kern0pt}fst\isanewline
\ \ \ \ \isakeywordTWO{and}\ snd{\isacharequal}{\kern0pt}snd\isanewline
\ \ \ \ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharequal}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}lookup\isanewline
\isakeywordTWO{for}\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ \isakeywordTWO{and}\ \isanewline
\ \ \ \ c{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymRightarrow}\ real\ option{\isachardoublequoteclose}\isanewline
\isakeywordTWO{defines}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ {\isacharequal}{\kern0pt}\ \ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}target\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target\isanewline
\ \ \ \ \isakeywordTWO{and}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}flow\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}bal\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}bal\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ N\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}N\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}path\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}path\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\isanewline
\ \ \ \ \isakeywordTWO{and}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\isanewline
\ \ \ \ \isakeywordTWO{and}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\isanewline
\ \ \ \ \isakeywordTWO{and}\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward{\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward\isanewline
\ \ \ \ \isakeywordTWO{and}\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward{\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\isanewline
\ \ \ \ \isakeywordTWO{and}\ ees\ {\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}ees\isanewline
\ \ \ \ \isakeywordTWO{and}\ vs\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}vs\isanewline
\ \ \ \ \isakeywordTWO{and}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharequal}{\kern0pt}selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\isanewline
\ \ \ \ \isakeywordTWO{and}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymepsilon}\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymepsilon}\isanewline
\ \ \ \ \isakeywordTWO{and}\ es\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}es\isanewline
\ \ \ \ \isakeywordTWO{and}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}list\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymu}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymc}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymE}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymb}\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}{\isasymb}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ Map{\isacharunderscore}{\kern0pt}bal\ Map{\isacharunderscore}{\kern0pt}flow\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation\ {\isacharequal}{\kern0pt}\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ orlins{\isacharunderscore}{\kern0pt}spec{\isacharcolon}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec\ \isanewline
\ \ \isakeywordTWO{where}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlsub N{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}insert{\isacharequal}{\kern0pt}vset{\isacharunderscore}{\kern0pt}insert\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeywordTWO{and}\ isin\ {\isacharequal}{\kern0pt}\ isin\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ filter\ {\isacharequal}{\kern0pt}\ filter\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ are{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ are{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ set{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ lookup\ {\isacharequal}{\kern0pt}\ lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ t{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ t{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ sel{\isacharequal}{\kern0pt}sel\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ adjmap{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ adj{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeywordTWO{and}\ empty{\isacharunderscore}{\kern0pt}forest{\isacharequal}{\kern0pt}\ \ map{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}path\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}path\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}conv{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}conv{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}max\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}max\ \isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source\ {\isacharequal}{\kern0pt}\ \ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}target\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target\ fst\ snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}flow\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}bal\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}bal\ \ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ N\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}N\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\isanewline
\ \ \ \ \isakeywordTWO{and}\ fst\ {\isacharequal}{\kern0pt}\ fst\isanewline
\ \ \ \ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ \ {\isasymc}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymc}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ \ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymE}\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymb}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymb}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymepsilon}\ {\isacharequal}{\kern0pt}\ {\isasymepsilon}\isanewline
\ \ \isakeywordTWO{for}\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\ {\isasymepsilon}\isanewline
\isanewline
\isakeywordTWO{defines}\ initial\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}initial\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ orlins\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}orlins\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ send{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow\isanewline
\ \ \ \ \isakeywordTWO{and}\ maintain{\isacharunderscore}{\kern0pt}forest\ {\isacharequal}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ augment{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}augment{\isacharunderscore}{\kern0pt}edge\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ augment{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}augment{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ orlins{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}impl\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ augment{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}augment{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ augment{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}augment{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}path\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}path\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ add{\isacharunderscore}{\kern0pt}direction\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}direction\isanewline
\ \ \ \ \isakeywordTWO{and}\ move{\isacharunderscore}{\kern0pt}balance\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}move{\isacharunderscore}{\kern0pt}balance\isanewline
\ \ \ \ \isakeywordTWO{and}\ move{\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}move\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ insert{\isacharunderscore}{\kern0pt}undirected{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}insert{\isacharunderscore}{\kern0pt}undirected{\isacharunderscore}{\kern0pt}edge\isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}map\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}map\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}i\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\isanewline
\ \ \ \ \isakeywordTWO{and}\ new{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}new{\isacharunderscore}{\kern0pt}{\isasymgamma}\isanewline
\ \ \ \ \isakeywordTWO{and}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\isanewline
\ \ \ \ \isakeywordTWO{and}\ neighbourhood{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}neighbourhood{\isacharprime}{\kern0pt}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ Map{\isacharunderscore}{\kern0pt}bal\ Map{\isacharunderscore}{\kern0pt}conv\ Map{\isacharunderscore}{\kern0pt}flow\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ algo{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ get{\isacharunderscore}{\kern0pt}max\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isachardot}{\kern0pt}intro\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}impl{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}folded\ orlins{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ orlins{\isacharunderscore}{\kern0pt}spec\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ algo{\isacharunderscore}{\kern0pt}spec\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}algo{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Proofs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}filter{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ to{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}filter\ P\ s{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}\ {\isasymand}\ {\isasymnot}\ P\ x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}\ set{\isacharunderscore}{\kern0pt}invar\ s{\isadigit{1}}{\isacharsemicolon}{\kern0pt}\ {\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ s{\isadigit{1}}\ {\isasymLongrightarrow}\ P\ x\ {\isacharequal}{\kern0pt}\ \ Q\ x\ {\isasymrbrakk}\ {\isasymLongrightarrow}\ filter\ P\ s{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ filter\ Q\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ filter{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}OF\ refl{\isacharcomma}{\kern0pt}\ of\ s{\isadigit{1}}\ P\ Q{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}Leaf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}invar\ Leaf{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}flow{\isacharunderscore}{\kern0pt}invar\ T{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}\ T\ e{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}f\ e\ T{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrbrakk}\isanewline
\ \ \ \ {\isasymLongrightarrow}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ f\ e\ tree{\isacharparenright}{\kern0pt}\ list\ T{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\isanewline
\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ e{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ AS\ T{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ T{\isacharparenright}{\kern0pt}\ {\isasymunion}\ f\ {\isacharbackquote}{\kern0pt}\ set\ AS{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ AS{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}flow{\isacharunderscore}{\kern0pt}invar\ T{\isacharsemicolon}{\kern0pt}\ bij\ f{\isasymrbrakk}\isanewline
\ \ \ {\isasymLongrightarrow}\ \ \ flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ tree{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ e{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ AS\ T{\isacharparenright}{\kern0pt}\ x\isanewline
\ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ inv\ f\ x\ {\isasymin}\ set\ AS\ then\ Some\ {\isacharparenleft}{\kern0pt}g\ {\isacharparenleft}{\kern0pt}inv\ f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ else\ flow{\isacharunderscore}{\kern0pt}lookup\ T\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ AS{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ foldr{\isacharunderscore}{\kern0pt}Cons{\isacharcomma}{\kern0pt}\ subst\ o{\isacharunderscore}{\kern0pt}apply{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ flow{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ a\ AS\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into{\isacharunderscore}{\kern0pt}left\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ simp\ add{\isacharcolon}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ Map\ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isakeywordTWO{and}\ delete{\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}bal\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ bs\ {\isasymLongrightarrow}\ bal{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}xy\ tree{\isachardot}{\kern0pt}\ \ bal{\isacharunderscore}{\kern0pt}update\ \ {\isacharparenleft}{\kern0pt}g\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ xy\ tree{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ ES\ bs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ES{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ bs\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}xy\ tree{\isachardot}{\kern0pt}\ \ bal{\isacharunderscore}{\kern0pt}update\ \ {\isacharparenleft}{\kern0pt}g\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ xy\ tree{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ ES\ bs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ bs{\isacharparenright}{\kern0pt}\ {\isasymunion}\ g\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ ES{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ES{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ subst\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ \isanewline
\ Map\ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \ \ \ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isakeywordTWO{and}\ delete{\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ conv{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ \isanewline
\ \ Map\ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}conv{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \isakeywordTWO{and}\ delete{\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}conv\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ \isanewline
\ \ Map\ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \isakeywordTWO{and}\ delete{\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ xs\ Leaf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ invc{\isacharunderscore}{\kern0pt}upd{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ update{\isacharunderscore}{\kern0pt}def\ invh{\isacharunderscore}{\kern0pt}paint\ invh{\isacharunderscore}{\kern0pt}upd{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ color{\isacharunderscore}{\kern0pt}paint{\isacharunderscore}{\kern0pt}Black\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}red{\isacharunderscore}{\kern0pt}def\ inorder{\isacharunderscore}{\kern0pt}paint\ inorder{\isacharunderscore}{\kern0pt}upd\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sorted{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}insert{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M{\isachardot}{\kern0pt}invar\ T\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}update\ x\ y\ T{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Set{\isachardot}{\kern0pt}insert\ x\ {\isacharparenleft}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}lookup\ T{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ M{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}simplified\ update{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\ update{\isacharunderscore}{\kern0pt}def\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M{\isachardot}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ list\ Leaf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ M{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}simplified\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}fold{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dom\ {\isacharparenleft}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ xy\ tree{\isachardot}{\kern0pt}\ update\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ list\ Leaf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}fst\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}insert{\isacharbrackleft}{\kern0pt}OF\ M{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}fold{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ RBT{\isachardot}{\kern0pt}B\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof\ {\isacharequal}{\kern0pt}\ \isanewline
\isanewline
function{\isacharunderscore}{\kern0pt}generation\ \isakeywordTWO{where}\ \isanewline
\ \ \ \ \ \ \ \ \ \ to{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}{\isachardoublequoteopen}\ to{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ set{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ fst\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bool\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}impl{\isasymRightarrow}\ {\isacharprime}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ \ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}f{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}f{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}{\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}r{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}impl{\isasymRightarrow}\ {\isacharprime}{\kern0pt}r{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}{\isacharplus}{\kern0pt}\isanewline
\isanewline
Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ \ \isakeywordTWO{where}\ \isanewline
\ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}{\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ \ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ option{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharequal}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
multigraph{\isacharcolon}{\kern0pt}\ multigraph\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharplus}{\kern0pt}\isanewline
\isanewline
Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isacharcolon}{\kern0pt}\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}maper{\isacharcolon}{\kern0pt}\ Map\ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}r{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}r{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
conv{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ Map\ \ conv{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}conv{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ Redge\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}conv{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}conv{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharcolon}{\kern0pt}\ Map\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ {\isachardoublequoteopen}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ bool\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}impl{\isasymRightarrow}\ {\isacharprime}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharplus}{\kern0pt}\isanewline
\isanewline
rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}iterator\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharplus}{\kern0pt}\isanewline
\isanewline
flow{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}iterator\ flow{\isacharunderscore}{\kern0pt}invar\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharplus}{\kern0pt}\isanewline
\isanewline
not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}iterator\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\isakeywordTWO{for}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \ \ to{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ fst\ snd\ \isanewline
\ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ conv{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ conv{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ conv{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ conv{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ conv{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ flow{\isacharunderscore}{\kern0pt}update\ \ \isanewline
\ \ \ \ bal{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharplus}{\kern0pt}\ \isanewline
\isanewline
\isakeywordTWO{fixes}\ get{\isacharunderscore}{\kern0pt}max{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ real\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\isakeywordTWO{assumes}\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ b{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dVs\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ N{\isacharunderscore}{\kern0pt}gre{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}N\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}max{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ b\ f{\isachardot}{\kern0pt}\ {\isasymlbrakk}bal{\isacharunderscore}{\kern0pt}invar\ b{\isacharsemicolon}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ get{\isacharunderscore}{\kern0pt}max\ f\ b\ {\isacharequal}{\kern0pt}\ Max\ {\isacharbraceleft}{\kern0pt}f\ y\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ y{\isachardot}{\kern0pt}\ y\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ b{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}list{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ E{\isachardot}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar\ E\ {\isasymLongrightarrow}\ to{\isacharunderscore}{\kern0pt}set\ E\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ E{\isachardot}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}invar\ E\ {\isasymLongrightarrow}\ distinct\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\isanewline
\isakeywordONE{notation}\isamarkupfalse%
\ vset{\isacharunderscore}{\kern0pt}empty\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymemptyset}\isactrlsub N{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ ext\ \isanewline
simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharbrackleft}{\kern0pt}simplified\ \ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}are{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dVs\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}map\ fst\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}map\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharbrackleft}{\kern0pt}OF\ refl\ refl{\isacharbrackright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ dVs{\isacharunderscore}{\kern0pt}def\ \ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}{\isasymexists}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ {\isasymE}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ \ b{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ {\isachardoublequoteopen}dVs\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isasymepsilon}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}multigraph{\isachardot}{\kern0pt}{\isasymV}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isacharless}{\kern0pt}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}E{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{3}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}E{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{4}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{5}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{6}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}E{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ local{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}def\ N{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\ \isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{7}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{8}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}are\ N{\isacharunderscore}{\kern0pt}gre{\isacharunderscore}{\kern0pt}{\isadigit{0}}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}def\ N{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ vs{\isacharunderscore}{\kern0pt}are\ insert{\isacharunderscore}{\kern0pt}commute\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length{\isacharunderscore}{\kern0pt}remdups{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}conv\ frac{\isacharunderscore}{\kern0pt}le\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{9}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ N{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}N\ {\isacharequal}{\kern0pt}card\ VV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar\ \ local{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ card{\isacharcomma}{\kern0pt}\ OF\ refl{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ N{\isacharunderscore}{\kern0pt}def\ dVs{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\ length{\isacharunderscore}{\kern0pt}remdups{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}conv\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}{\isasymexists}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ {\isasymE}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharcolon}{\kern0pt}\ \isanewline
\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ \isakeywordTWO{where}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isasymE}\ \isakeywordTWO{and}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ {\isasymc}\ \isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isakeywordTWO{and}\ fst\ {\isacharequal}{\kern0pt}\ fst\ \isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ multigraph{\isachardot}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymcc}\ {\isasymequiv}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}oedge\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}rcap\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ es\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ u\ v{\isachardot}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ vs\ {\isacharequal}{\kern0pt}\ VV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ prod{\isachardot}{\kern0pt}fst\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}{\isasymV}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ e{\isacharunderscore}{\kern0pt}pr{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}e\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ aa{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}\ {\isasymor}\ prod{\isachardot}{\kern0pt}swap\ e\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ pp\ \ \isakeywordTWO{where}\isanewline
\ \ \ \ \ \ f{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}X{\isadigit{1}}{\isachardot}{\kern0pt}\ pp\ X{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ X{\isadigit{1}}{\isacharcomma}{\kern0pt}\ snd\ X{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ moura\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}e\ {\isasymin}\ pp\ {\isacharbackquote}{\kern0pt}\ {\isasymE}\ {\isasymor}\ prod{\isachardot}{\kern0pt}swap\ e\ {\isasymin}\ pp\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ aa\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ e\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}pp\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ dVsI{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ dVsI{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ e\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharcomma}{\kern0pt}\ snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ f{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}{\isasymV}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}pr{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}{\isasymV}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ x\ {\isasymin}\ prod{\isachardot}{\kern0pt}fst\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ a\ b\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isasymin}{\isacharbraceleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}dVsE{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ insert{\isacharunderscore}{\kern0pt}iff\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ {\isadigit{1}}\ {\isadigit{2}}\ simp\ add{\isacharcolon}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}def\ \ es{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}E\ \ dVsI{\isacharprime}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vs\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ vs\ {\isacharequal}{\kern0pt}\ dVs\ {\isacharparenleft}{\kern0pt}set\ es{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}distinct\ vs{\isachardoublequoteclose}\ {\isachardoublequoteopen}distinct\ es{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \ es{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}E\ \ vs{\isacharunderscore}{\kern0pt}def\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ es{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}E\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}def\ es{\isacharunderscore}{\kern0pt}def\ dVs{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnot}\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\ {\isasymc}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{context}\isamarkupfalse%
\isanewline
\ \ \isakeywordTWO{assumes}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharcolon}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ \ conservative{\isacharunderscore}{\kern0pt}weights{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}{\isasymnexists}\ C{\isachardot}{\kern0pt}\ closed{\isacharunderscore}{\kern0pt}w\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ C{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}set\ C\ {\isasymsubseteq}\ {\isasymE}{\isacharparenright}{\kern0pt}\ {\isasymand}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ acc{\isachardot}{\kern0pt}\ acc\ {\isacharplus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}\ C\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ ab{\isacharunderscore}{\kern0pt}semigroup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}add{\isachardot}{\kern0pt}commute{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymc}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{thm}\isamarkupfalse%
\ algo{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ algo{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ algo{\isacharunderscore}{\kern0pt}axioms\ snd\ {\isasymu}\ {\isasymc}\ {\isasymE}\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ lookup\ adj{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymepsilon}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ map{\isacharunderscore}{\kern0pt}empty\ N\ fst{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ N{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}adjmap{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}adjmap{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ dfs{\isacharunderscore}{\kern0pt}defs\ {\isacharequal}{\kern0pt}\ dfs{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharequal}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isachardoublequoteclose}\isanewline
\isakeywordTWO{and}\ same{\isacharunderscore}{\kern0pt}neighbourhoods{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}neighbourhood\ {\isacharequal}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}neighbourhood{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ ext\ \isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}neighbourhood{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}neighbourhood{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}extended{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}cond\ {\isasymemptyset}\isactrlsub N\ vset{\isacharunderscore}{\kern0pt}inv\ isin\ lookup\isanewline
\ \ \ \ \ \ \ \ \ \ \ t{\isacharunderscore}{\kern0pt}set\ \ adj{\isacharunderscore}{\kern0pt}inv\ get{\isacharunderscore}{\kern0pt}path\ u\ v\ {\isacharparenleft}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isacharparenright}{\kern0pt}\ p\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E{\isacharparenright}{\kern0pt}\ u\ p\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}insert\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}meta{\isacharbrackleft}{\kern0pt}OF\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec\ assms{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ assms\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ graph{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}graph{\isacharunderscore}{\kern0pt}inv\ E{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ finite{\isacharunderscore}{\kern0pt}graph{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}graph\ E{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ finite{\isacharunderscore}{\kern0pt}neighbs{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}vsets\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}good{\isacharunderscore}{\kern0pt}graph{\isacharunderscore}{\kern0pt}invarE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ e\ \isakeywordTWO{where}\ e{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}u\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}outgoing{\isacharunderscore}{\kern0pt}last\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ fastforce\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ neighb{\isacharunderscore}{\kern0pt}u{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}neighbourhood\ \ E\ u\ {\isasymnoteq}\ vset{\isacharunderscore}{\kern0pt}empty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}Graph{\isacharunderscore}{\kern0pt}Specs{\isacharunderscore}{\kern0pt}satisfied{\isachardot}{\kern0pt}are{\isacharunderscore}{\kern0pt}connected{\isacharunderscore}{\kern0pt}absI{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ \ graph{\isacharunderscore}{\kern0pt}invar{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ of\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ e{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}neighbourhoods\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ q{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ d\ \isakeywordTWO{where}\ {\isachardoublequoteopen}d\ {\isasymin}\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \ singleton{\isacharunderscore}{\kern0pt}hd{\isacharunderscore}{\kern0pt}last{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ q{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ vwalk{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}edge{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}butlast\ q{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}last\ q{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}simplified\ append{\isacharunderscore}{\kern0pt}butlast{\isacharunderscore}{\kern0pt}last{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}OF\ q{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}def\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}Vs{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}u\ {\isasymin}\ dVs\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ dfs{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}DFS{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}axioms\ isin\ t{\isacharunderscore}{\kern0pt}set\ adj{\isacharunderscore}{\kern0pt}inv\ {\isasymemptyset}\isactrlsub N\ vset{\isacharunderscore}{\kern0pt}inv\ lookup\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ E\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}graph\ finite{\isacharunderscore}{\kern0pt}neighbs\ graph{\isacharunderscore}{\kern0pt}invar\ u{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}Vs\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ dfs{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ same{\isacharunderscore}{\kern0pt}neighbourhoods\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}DFS{\isacharunderscore}{\kern0pt}thms\ map{\isacharunderscore}{\kern0pt}empty\ delete\ vset{\isacharunderscore}{\kern0pt}insert\ isin\ t{\isacharunderscore}{\kern0pt}set\ sel\ update\ adj{\isacharunderscore}{\kern0pt}inv\ vset{\isacharunderscore}{\kern0pt}empty\ vset{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vset{\isacharunderscore}{\kern0pt}inv\ vset{\isacharunderscore}{\kern0pt}union\ vset{\isacharunderscore}{\kern0pt}inter\ vset{\isacharunderscore}{\kern0pt}diff\ lookup\ E\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}intro\ DFS{\isacharunderscore}{\kern0pt}thms{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ simp\ add{\isacharcolon}{\kern0pt}\ dfs{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}axioms\ dfs{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ dfs{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}DFS{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}dom\ vset{\isacharunderscore}{\kern0pt}insert\ sel\ vset{\isacharunderscore}{\kern0pt}empty\ vset{\isacharunderscore}{\kern0pt}diff\ lookup\ \isanewline
\ \ \ \ E\ v\ {\isacharparenleft}{\kern0pt}dfs{\isacharunderscore}{\kern0pt}initial\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ dfs{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ rectified{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E\ {\isasymsubseteq}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}neighbourhoods\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ rectified{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}rev{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}neighbourhoods\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ reachable{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}DFS{\isacharunderscore}{\kern0pt}state{\isachardot}{\kern0pt}return\ {\isacharparenleft}{\kern0pt}dfs\ E\ v\ {\isacharparenleft}{\kern0pt}dfs{\isacharunderscore}{\kern0pt}initial\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Reachable{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}rule\ DFS{\isachardot}{\kern0pt}return{\isachardot}{\kern0pt}exhaust{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}DFS{\isacharunderscore}{\kern0pt}state{\isachardot}{\kern0pt}return\ {\isacharparenleft}{\kern0pt}dfs\ E\ v\ {\isacharparenleft}{\kern0pt}dfs{\isacharunderscore}{\kern0pt}initial\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}p{\isachardot}{\kern0pt}\ distinct\ p\ {\isasymand}\ vwalk{\isacharunderscore}{\kern0pt}bet\ {\isacharparenleft}{\kern0pt}dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E{\isacharparenright}{\kern0pt}\ u\ p\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}correct{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharcomma}{\kern0pt}\ of\ v{\isacharbrackright}{\kern0pt}\ \ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}impl{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharcomma}{\kern0pt}\ of\ v{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ dfs{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ simp\ add{\isacharcolon}{\kern0pt}\ dfs{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ q{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ \ E\ {\isacharparenright}{\kern0pt}\ u\ q{\isacharprime}{\kern0pt}\ v{\isachardoublequoteclose}\ {\isachardoublequoteopen}distinct\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}distinct{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}distinct{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ distinct{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ {\isacharparenleft}{\kern0pt}dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E{\isacharparenright}{\kern0pt}\ u\ q{\isacharprime}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ rectified{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}rev\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ False\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ \ {\isacharparenleft}{\kern0pt}dfs{\isachardot}{\kern0pt}Graph{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ u\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}stack\ {\isacharparenleft}{\kern0pt}dfs\ E\ v\ {\isacharparenleft}{\kern0pt}dfs{\isacharunderscore}{\kern0pt}initial\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ reachable\ sym{\isacharbrackleft}{\kern0pt}OF\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}impl{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharcomma}{\kern0pt}\ of\ v{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}correct{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharcomma}{\kern0pt}\ of\ v{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def\ \ dfs{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}axioms\ dfs{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ {\isacharparenleft}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ E\ {\isacharparenright}{\kern0pt}\ u\ p\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ rectified{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}subset\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}subset\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}distinct\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}correct{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ dfs{\isacharunderscore}{\kern0pt}dom\ DFS{\isacharunderscore}{\kern0pt}thms{\isachardot}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}DFS{\isacharunderscore}{\kern0pt}impl{\isacharbrackleft}{\kern0pt}OF\ dfs{\isacharunderscore}{\kern0pt}thms{\isacharbrackright}{\kern0pt}\ reachable\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ same{\isacharunderscore}{\kern0pt}neighbourhoods\ same{\isacharunderscore}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abses\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dfs{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def\ dfs{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ flow{\isacharunderscore}{\kern0pt}empty\ flow{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ local{\isachardot}{\kern0pt}flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isachardot}{\kern0pt}intro\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ domIff\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ local{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isachardot}{\kern0pt}intro\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ domIff\ Map{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}locale{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ local{\isachardot}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isachardot}{\kern0pt}intro\ map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ domIff\ {\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ algo{\isacharcolon}{\kern0pt}\ algo\isanewline
\ \ \isakeywordTWO{where}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isasymE}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ {\isasymc}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}insert\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}insert\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}inv\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ isin\ {\isacharequal}{\kern0pt}\ isin\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \ \ \isakeywordTWO{and}\ filter{\isacharequal}{\kern0pt}filter\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ are{\isacharunderscore}{\kern0pt}all{\isacharequal}{\kern0pt}are{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ set{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}set{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}lookup\isanewline
\ \ \ \ \isakeywordTWO{and}\ t{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}t{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ sel{\isacharequal}{\kern0pt}sel\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ adjmap{\isacharunderscore}{\kern0pt}inv{\isacharequal}{\kern0pt}adj{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymepsilon}\ {\isacharequal}{\kern0pt}\ {\isasymepsilon}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharequal}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}impl\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ empty{\isacharunderscore}{\kern0pt}forest{\isacharequal}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymb}\ {\isacharequal}{\kern0pt}\ {\isasymb}\ \isakeywordTWO{and}\ N\ {\isacharequal}{\kern0pt}\ N\isanewline
\ \ \ \ \isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ fst\ {\isacharequal}{\kern0pt}\ fst\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharequal}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}conv{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}intro\ algo{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}\ algo{\isacharunderscore}{\kern0pt}axioms\ algo{\isacharunderscore}{\kern0pt}def\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate{\isacharunderscore}{\kern0pt}axioms\ flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Map{\isacharunderscore}{\kern0pt}bal{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ \ conv{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}locale{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ algo\ {\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}algo{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms\ {\isasymemptyset}\isactrlsub N\ vset{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}isin{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ lookup\ t{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ adj{\isacharunderscore}{\kern0pt}inv\ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}path{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}extended{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ Maintain{\isacharunderscore}{\kern0pt}Forest{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ {\isasymu}\ {\isasymE}\ {\isasymc}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ vset{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ vset{\isacharunderscore}{\kern0pt}delete\ vset{\isacharunderscore}{\kern0pt}insert\ vset{\isacharunderscore}{\kern0pt}inv\ isin\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ lookup\ t{\isacharunderscore}{\kern0pt}set\ sel\isanewline
\ \ \ \ \ adj{\isacharunderscore}{\kern0pt}inv\ flow{\isacharunderscore}{\kern0pt}empty\ flow{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}empty\ bal{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \ bal{\isacharunderscore}{\kern0pt}delete\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ conv{\isacharunderscore}{\kern0pt}empty\ conv{\isacharunderscore}{\kern0pt}update\ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isasymb}\ get{\isacharunderscore}{\kern0pt}max\ {\isasymepsilon}\ N\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ map{\isacharunderscore}{\kern0pt}empty\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ get{\isacharunderscore}{\kern0pt}path\ fst\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ maintain{\isacharunderscore}{\kern0pt}forest{\isachardot}{\kern0pt}intro\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}algo{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\ maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}def\ algo{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\isanewline
\ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ list{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isasymlongleftrightarrow}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ e\ list{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ foldr{\isachardot}{\kern0pt}foldr{\isacharunderscore}{\kern0pt}Cons{\isacharcomma}{\kern0pt}\ subst\ o{\isacharunderscore}{\kern0pt}apply{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ True\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar{\isacharbrackleft}{\kern0pt}simplified\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}list{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ list{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}e{\isacharhash}{\kern0pt}list{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ ih\ {\isacharequal}{\kern0pt}\ Cons{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ in{\isacharunderscore}{\kern0pt}list{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Let{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ foldr{\isachardot}{\kern0pt}foldr{\isacharunderscore}{\kern0pt}Cons{\isacharcomma}{\kern0pt}\ subst\ o{\isacharunderscore}{\kern0pt}apply{\isacharcomma}{\kern0pt}subst\ ih{\isacharbrackleft}{\kern0pt}simplified\ Let{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}simplified\ Let{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ make{\isacharunderscore}{\kern0pt}pair\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}dom\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}both{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}none{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ es\ {\isasymLongrightarrow}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None\ {\isasymor}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ list\ e\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ list\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardot}{\kern0pt}\ bestc\ {\isasymle}\ cc{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list\ arbitrary{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ beste\ bestc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ {\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ insert\ ereal{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less\ nless{\isacharunderscore}{\kern0pt}le\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharcomma}{\kern0pt}\ \ fastforce{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ list\ e\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ list\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}beste{\isacharcomma}{\kern0pt}\ bestc{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardot}{\kern0pt}\ bestc\ {\isasymle}\ cc{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list\ arbitrary{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ beste\ bestc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ insert\ ereal{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less\ less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ nless{\isacharunderscore}{\kern0pt}le\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharcomma}{\kern0pt}\ fastforce{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}MInfty{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd{\isacharparenleft}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}both{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}none{\isacharbrackleft}{\kern0pt}of\ u\ v{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ imageI{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ f\ nb\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ of\ prod{\isachardot}{\kern0pt}snd\ {\isacharcomma}{\kern0pt}\ simplified\ image{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ imageI{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ f\ nb\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ prod{\isachardot}{\kern0pt}snd{\isacharcomma}{\kern0pt}\ simplified\ image{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}metis\ MInfty{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}PInfty{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ MInfty{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}ereal{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}MInfty{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd{\isacharparenleft}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}both{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}none{\isacharbrackleft}{\kern0pt}of\ v\ u{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ imageI{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ f\ nb\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ of\ prod{\isachardot}{\kern0pt}snd{\isacharcomma}{\kern0pt}\ simplified\ image{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ imageI{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ f\ nb\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ prod{\isachardot}{\kern0pt}snd{\isacharcomma}{\kern0pt}\ simplified\ image{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}metis\ MInfty{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}PInfty{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ MInfty{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}ereal{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Some{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ of\ Some\ ds\ {\isasymRightarrow}\ ds\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharequal}{\kern0pt}\ ds{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}set\ ds\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ list\ arbitrary{\isacharcolon}{\kern0pt}\ ds{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ a\ list\ ds\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ foldr{\isachardot}{\kern0pt}foldr{\isacharunderscore}{\kern0pt}Cons{\isacharcomma}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ o{\isacharunderscore}{\kern0pt}apply{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Let{\isacharunderscore}{\kern0pt}def\ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ option{\isachardot}{\kern0pt}split{\isacharcomma}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}realising{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}exhaust{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ a{\isacharcomma}{\kern0pt}\ snd\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}result{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general\ list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ ds{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}set\ ds\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Some{\isacharbrackleft}{\kern0pt}of\ list\ u\ v\ ds{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ ds\ {\isasymLongrightarrow}\isanewline
\ \ \ \ set\ ds\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}result{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isasymnoteq}PInfty{\isachardoublequoteclose}\ {\isachardoublequoteopen}oedge\ e\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}nb\ d{\isasymand}\ rcap\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ fstv\ e\ {\isacharequal}{\kern0pt}\ u\ {\isasymand}\ sndv\ e\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ {\isasymin}\ {\isasymE}\ {\isasymand}\ c\ {\isacharequal}{\kern0pt}\ {\isasymcc}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ef\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ eb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ sym{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ cb{\isacharunderscore}{\kern0pt}def\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}cf\ {\isasymle}\ cb{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}F\ ef\ {\isacharequal}{\kern0pt}\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ ef\ cf\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ \isanewline
\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ef\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ ef{\isachardoublequoteclose}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}f\ ef{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ ef{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}none{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}props\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ metis\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ list{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ list{\isacharunderscore}{\kern0pt}prop{\isacharbrackright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}inE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ef\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ef\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharbrackright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}props\ \ ereal{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}gr{\isadigit{0}}\ result{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}B\ eb\ {\isacharequal}{\kern0pt}\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ eb\ cb\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cb{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ \isanewline
\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eb\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ eb{\isachardoublequoteclose}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}f\ eb{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}none{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}props\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ metis\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ list{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ list{\isacharunderscore}{\kern0pt}prop{\isacharbrackright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}inE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}eb\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ eb\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharbrackright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}props\ \ ereal{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}gr{\isadigit{0}}\ result{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ v\ u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}c\ {\isasymnoteq}PInfty{\isachardoublequoteclose}\ {\isachardoublequoteopen}oedge\ e\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}nb\ d\ {\isasymand}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ fstv\ e\ {\isacharequal}{\kern0pt}\ u\ {\isasymand}\ sndv\ e\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ d\ {\isasymin}\ {\isasymE}\ {\isasymand}\ c\ {\isacharequal}{\kern0pt}\ {\isasymcc}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ef\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ eb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ sym{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ cb{\isacharunderscore}{\kern0pt}def\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}cf\ {\isasymle}\ cb{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}F\ ef\ {\isacharequal}{\kern0pt}\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ ef\ cf\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ef\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ ef{\isachardoublequoteclose}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}f\ ef{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ ef{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}none{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}props\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ metis\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ list{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ list{\isacharunderscore}{\kern0pt}prop{\isacharbrackright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}inE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ef\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ef\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharbrackright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}props\ \ ereal{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}gr{\isadigit{0}}\ result{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}B\ eb\ {\isacharequal}{\kern0pt}\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}simp\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ eb\ cb\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cb{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ result{\isacharunderscore}{\kern0pt}is{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eb\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ eb{\isachardoublequoteclose}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}f\ eb{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}none{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}props\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ metis\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ list{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymand}\ make{\isacharunderscore}{\kern0pt}pair\ e\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ list{\isacharunderscore}{\kern0pt}prop{\isacharbrackright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}inE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}eb\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ eb\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}inE{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharbrackright}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}Set\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}props\ \ ereal{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}gr{\isadigit{0}}\ result{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ EEE{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}{\isasymEE}{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ EEE\ {\isacharequal}{\kern0pt}\ set\ es{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ d{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ d{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ {\isasymE}{\isacharsemicolon}{\kern0pt}\ d\ {\isasymin}\ {\isasymE}{\isasymrbrakk}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ make{\isacharunderscore}{\kern0pt}pair\ {\isacharbackquote}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ a\ b\ d\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ imageI\ swap{\isacharunderscore}{\kern0pt}simp\ swap{\isacharunderscore}{\kern0pt}swap{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair\ x\ {\isacharsemicolon}{\kern0pt}\ x\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isasymrbrakk}{\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pair\ x\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}F\ d\ {\isacharbar}{\kern0pt}d{\isachardot}{\kern0pt}\ d\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}B\ d\ {\isacharbar}{\kern0pt}d{\isachardot}{\kern0pt}\ d\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ a\ b\ x\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ UnI{\isadigit{1}}\ imageI\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair\ x\ {\isacharsemicolon}{\kern0pt}\ x\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharbackquote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}F\ d\ {\isacharbar}{\kern0pt}d{\isachardot}{\kern0pt}\ d\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}B\ d\ {\isacharbar}{\kern0pt}d{\isachardot}{\kern0pt}\ d\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ a\ b\ x\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymEE}{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ swap{\isacharunderscore}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ es{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}E\ EEE{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymEE}{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ help{\isadigit{1}}\ help{\isadigit{2}}\ help{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\ \ \ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\ {\isasymnot}\ x{\isadigit{2}}a\ {\isasymle}\ x{\isadigit{2}}b\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}a{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{1}}\ x{\isadigit{2}}a\ x{\isadigit{1}}a\ x{\isadigit{2}}b\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ v\ u{\isacharbrackright}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None\ {\isacharsemicolon}{\kern0pt}x{\isadigit{2}}a\ {\isasymle}\ x{\isadigit{2}}b\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}a{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}{\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{1}}\ x{\isadigit{2}}a\ x{\isadigit{1}}a\ x{\isadigit{2}}b\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ u\ v{\isacharbrackright}{\kern0pt}\ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}a\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}a\ {\isacharsemicolon}{\kern0pt}\ x{\isadigit{2}}b\ {\isasymle}\ x{\isadigit{2}}c\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}a\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}c{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}{\isasymLongrightarrow}\isanewline
\ \ \ \ make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{2}}a\ x{\isadigit{1}}\ x{\isadigit{2}}b\ x{\isadigit{1}}a\ x{\isadigit{2}}c\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}a{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ \ x{\isadigit{2}}c\ f\ nb\ x{\isadigit{2}}a\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}a\ {\isacharsemicolon}{\kern0pt}{\isasymnot}\ x{\isadigit{2}}b\ {\isasymle}\ x{\isadigit{2}}c\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}a\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}c{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{2}}a\ x{\isadigit{1}}\ x{\isadigit{2}}b\ x{\isadigit{1}}a\ x{\isadigit{2}}c\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}a{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ \ x{\isadigit{2}}c\ f\ nb\ x{\isadigit{2}}a\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ help{\isadigit{4}}\ help{\isadigit{5}}\ help{\isadigit{6}}\ help{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ v\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}{\isasymnot}\ x{\isadigit{2}}a\ {\isasymle}\ x{\isadigit{2}}b\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}a{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{1}}\ x{\isadigit{2}}a\ x{\isadigit{1}}a\ x{\isadigit{2}}b\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ v\ u{\isacharbrackright}{\kern0pt}\ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None\ {\isacharsemicolon}{\kern0pt}\ x{\isadigit{2}}a\ {\isasymle}\ x{\isadigit{2}}b\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}a{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{1}}\ x{\isadigit{2}}a\ x{\isadigit{1}}a\ x{\isadigit{2}}b\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ u\ v{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}a\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}a\ {\isacharsemicolon}{\kern0pt}\ x{\isadigit{2}}b\ {\isasymle}\ x{\isadigit{2}}c\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}a\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}c{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{2}}a\ x{\isadigit{1}}\ x{\isadigit{2}}b\ x{\isadigit{1}}a\ x{\isadigit{2}}c\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}a{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ \ x{\isadigit{2}}c\ f\ nb\ x{\isadigit{2}}a\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ local{\isachardot}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ x{\isadigit{2}}a\ {\isacharsemicolon}{\kern0pt}\ {\isasymnot}\ x{\isadigit{2}}b\ {\isasymle}\ x{\isadigit{2}}c\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ x{\isadigit{2}}a\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}a{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}c{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ local{\isachardot}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ x{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isacharparenright}{\kern0pt}\ {\isasyminfinity}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}b{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ x{\isadigit{1}}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ x{\isadigit{2}}\ x{\isadigit{2}}a\ x{\isadigit{1}}\ x{\isadigit{2}}b\ x{\isadigit{1}}a\ x{\isadigit{2}}c\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ u\ v\ x{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}of\ v\ u\ x{\isadigit{2}}a{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}\ x{\isadigit{2}}b\ f\ nb\ x{\isadigit{2}}\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ u\ v{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ x{\isadigit{1}}a\ \ x{\isadigit{2}}c\ f\ nb\ x{\isadigit{2}}a\ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ v\ u{\isachardoublequoteclose}\ PInfty{\isacharcomma}{\kern0pt}\ OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ create{\isacharunderscore}{\kern0pt}edge\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ help{\isadigit{1}}\ help{\isadigit{2}}\ help{\isadigit{3}}\ help{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ es{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ u\ v{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ simplified\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharbrackleft}{\kern0pt}of\ nb\ f\ u\ v{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ es{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ u\ v{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ simplified\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}of\ nb\ f\ u\ v{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ \ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ \ \ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ MInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}MInfty\ {\isacharless}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ u\ v\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}MInfty\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}connection\ MInfty\ \ vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es\ \ costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}es\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}fw{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford\isanewline
\ \ \isakeywordTWO{where}\ connection{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ es{\isacharequal}{\kern0pt}\ es\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ vs{\isacharequal}{\kern0pt}vs\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ edge{\isacharunderscore}{\kern0pt}costs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \isakeywordTWO{for}\ nb\ f\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}sym{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ e\ {\isasymin}\ set\ es\ {\isasymLongrightarrow}\ e\ {\isasymin}\ set\ es{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ MInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}MInfty\ {\isacharless}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ u\ v\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}MInfty\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}connection\ MInfty\ \ vs{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}es\ costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}es\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}def\ \ es{\isacharunderscore}{\kern0pt}sym\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ intro{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}bw{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford\ \isanewline
\ \ \isakeywordTWO{where}\ connection{\isacharunderscore}{\kern0pt}update{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}empty{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ connection{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}connection{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ es{\isacharequal}{\kern0pt}\ es\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ vs{\isacharequal}{\kern0pt}vs\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ edge{\isacharunderscore}{\kern0pt}costs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isakeywordTWO{for}\ nb\ f\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}Some\ res\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ b\ res\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ res\ {\isasymin}\ set\ xs\ {\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}Some\ res\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ b\ res\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ res\ {\isasymin}\ set\ xs\ {\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}underlying{\isacharunderscore}{\kern0pt}invars\ {\isacharparenleft}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isasymequiv}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}isOptflow\ {\isacharparenleft}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isasymequiv}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}isOptflow\ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymF}\ state\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}{\isasymF}\ \ {\isacharparenleft}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}resreach\ {\isasymequiv}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}resreach{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isasymequiv}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}gamma\ {\isacharparenleft}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma\ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}augcycle\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augcycle{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}prepath\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ {\isasymF}{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}{\isasymF}{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ {\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ \ algo{\isachardot}{\kern0pt}{\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ prepath{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ augpath{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ realising{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}general{\isacharunderscore}{\kern0pt}invar{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ both{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ es\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None\ {\isasymor}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}oedge\ e\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}C\ {\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}c\ {\isasymle}\ {\isasymcc}\ e\ {\isasymand}\ c\ {\isasymnoteq}\ MInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}conv{\isacharbrackleft}{\kern0pt}of\ C\ c{\isacharcomma}{\kern0pt}\ symmetric{\isacharcomma}{\kern0pt}\ simplified\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ \isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ set\ es{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split\ option{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ ines\ {\isacharequal}{\kern0pt}\ this{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharcomma}{\kern0pt}\ fstv\ e{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ef\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ eb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ goalI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ MInfty\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}case{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ cb{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ e{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}rule\ goalI{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}simp\ only{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymAnd}\ ee\ cc{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}{\isasymin}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymLongrightarrow}\ cf\ {\isasymle}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ ef\ cf\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}\ cf{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ listexists{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ee\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified\ listexists{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ listexists{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ listexists\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isasymle}\ {\isasymc}\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ ee{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}u\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ of\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymAnd}\ ee\ cc{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}{\isasymin}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymLongrightarrow}\ cb\ {\isasymle}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ eb\ cb\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}\ cb{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ listexists{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharcomma}{\kern0pt}\ fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{2}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ee\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified\ listexists{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ listexists{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{2}}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ listexists\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cb\ {\isasymle}\ {\isacharminus}{\kern0pt}\ {\isasymc}\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ ee{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}u\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cb\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ of\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}oedge\ e\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}nb\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}C\ {\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}c\ {\isasymle}\ {\isasymcc}\ e\ {\isasymand}\ c\ {\isasymnoteq}\ MInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}conv{\isacharbrackleft}{\kern0pt}of\ C\ c{\isacharcomma}{\kern0pt}\ symmetric{\isacharcomma}{\kern0pt}\ simplified\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ set\ es{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ ines\ {\isacharequal}{\kern0pt}\ this{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ingoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isakeywordTWO{where}\ {\isachardoublequoteopen}outgoing{\isacharunderscore}{\kern0pt}edges\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharcomma}{\kern0pt}\ fstv\ e{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ None\ {\isasymRightarrow}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ list\ {\isasymRightarrow}\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ef\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ef\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ eb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}eb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cb\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cb\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ goalI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}if\ cf\ {\isasymle}\ cb\ then\ {\isacharparenleft}{\kern0pt}F\ ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}B\ eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ MInfty\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}case{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def\ cb{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ e{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}rule\ goalI{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ all\ {\isacartoucheopen}simp\ only{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymu}\ e{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ef{\isacharcomma}{\kern0pt}\ cf{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymAnd}\ ee\ cc{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}{\isasymin}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymLongrightarrow}\ cf\ {\isasymle}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ ef\ cf\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}\ cf{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ ef{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ listexists{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharcomma}{\kern0pt}\ sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ee\ {\isasymin}\ set\ ingoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified\ listexists{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ listexists{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ listexists\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isasymle}\ {\isasymc}\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ ee{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}u\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cf\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ of\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ \isakeywordTWO{where}\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isacharcomma}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges\ {\isasymand}\ nb\ e\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}f\ e{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eb{\isacharcomma}{\kern0pt}\ cb{\isacharparenright}{\kern0pt}\ {\isasymin}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymAnd}\ ee\ cc{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ee{\isacharcomma}{\kern0pt}\ cc{\isacharparenright}{\kern0pt}{\isasymin}edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs\ {\isasymLongrightarrow}\ cb\ {\isasymle}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}of\ eb\ cb\ f\ nb\ outgoing{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharbrackright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}\ cb{\isacharunderscore}{\kern0pt}def\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def\ eb{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ list\ \isakeywordTWO{where}\ listexists{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharcomma}{\kern0pt}\ fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{2}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ es{\isacharunderscore}{\kern0pt}def\ \ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ee\ {\isasymin}\ set\ outgoing{\isacharunderscore}{\kern0pt}edges{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ ingoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sndv\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ e{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified\ listexists{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}result{\isacharbrackleft}{\kern0pt}OF\ listexists{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{2}}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ listexists\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ outgoing{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cb\ {\isasymle}\ {\isacharminus}{\kern0pt}\ {\isasymc}\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ ee{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}ingoing\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ ee{\isacharbrackright}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}u\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cb\ {\isasymnoteq}MInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ ef{\isacharunderscore}{\kern0pt}cf{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}cheapest{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse\ refl{\isacharcomma}{\kern0pt}\ of\ f\ nb\ ingoing{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ PInfty{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ PInfty\isanewline
\ {\isasymLongrightarrow}\ nb\ {\isacharparenleft}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props\ prod{\isachardot}{\kern0pt}exhaust{\isacharunderscore}{\kern0pt}sel\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ PInfty\isanewline
\ {\isasymLongrightarrow}\ nb\ {\isacharparenleft}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props\ prod{\isachardot}{\kern0pt}exhaust{\isacharunderscore}{\kern0pt}sel\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ nb\ f\ {\isasymequiv}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isasymequiv}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isacharless}{\kern0pt}\ \ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ \isanewline
\ \ {\isasymlongleftrightarrow}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}let\ x\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ in\ x\ {\isasymin}\ set\ xs\ {\isasymand}\ b\ x\ {\isacharless}{\kern0pt}\ \ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}all\ {\isacartoucheopen}induction\ connections\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isacharless}{\kern0pt}\ \ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ \isanewline
\ \ \ \ res\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymrbrakk}\isanewline
\ \ {\isasymLongrightarrow}\ b\ res\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ res\ {\isasymin}\ set\ xs\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ res{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ induction\ connections\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isachargreater}{\kern0pt}\ \ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}\ \isanewline
\ \ {\isasymlongleftrightarrow}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}let\ x\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ in\ x\ {\isasymin}\ set\ xs\ {\isasymand}\ b\ x\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\ all\ {\isacartoucheopen}induction\ connections\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}{\isasymexists}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isachargreater}{\kern0pt}\ \ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ \isanewline
\ \ \ \ \ res\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux\ connections\ b\ {\isasymgamma}\ xs{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ \isanewline
\ \ {\isasymLongrightarrow}\ b\ res\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ res\ {\isasymin}\ set\ xs\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ res{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ induction\ connections\ b\ {\isasymgamma}\ xs\ rule{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ force{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isacharcolon}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec\isanewline
\ \ \isakeywordTWO{where}\ {\isasymE}\ {\isacharequal}{\kern0pt}\ {\isasymE}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymc}\ {\isacharequal}{\kern0pt}\ {\isasymc}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymu}\ {\isacharequal}{\kern0pt}\ {\isasymu}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}insert\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}insert\isanewline
\ \ \ \ \isakeywordTWO{and}\ vset{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ vset{\isacharunderscore}{\kern0pt}inv\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ isin\ {\isacharequal}{\kern0pt}\ isin\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \ \ \isakeywordTWO{and}\ filter{\isacharequal}{\kern0pt}filter\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ are{\isacharunderscore}{\kern0pt}all{\isacharequal}{\kern0pt}are{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ set{\isacharunderscore}{\kern0pt}invar{\isacharequal}{\kern0pt}set{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \ \ \isakeywordTWO{and}\ to{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}to{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ t{\isacharunderscore}{\kern0pt}set{\isacharequal}{\kern0pt}t{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ sel{\isacharequal}{\kern0pt}sel\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ adjmap{\isacharunderscore}{\kern0pt}inv{\isacharequal}{\kern0pt}adj{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymepsilon}\ {\isacharequal}{\kern0pt}\ {\isasymepsilon}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharequal}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}impl\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ empty{\isacharunderscore}{\kern0pt}forest{\isacharequal}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \isakeywordTWO{and}\ {\isasymb}\ {\isacharequal}{\kern0pt}\ {\isasymb}\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ N\ {\isacharequal}{\kern0pt}\ N\isanewline
\ \ \ \ \isakeywordTWO{and}\ snd\ {\isacharequal}{\kern0pt}\ snd\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ fst\ {\isacharequal}{\kern0pt}\ fst\ \ \isanewline
\ \ \ \ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge{\isacharequal}{\kern0pt}create{\isacharunderscore}{\kern0pt}edge\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}bal{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ bal{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}conv{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ conv{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ conv{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete{\isacharequal}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\isanewline
\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharequal}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}source\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\isanewline
\ \ \ \ \isakeywordTWO{and}\ get{\isacharunderscore}{\kern0pt}target{\isacharequal}{\kern0pt}get{\isacharunderscore}{\kern0pt}target\isanewline
\ \ \ \ \isakeywordTWO{and}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharequal}{\kern0pt}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}intro\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}algo{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond\ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond\ \ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond\ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond\ \ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}cond\ \ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}cond\ \ state\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}cond\ \ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}cond\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}cond{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isasymequiv}\ algo{\isachardot}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymV}\ {\isasymequiv}\ multigraph{\isachardot}{\kern0pt}{\isasymV}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{1}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}fail{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}call{\isadigit{2}}{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}\isanewline
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}graph\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}graph{\isachardoublequoteclose}\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharcolon}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ Some\ s\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\ state{\isasymrbrakk}\ \isanewline
\ \ \ \ \ \ \ {\isasymLongrightarrow}\ s\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}{\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ Some\ s\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\ state{\isasymrbrakk}\ \isanewline
\ \ \ \ \ \ \ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ s\ {\isasymin}\ {\isasymV}{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ s\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}condE\ elim{\isacharcolon}{\kern0pt}\ \ vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}cond\ s\ state\ b\ {\isasymgamma}\ {\isasymLongrightarrow}\ s\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}cond\ state\ b\ \ {\isasymgamma}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ s\ {\isasymin}\ {\isasymV}{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ s\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}condE\ elim{\isacharcolon}{\kern0pt}\ \ vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}cond\ t\ state\ b\ {\isasymgamma}\ {\isasymLongrightarrow}\ t\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}cond\ state\ b\ \ {\isasymgamma}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ t\ {\isasymin}\ {\isasymV}{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ t\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}condE\ elim{\isacharcolon}{\kern0pt}\ \ vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ \ Some\ t\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target\ state{\isasymrbrakk}\isanewline
\ \ \ \ {\isasymLongrightarrow}\ t\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isasymrbrakk}\ \isanewline
\ \ \ \ {\isasymLongrightarrow}\ \ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ t\ {\isasymin}\ {\isasymV}{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ t\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}condE\ elim{\isacharcolon}{\kern0pt}\ \ vertex{\isacharunderscore}{\kern0pt}selection{\isacharunderscore}{\kern0pt}condE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ e{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ pp\ {\isasymLongrightarrow}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ UNIV\ s\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ pp{\isacharparenright}{\kern0pt}\ tt{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ s{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fstv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connection{\isacharunderscore}{\kern0pt}delete\ es\ vs\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}weight\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ induction\ pp\ \ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ x\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ e\ d\ es{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}ends{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sndv\ e\ {\isacharequal}{\kern0pt}\ fstv\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ d{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ nb\ f\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\ {\isacharhash}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}e\ {\isacharhash}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ weight\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}ends\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ d{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ \ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto\ intro{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ e{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ UNIV{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ True\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ pp\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}weight\ nb\ f\ pp\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ {\isachardoublequoteopen}ppp\ {\isacharequal}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ pp{\isachardoublequoteclose}\ \ \ \ \ \ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}awalk\ UNIV\ \ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}\ ppp\ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ weight\ nb\ f\ pp\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ acc{\isachardot}{\kern0pt}\ {\isasymcc}\ e\ {\isacharplus}{\kern0pt}\ acc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp{\isacharparenright}{\kern0pt}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nb\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ \ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ \ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ pp\ arbitrary{\isacharcolon}{\kern0pt}\ ppp\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{3}}{\isacharunderscore}{\kern0pt}len{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ len\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp\ {\isacharparenleft}{\kern0pt}last\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ nb\ f\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ ereal\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap{\isachardot}{\kern0pt}simps\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ x\ y\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{thm}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ppp\ {\isacharparenleft}{\kern0pt}last\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ {\isacharbrackright}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ weight\ nb\ f\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weight\ nb\ f\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ nb\ f\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
ereal\isanewline
\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ calculation{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymcc}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}\ calculation{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}isOptflow\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}underlying{\isacharunderscore}{\kern0pt}invars\ state{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ \ {\isachardoublequoteopen}{\isasymnexists}c{\isachardot}{\kern0pt}\ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ hd\ c\ {\isacharequal}{\kern0pt}\ last\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ nexistsI{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ c\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ c\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ c{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}c\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cc\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cc\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ List{\isachardot}{\kern0pt}list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ map{\isacharunderscore}{\kern0pt}ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ map{\isacharunderscore}{\kern0pt}ext\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ cc{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}cc\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ cc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ cc{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ cc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ helper{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ c\ {\isacharequal}{\kern0pt}\ v\ {\isacharhash}{\kern0pt}\ v{\isacharprime}{\kern0pt}\ {\isacharhash}{\kern0pt}\ l{\isacharsemicolon}{\kern0pt}\ cc\ {\isacharequal}{\kern0pt}\ z\ {\isacharhash}{\kern0pt}\ zs{\isacharsemicolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}edge\ z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ zs\ {\isacharequal}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharhash}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ awalk\ UNIV\ v\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharhash}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ l\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ then\ v{\isacharprime}{\kern0pt}\ else\ last\ l{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}zs\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ awalk\ UNIV\ v\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}v{\isacharcomma}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharhash}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}last\ zs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{for}\ v\ v{\isacharprime}{\kern0pt}\ l\ z\ zs\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ intro{\isacharcolon}{\kern0pt}\ helper{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ prepath{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ cc{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ agpath{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ cc{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ cc\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ c{\isadigit{1}}\ c{\isadigit{2}}\ \isakeywordTWO{where}\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}c{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}c{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ c{\isacharbrackright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ c{\isacharbrackright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}infty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Costs{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}pinfty{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ c{\isacharunderscore}{\kern0pt}split\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharunderscore}{\kern0pt}def\ \ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}active{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}def\ \ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ C\ \isakeywordTWO{where}\ {\isachardoublequoteopen}augcycle\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augcycle{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}distinct{\isacharunderscore}{\kern0pt}cycle{\isacharbrackleft}{\kern0pt}OF\ \ agpath{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}f\ c{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}f{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \ cc{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}min{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}augcycle\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}ax{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}\ {\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isacharsemicolon}{\kern0pt}\ Some\ s\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}P{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma\ state{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ underlying{\isacharunderscore}{\kern0pt}invars\ state{\isasymrbrakk}\isanewline
\ \ {\isasymLongrightarrow}\ t\ {\isasymin}\ VV\ {\isasymand}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isacharparenright}{\kern0pt}\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ {\isasymand}\ s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ one\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s{\isachardoublequoteclose}\isanewline
\ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ \ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}opt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}tt{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ tt{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ tt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}tt\ {\isacharequal}{\kern0pt}\ the\ tt{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ s\ bf\ tt\ Nil{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ PP\ \isakeywordTWO{where}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}tt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}tt{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ Some\ tt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Some\ tt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Some\ {\isacharparenleft}{\kern0pt}tt{\isacharcomma}{\kern0pt}\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ tt{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}def\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}tt\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isakeywordTWO{and}\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}tt\ {\isasymin}\ set\ local{\isachardot}{\kern0pt}vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ tt\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ tt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ bf\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ Some\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ connections\ \isakeywordTWO{where}\ {\isachardoublequoteopen}connections\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ tt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ t\ {\isasymin}\ set\ vs\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}props\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}t\ connections{\isacharunderscore}{\kern0pt}def\ \ bf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymnoteq}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ s{\isacharunderscore}{\kern0pt}prop\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ \ connections{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\ t{\isacharunderscore}{\kern0pt}prop\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ rev\ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ connection{\isacharunderscore}{\kern0pt}lookup\ s\ connections\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\ \ s{\isacharunderscore}{\kern0pt}prop\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ connections\ s\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path\ vs\isanewline
\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\ t\isanewline
\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ connection{\isacharunderscore}{\kern0pt}lookup\ s\ connections\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\ \ s{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}computation{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optimum{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ Pbf{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ereal\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ simp\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ereal\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ P\ \isakeywordTWO{where}\ {\isachardoublequoteopen}P\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ P{\isacharunderscore}{\kern0pt}def\ {\isacharcomma}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ List{\isachardot}{\kern0pt}list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ P{\isacharparenright}{\kern0pt}\ \isanewline
{\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ length{\isacharunderscore}{\kern0pt}Pbf\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharbrackleft}{\kern0pt}OF\ UNIV{\isacharunderscore}{\kern0pt}I\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ same{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ Pbf\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ P{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ P{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ P\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ c{\isadigit{1}}\ c{\isadigit{2}}\ \isakeywordTWO{where}\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}c{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}c{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ Pbf{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ Pbf{\isacharbrackright}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ Pbf{\isacharbrackright}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}infty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Costs{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}pinfty{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ c{\isacharunderscore}{\kern0pt}split\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ P{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ one{\isacharparenleft}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invarsE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}activeE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}resreach\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\ \ \isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ t{\isacharunderscore}{\kern0pt}prop\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ t{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}s\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs{\isacharcolon}{\kern0pt}\isanewline
\isakeywordTWO{assumes}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ oedge\ qq{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ {\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordTWO{and}\ \ qq{\isacharunderscore}{\kern0pt}len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ qq\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \isakeywordTWO{shows}\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ qq\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{2}}{\isacharunderscore}{\kern0pt}len{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}len\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ surjective{\isacharunderscore}{\kern0pt}pairing\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ del{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ e\ d\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{1}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee\ \ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ dd\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharsemicolon}{\kern0pt}\ ee\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharsemicolon}{\kern0pt}\ oedge\ {\isacharbackquote}{\kern0pt}\ set\ xs\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isakeywordTWO{for}\ ee\ dd\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ ordered{\isacharunderscore}{\kern0pt}ab{\isacharunderscore}{\kern0pt}semigroup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}mono\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ \ \ \ \ \ \ trans{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cong{\isacharbrackleft}{\kern0pt}OF\ refl\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ dd{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymlbrakk}\ {\isacharparenleft}{\kern0pt}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee\ {\isacharhash}{\kern0pt}\ \ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ dd\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharsemicolon}{\kern0pt}\ ee\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharsemicolon}{\kern0pt}\ oedge\ {\isacharbackquote}{\kern0pt}\ set\ xs\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isakeywordTWO{for}\ ee\ dd\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ ordered{\isacharunderscore}{\kern0pt}ab{\isacharunderscore}{\kern0pt}semigroup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}mono\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ \ \ \ \ \ \ trans{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cong{\isacharbrackleft}{\kern0pt}OF\ refl\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ dd{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{3}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ dd\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharsemicolon}{\kern0pt}\ ee\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharsemicolon}{\kern0pt}\ oedge\ {\isacharbackquote}{\kern0pt}\ set\ xs\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}F\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{for}\ dd\ ee\isanewline
\ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ ordered{\isacharunderscore}{\kern0pt}ab{\isacharunderscore}{\kern0pt}semigroup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}mono\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ \ \ \ \ \ \ trans{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cong{\isacharbrackleft}{\kern0pt}OF\ refl\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{4}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ dd\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharsemicolon}{\kern0pt}\ \ ee\ {\isasymin}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isacharsemicolon}{\kern0pt}\ oedge\ {\isacharbackquote}{\kern0pt}\ set\ xs\ {\isasymsubseteq}\ set\ {\isasymE}{\isacharunderscore}{\kern0pt}list\ {\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee\ {\isacharhash}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ {\isacharparenleft}{\kern0pt}B\ ee{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ ee\ dd\isanewline
\ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ ordered{\isacharunderscore}{\kern0pt}ab{\isacharunderscore}{\kern0pt}semigroup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}mono\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ \ \ \ \ \ \ trans{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cong{\isacharbrackleft}{\kern0pt}OF\ refl\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ all\ {\isacartoucheopen}induction\ d\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ simp\ del{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ help{\isadigit{1}}\ help{\isadigit{2}}\ help{\isadigit{3}}\ help{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isachardoublequoteclose}\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}condE\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}ax{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond\ \ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ \ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ P\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ oedge\ {\isacharbackquote}{\kern0pt}\ set\ P\ {\isasymsubseteq}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isasymF}\ state\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ t\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ \ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}opt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}tt{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ tt{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ tt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}tt\ {\isacharequal}{\kern0pt}\ the\ tt{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ s\ bf\ tt\ Nil{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ PP\ \isakeywordTWO{where}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}tt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}tt{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ Some\ tt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Some\ tt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Some\ {\isacharparenleft}{\kern0pt}tt{\isacharcomma}{\kern0pt}\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ tt{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}def\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}tt\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isakeywordTWO{and}\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}tt\ {\isasymin}\ set\ local{\isachardot}{\kern0pt}vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ tt\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ tt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ bf\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ Some\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}t\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}ax{\isacharbrackleft}{\kern0pt}of\ b\ state{\isacharcomma}{\kern0pt}\ OF\ \ {\isacharunderscore}{\kern0pt}\ \ refl{\isacharcomma}{\kern0pt}\ of\ f\ s\ t\ P{\isacharbrackright}{\kern0pt}\ \ assms\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ elim{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gammaE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ bt{\isacharunderscore}{\kern0pt}neg{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ b\ state\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ s{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ bs{\isacharunderscore}{\kern0pt}pos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ s{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ s{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ s\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ knowledge{\isacharcolon}{\kern0pt}\ True\isanewline
\ \ \ \ {\isachardoublequoteopen}s\ {\isasymin}\ VV{\isachardoublequoteclose}\ {\isachardoublequoteopen}t\ {\isasymin}\ VV{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}underlying{\isacharunderscore}{\kern0pt}invars\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}{\isasymF}\ state{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Some\ s\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}gamma\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isasymin}VV{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ \ b{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymexists}s{\isasymin}VV{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ \ b{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymexists}t{\isasymin}VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}t\ {\isacharequal}{\kern0pt}\ tt{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}P\ {\isacharequal}{\kern0pt}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ t{\isacharunderscore}{\kern0pt}props\ t{\isacharunderscore}{\kern0pt}props\ \ a{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero\ s{\isacharunderscore}{\kern0pt}props\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}t\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}{\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge\ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ pp\ \isakeywordTWO{where}\ pp{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ pp{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ pp\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}resreach{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}augpath{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ s\ t{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ ppd\ \isakeywordTWO{where}\ ppd{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ ppd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ ppd{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ ppd{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ ppd\ {\isasymsubseteq}\ set\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ ppd{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}prop\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ \ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ pp\ s\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ Q\ \isakeywordTWO{where}\ Q{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ s\ t\ ppd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}prop\ ppd{\isacharunderscore}{\kern0pt}props\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ Q{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}set\ Q\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\ {\isachardoublequoteopen}distinct\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}augcycle{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnexists}C{\isachardot}{\kern0pt}\ augcycle\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ C{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}min{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}augcycle\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ qq\ \isakeywordTWO{where}\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ qq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}set\ qq\isanewline
\ \ \ \ \ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}\ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}qq\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}simulate{\isacharunderscore}{\kern0pt}inactives{\isacharunderscore}{\kern0pt}costs{\isacharbrackleft}{\kern0pt}OF\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ refl\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ f{\isacharunderscore}{\kern0pt}is\ refl\ refl\ refl\ refl\ refl\ refl\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}augcycle\ {\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}{\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ qq\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ qq\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ e\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymunion}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e\ {\isasymin}\ set\ es{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ es{\isacharunderscore}{\kern0pt}E{\isacharunderscore}{\kern0pt}frac\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharunderscore}{\kern0pt}subs\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}{\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ e{\isacharunderscore}{\kern0pt}in\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pp{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}where{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymor}\ oedge\ e\ {\isasymin}\ {\isasymF}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in\ \ {\isadigit{1}}\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ nb{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ oedgeE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}where\ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymcc}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ nb\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}rcap{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}strict{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}OF\ refl\ oedgeE{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ s\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ qq{\isacharparenright}{\kern0pt}\ tt{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ augpath{\isacharunderscore}{\kern0pt}def\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ prepath{\isacharunderscore}{\kern0pt}def\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ UNIV\ s\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ tt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ awalk{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}vwalk\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
{\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pp{\isacharunderscore}{\kern0pt}weight\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ bellman{\isacharunderscore}{\kern0pt}ford\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnexists}c{\isachardot}{\kern0pt}\ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ hd\ c\ {\isacharequal}{\kern0pt}\ last\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf\ assms\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ long{\isacharunderscore}{\kern0pt}enough{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}Nil\ calculation\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ hd{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ calculation{\isacharbrackright}{\kern0pt}\ last{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharbrackleft}{\kern0pt}OF\ calculation{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ tt{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ tt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ long{\isacharunderscore}{\kern0pt}enough\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellamn{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exists{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}computes{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optpath{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ s\ t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vsp{\isacharunderscore}{\kern0pt}pathI{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ long{\isacharunderscore}{\kern0pt}enough{\isacharcomma}{\kern0pt}\ of\ s\ t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vs{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ long{\isacharunderscore}{\kern0pt}enough{\isacharcomma}{\kern0pt}\ of{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ calculation\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ \ bf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ rev\ {\isacharparenleft}{\kern0pt}bellford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ s\ bf\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ t{\isacharunderscore}{\kern0pt}props\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ rev{\isacharcomma}{\kern0pt}\ OF\ bellford{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}partial{\isacharunderscore}{\kern0pt}function{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ tt{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}t\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ bf{\isacharunderscore}{\kern0pt}fw{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}Pbf{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ bf\ s\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path\ vs\isanewline
\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\ t\isanewline
\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}bellford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ s\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}computation{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optimum{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ Pbf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}fw{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ereal\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ simp\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ereal\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ {\isasymcirc}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ List{\isachardot}{\kern0pt}list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ map{\isacharunderscore}{\kern0pt}ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ map{\isacharunderscore}{\kern0pt}ext\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ PP{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ PP{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ PP{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ length{\isacharunderscore}{\kern0pt}Pbf\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharbrackleft}{\kern0pt}OF\ UNIV{\isacharunderscore}{\kern0pt}I\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}PP\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ same{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ Pbf\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ PP{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ Rcap{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ PP{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ PP{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isasymF}\ state{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}map\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ distinct{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}distinct\ Pbf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}distinct{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ distinctP{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}distinct\ PP{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ distinct{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharbrackleft}{\kern0pt}OF\ distinct{\isacharunderscore}{\kern0pt}Pbf{\isacharcomma}{\kern0pt}\ simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges\ {\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ distinct{\isacharunderscore}{\kern0pt}map\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ es{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ qq{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharprime}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}qq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ e\ {\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}in\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ rcap{\isacharunderscore}{\kern0pt}qq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ e\ {\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}rcap{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}strict{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharbrackright}{\kern0pt}\ knowledge\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}def\ awalkE{\isacharprime}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}qq\ rcap{\isacharunderscore}{\kern0pt}qq\ awalk{\isacharprime}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}len\ \ e{\isacharunderscore}{\kern0pt}es{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs\ simp\ add{\isacharcolon}{\kern0pt}\ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ \ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}EE{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharbackquote}{\kern0pt}\ EEE\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}oedge{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}{\isasymEE}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharbackquote}{\kern0pt}\ set\ PP\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ PP\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ image{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}iff\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ subsetI{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PP\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ weight{\isacharunderscore}{\kern0pt}Pbf{\isacharunderscore}{\kern0pt}snd\ t{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}weight\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ PP{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ leD\ le{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PP\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ distinct{\isacharunderscore}{\kern0pt}sum{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ distinctP{\isacharcomma}{\kern0pt}\ meson\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ distinct{\isacharunderscore}{\kern0pt}sum{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ meson\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}min\ P{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ distinctP\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}min\ distinctP\ Rcap{\isacharunderscore}{\kern0pt}P\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed\ \ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ e{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ pp\ {\isasymLongrightarrow}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ s\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ pp{\isacharparenright}{\kern0pt}\ tt{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isakeywordTWO{and}\ s{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fstv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connection{\isacharunderscore}{\kern0pt}delete\ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ induction\ pp\ \ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ x\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}simps\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ e\ d\ es{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}ends{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sndv\ e\ {\isacharequal}{\kern0pt}\ fstv\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ d{\isacharbrackright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\ {\isacharhash}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}e\ {\isacharhash}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}ends\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ d{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\ d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}d\ {\isacharhash}{\kern0pt}\ es{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ \ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto\ intro{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ e{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ UNIV{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ True\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ pp\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ pp\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}ppp\ {\isacharequal}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ pp{\isachardoublequoteclose}\ \ \ \ \ \ \isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}awalk\ UNIV\ \ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ pp\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e\ acc{\isachardot}{\kern0pt}\ {\isasymcc}\ e\ {\isacharplus}{\kern0pt}\ acc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nb\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ pp\ arbitrary{\isacharcolon}{\kern0pt}\ ppp\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{3}}{\isacharunderscore}{\kern0pt}len{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ len\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ x\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}last\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharbrackleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ ereal\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}sym{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ x\ y\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{thm}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}last\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ ppp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Awalk{\isachardot}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ {\isacharbrackright}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
ereal\isanewline
\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}prems{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ calculation{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymcc}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}y\ {\isacharhash}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardot}{\kern0pt}IH{\isachardoublequoteclose}\ calculation{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}nb\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ f\ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ nb\ f\ x\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ nb\ f\ x\ y{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \ foldr{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}rev\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ c\ rule{\isacharcolon}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ x\ y\ rest\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}isOptflow\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}underlying{\isacharunderscore}{\kern0pt}invars\ state{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ \ {\isachardoublequoteopen}{\isasymnexists}c{\isachardot}{\kern0pt}\ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ hd\ c\ {\isacharequal}{\kern0pt}\ last\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ nexistsI{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ \ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ c\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ c\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}last\ c{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}\ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\isanewline
\ \ ereal\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}c\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ cc\ \isakeywordTWO{where}\ {\isachardoublequoteopen}cc\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ cc{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}cc\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims{\isacharbrackleft}{\kern0pt}OF\ \ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackleft}{\kern0pt}simplified\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ cc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ cc{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ cc{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackleft}{\kern0pt}simplified\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharbrackleft}{\kern0pt}OF\ UNIV{\isacharunderscore}{\kern0pt}I\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ prepath{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ cc{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ agpath{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ cc{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ cc{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ cc\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}rev\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackleft}{\kern0pt}simplified\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ c{\isadigit{1}}\ c{\isadigit{2}}\ \isakeywordTWO{where}\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}c{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}c{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ rev\ c{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}rev\ c{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}rev\ c{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}rev\ c{\isadigit{2}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}\ rev\ c{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ c{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ rev{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}ident{\isacharbrackleft}{\kern0pt}of\ c{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ c{\isacharunderscore}{\kern0pt}split{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}infty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Costs{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}pinfty{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ c{\isacharunderscore}{\kern0pt}split\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invarsE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}activeE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ C\ \isakeywordTWO{where}\ {\isachardoublequoteopen}augcycle\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augcycle{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}distinct{\isacharunderscore}{\kern0pt}cycle{\isacharbrackleft}{\kern0pt}OF\ \ agpath{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}f\ c{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}empt\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}f{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \ cc{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cc{\isacharunderscore}{\kern0pt}def\ path{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ metis\ list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}comp\ same{\isacharunderscore}{\kern0pt}edges{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}min{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}augcycle\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ a\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}ax{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isacharsemicolon}{\kern0pt}\ Some\ t\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}P{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma\ state{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ underlying{\isacharunderscore}{\kern0pt}invars\ state{\isasymrbrakk}\isanewline
\ \ \ {\isasymLongrightarrow}\ s\ {\isasymin}\ VV\ {\isasymand}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isacharparenright}{\kern0pt}\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ {\isasymand}\ s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ one\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isachargreater}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t{\isachardoublequoteclose}\isanewline
\ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ \ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}opt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ ss{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ss\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ the\ ss{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ rev\ {\isacharparenleft}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ t\ bf\ ss\ Nil{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ PP\ \isakeywordTWO{where}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}ss{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ Some\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Some\ ss{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Some\ {\isacharparenleft}{\kern0pt}ss{\isacharcomma}{\kern0pt}\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ ss{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def\ ss{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}def\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isakeywordTWO{and}\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ss\ {\isasymin}\ set\ local{\isachardot}{\kern0pt}vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ ss\ {\isachargreater}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ ss{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ bf\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ Some\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}def\ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ connections\ \isakeywordTWO{where}\ {\isachardoublequoteopen}connections\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ ss{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\ s{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ s\ {\isasymin}\ set\ vs\ {\isasymand}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}props\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s\ connections{\isacharunderscore}{\kern0pt}def\ \ bf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ s{\isacharunderscore}{\kern0pt}prop\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ \ connections{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ s{\isacharunderscore}{\kern0pt}prop\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ \ rev\ {\isacharparenleft}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ connection{\isacharunderscore}{\kern0pt}lookup\ t\ connections\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnexists}c{\isachardot}{\kern0pt}\ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ hd\ c\ {\isacharequal}{\kern0pt}\ last\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ connections\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ \ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ \ t{\isacharunderscore}{\kern0pt}prop\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ connections\ t\ s{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path\ vs\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t\ s\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}bellford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ t\ connections\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop\ \ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ \ s{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ connections{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}computation{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optimum{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ Pbf{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ ereal\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ \ {\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ P\ \isakeywordTWO{where}\ {\isachardoublequoteopen}P\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ P{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ P{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackleft}{\kern0pt}simplified\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ length{\isacharunderscore}{\kern0pt}Pbf\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharbrackleft}{\kern0pt}OF\ UNIV{\isacharunderscore}{\kern0pt}I\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ same{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ Pbf\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\isanewline
\ \ \ \ \ \ \ \ \ \ P{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ P\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}to{\isacharunderscore}{\kern0pt}edge\ e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ Pbf{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ c{\isadigit{1}}\ c{\isadigit{2}}\ \isakeywordTWO{where}\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}c{\isadigit{1}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}c{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ rev\ Pbf{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}rev\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}split{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}rev\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{done}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}split{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}rev\ c{\isadigit{2}}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}\ rev\ c{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Pbf{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ rev{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}ident{\isacharbrackleft}{\kern0pt}of\ Pbf{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ c{\isacharunderscore}{\kern0pt}split{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}infty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}to{\isacharunderscore}{\kern0pt}edge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ Pbf\ {\isacharequal}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}Costs{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}pinfty{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ c{\isacharunderscore}{\kern0pt}split\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ P{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ one\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invarsE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}activeE\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}resreach\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\ \ \isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ one{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ s{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}t\ s{\isacharunderscore}{\kern0pt}prop\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs{\isacharcolon}{\kern0pt}\isanewline
\ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ qq{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ \ qq{\isacharunderscore}{\kern0pt}len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ qq\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ qq\ arbitrary{\isacharcolon}{\kern0pt}\ s\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}induct{\isadigit{2}}{\isacharunderscore}{\kern0pt}len{\isacharunderscore}{\kern0pt}geq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}len\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\ \isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ surjective{\isacharunderscore}{\kern0pt}pairing\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymE}{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ simp\ del{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymcc}{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ e\ d\ ds{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{1}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}snd\ dd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ dd\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeywordTWO{if}\ assms{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}s{\isachardot}{\kern0pt}\ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}dd\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}\ {\isachardoublequoteopen}ee\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}\ {\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ set\ ds\ {\isasymsubseteq}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordTWO{for}\ ee\ dd\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq\ \ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ snd\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ snd\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}F\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\ simp\ add{\isacharcolon}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}last{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}snd\ dd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ dd\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeywordTWO{if}\ assms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}s{\isachardot}{\kern0pt}\ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ F\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ dd{\isacharcomma}{\kern0pt}\ snd\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}dd\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}ee\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ set\ ds\ {\isasymsubseteq}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ dd\ ee\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq\ \ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ snd\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}F\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\ simp\ add{\isacharcolon}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}last{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}fst\ dd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeywordTWO{if}\ assms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}s{\isachardot}{\kern0pt}\ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}{\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ F\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}dd\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\ {\isachardoublequoteopen}ee\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}\ {\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ set\ ds\ {\isasymsubseteq}\ local{\isachardot}{\kern0pt}{\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ ee\ dd\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ forw{\isacharunderscore}{\kern0pt}subst{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ snd\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}last{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteopen}snd\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ snd\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}B\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ help{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}fst\ dd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ dd{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ ee\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{if}\ assms{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}s{\isachardot}{\kern0pt}\ unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ ds{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}fst\ ee{\isacharcomma}{\kern0pt}\ snd\ ee{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymc}\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ B\ dd\ {\isasymor}\ e\ {\isacharequal}{\kern0pt}\ B\ ee\ {\isasymor}\ e\ {\isasymin}\ set\ ds\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}\ {\isacharhash}{\kern0pt}\ map\ to{\isacharunderscore}{\kern0pt}edge\ ds{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}dd\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}{\isachardoublequoteopen}ee\ {\isasymin}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}\ \ {\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ set\ ds\ {\isasymsubseteq}\ local{\isachardot}{\kern0pt}{\isasymE}\ {\isachardoublequoteclose}\ \isakeywordTWO{for}\ dd\ ee\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ forw{\isacharunderscore}{\kern0pt}subst{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ dd{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isasymc}\ ee\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ds\ {\isadigit{0}}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}snd\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ dd{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ dd{\isacharcomma}{\kern0pt}\ fst\ dd{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ ee{\isacharcomma}{\kern0pt}\ fst\ ee{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}last{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteopen}fst\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}hd{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}homo{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refl{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}B\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ all\ {\isacartoucheopen}induction\ d\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isachardot}{\kern0pt}induct{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ rev{\isacharunderscore}{\kern0pt}map\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sym{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}costs{\isacharunderscore}{\kern0pt}last{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Instantiation{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharcolon}{\kern0pt}\ help{\isadigit{1}}\ help{\isadigit{2}}\ help{\isadigit{3}}\ help{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ Forest{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}erev{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}consist\ forst\ conv{\isachardoublequoteclose}\ {\isachardoublequoteopen}symmetric{\isacharunderscore}{\kern0pt}digraph\ forst{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ forst\ {\isasymLongrightarrow}\ prod{\isachardot}{\kern0pt}fst\ e\ {\isasymnoteq}\ prod{\isachardot}{\kern0pt}snd\ e{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordTWO{shows}\ \ {\isachardoublequoteopen}e\ {\isasymin}\ conv\ {\isacharbackquote}{\kern0pt}\ forst\ {\isasymlongleftrightarrow}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ e\ {\isasymin}\ conv\ {\isacharbackquote}{\kern0pt}\ forst{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}consistE{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule\ symmetric{\isacharunderscore}{\kern0pt}digraphE{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ all\ {\isacartoucheopen}cases\ e{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee\ {\isasymin}\ forst{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isasymin}\ forst{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ B\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ ee{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ a\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Redge{\isachardot}{\kern0pt}distinct{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Redge{\isachardot}{\kern0pt}inject{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ imageE\ \isanewline
\ \ \ \ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap{\isacharunderscore}{\kern0pt}def\ surjective{\isacharunderscore}{\kern0pt}pairing{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ b\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isasymin}\ forst{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee\ {\isasymin}\ forst{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ F\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ ee{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ a\ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}fstv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}sndv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \ \ \ \ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}fstv\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}sndv\ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ surjective{\isacharunderscore}{\kern0pt}pairing{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ b\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ B\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}fst\ ee{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ ee{\isachardoublequoteclose}\ ee{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}fstv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}sndv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}fstv\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}sndv\isanewline
\ \ \ \ \ \ \ \ local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap{\isacharunderscore}{\kern0pt}def\ surjective{\isacharunderscore}{\kern0pt}pairing{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isasymin}\ forst{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}make{\isacharunderscore}{\kern0pt}pair\ ee\ {\isasymin}\ forst{\isachardoublequoteclose}\isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ F\ ee{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ c\ calculation\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ calculation\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ ee{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{hence}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ F\ ee{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}fstv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}sndv{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}fstv\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}consist{\isacharunderscore}{\kern0pt}sndv\isanewline
\ \ \ \ \ \ make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd\ surjective{\isacharunderscore}{\kern0pt}pairing{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isasymin}\ forst{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}\ {\isasymin}\ forst{\isachardoublequoteclose}\isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}conv\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ ee{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\ ee{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharprime}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ b\ c\ calculation\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{4}}{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ calculation\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond\ {\isachardoublequoteclose}\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}condE\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}condE\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}ax{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond\ \ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ P\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ oedge\ {\isacharbackquote}{\kern0pt}\ set\ P\ {\isasymsubseteq}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isasymF}\ state\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ s\ {\isasymin}\ {\isasymV}\ {\isasymand}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ \ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}opt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ v{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}balance\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ ss{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ss\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ the\ ss{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Pbf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ rev\ {\isacharparenleft}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exec\ t\ bf\ ss\ Nil{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ PP\ \isakeywordTWO{where}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}ss{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}ss{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ Some\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Some\ ss{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Some\ {\isacharparenleft}{\kern0pt}ss{\isacharcomma}{\kern0pt}\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ ss{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ option{\isacharunderscore}{\kern0pt}none{\isacharunderscore}{\kern0pt}simp{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def\ ss{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}def\ pair{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}redge{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isakeywordTWO{and}\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}PP\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ss\ {\isasymin}\ set\ local{\isachardot}{\kern0pt}vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ ss\ {\isachargreater}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ ss{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ bf\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ Some\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}def\ ss{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}s\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\ \isakeywordTWO{and}\ gamma{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}ax{\isacharbrackleft}{\kern0pt}of\ b\ state{\isacharcomma}{\kern0pt}\ OF\ \ {\isacharunderscore}{\kern0pt}\ \ refl{\isacharcomma}{\kern0pt}\ of\ f\ t\ s\ P{\isacharbrackright}{\kern0pt}\ \ assms\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are\ elim{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gammaE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ bs{\isacharunderscore}{\kern0pt}neg{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{2}}\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t\ {\isasymin}\ {\isasymV}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isachargreater}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}red{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ b\ state\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ t{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ bt{\isacharunderscore}{\kern0pt}pos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ gamma{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ t{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}balance\ state\ t\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ knowledge{\isacharcolon}{\kern0pt}\ True\isanewline
\ \ \ \ {\isachardoublequoteopen}s\ {\isasymin}\ VV{\isachardoublequoteclose}\ {\isachardoublequoteopen}t\ {\isasymin}\ VV{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}underlying{\isacharunderscore}{\kern0pt}invars\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}{\isasymF}\ state{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Some\ t\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}invar{\isacharunderscore}{\kern0pt}gamma\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isasymin}VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymexists}t{\isasymin}VV{\isachardot}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isachargreater}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymexists}s{\isasymin}VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ ss{\isachardoublequoteclose}\ \ {\isachardoublequoteopen}P\ {\isacharequal}{\kern0pt}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ t{\isacharunderscore}{\kern0pt}props\ t{\isacharunderscore}{\kern0pt}props\ \ a{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero\ s{\isacharunderscore}{\kern0pt}props\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ ss{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}e{\isasymin}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}ax{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{8}}{\isacharcomma}{\kern0pt}{\isadigit{9}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ s{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ pp\ \isakeywordTWO{where}\ pp{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ pp{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ pp\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}resreach{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}augpath{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ s\ t{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ ppd\ \isakeywordTWO{where}\ ppd{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ ppd{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ ppd{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ ppd{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ ppd\ {\isasymsubseteq}\ set\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ ppd{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}prop\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ \ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ pp\ s\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ Q\ \isakeywordTWO{where}\ Q{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ s\ t\ ppd{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}prop\ ppd{\isacharunderscore}{\kern0pt}props\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ Q{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}set\ Q\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\ {\isachardoublequoteopen}distinct\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}augcycle{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnexists}C{\isachardot}{\kern0pt}\ augcycle\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ C{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ assms\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}min{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}augcycle\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}isOptflow{\isacharunderscore}{\kern0pt}def\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ qq\ \isakeywordTWO{where}\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ qq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}set\ qq\isanewline
\ \ \ \ \ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}\ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}qq\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}simulate{\isacharunderscore}{\kern0pt}inactives{\isacharunderscore}{\kern0pt}costs{\isacharbrackleft}{\kern0pt}OF\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ refl\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ f{\isacharunderscore}{\kern0pt}is\ refl\ refl\ refl\ refl\ refl\ refl\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}augcycle\ {\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}{\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}len{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ qq\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}qq\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}\ all\ {\isacartoucheopen}cases\ qq\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ symmetric{\isacharunderscore}{\kern0pt}digraph{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}symmetric{\isacharunderscore}{\kern0pt}digraph\ {\isacharparenleft}{\kern0pt}Instantiation{\isachardot}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ forest{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}loop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ Instantiation{\isachardot}{\kern0pt}Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}fst\ e\ {\isasymnoteq}\ prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}validFE\ \isanewline
\ \ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ dblton{\isacharunderscore}{\kern0pt}graph{\isacharunderscore}{\kern0pt}def\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}graph{\isacharunderscore}{\kern0pt}def\ UD{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ blast\ \ \ \ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ consist{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}consist\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pre{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ e\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymunion}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ e\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymunion}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pre{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Residuals{\isacharunderscore}{\kern0pt}project{\isacharunderscore}{\kern0pt}erev{\isacharunderscore}{\kern0pt}sym{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ Forest{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}erev{\isacharbrackleft}{\kern0pt}OF\ consist\ symmetric{\isacharunderscore}{\kern0pt}digraph\ forest{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}loop{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev{\isacharunderscore}{\kern0pt}{\isasymEE}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}oedge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}reversed\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pp{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isadigit{1}}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ e\ {\isasymin}\ set\ \ qq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erve{\isacharunderscore}{\kern0pt}erve{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}OF\ \ {\isacharbrackright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}rev\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ oedgeF{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymor}\ oedge\ e\ {\isasymin}\ {\isasymF}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in\ \ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ oedgeE{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ oedgeF\ \ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ flowpos{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymexists}\ d{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ e{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\ d{\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state\ {\isacharparenleft}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}rcap{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}strict{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ rule{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}cases{\isacharbrackleft}{\kern0pt}OF\ \ {\isacharcomma}{\kern0pt}\ of\ e{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ auto\ \ \isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isadigit{1}}{\isachardoublequoteclose}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}rcap{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}strict\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}oedge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}reversed\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}erev\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ refl\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}erev\ e{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ss{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}UNIV{\isacharunderscore}{\kern0pt}rev{\isacharbrackleft}{\kern0pt}of\ ss\ {\isachardoublequoteopen}map\ to{\isacharunderscore}{\kern0pt}edge\ qq{\isachardoublequoteclose}\ t{\isacharcomma}{\kern0pt}\ simplified\ rev{\isacharunderscore}{\kern0pt}map{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}erev{\isacharunderscore}{\kern0pt}swap\ prepath{\isacharunderscore}{\kern0pt}def\ \ augpath{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ vwalk{\isacharunderscore}{\kern0pt}bettt{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}vwalk{\isacharunderscore}{\kern0pt}bet\ UNIV\ t\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ss{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ awalk{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}vwalk\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pp{\isacharunderscore}{\kern0pt}weight\ \ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rev{\isacharunderscore}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}lst{\isacharbrackleft}{\kern0pt}OF\ \ qq{\isacharunderscore}{\kern0pt}len{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnexists}c{\isachardot}{\kern0pt}\ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ c\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ hd\ c\ {\isacharequal}{\kern0pt}\ last\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward\ assms\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ long{\isacharunderscore}{\kern0pt}enough{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}verts{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}Nil\ calculation\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ hd{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ calculation{\isacharbrackright}{\kern0pt}\ last{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}bet{\isacharbrackleft}{\kern0pt}OF\ calculation{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ ss{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ ss{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ vwalk{\isacharunderscore}{\kern0pt}bettt\ \ long{\isacharunderscore}{\kern0pt}enough\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellamn{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}exists{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}weight{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ ss{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\isanewline
\ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}computes{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optpath{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ t\ s{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ s{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vsp{\isacharunderscore}{\kern0pt}pathI{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ long{\isacharunderscore}{\kern0pt}enough{\isacharcomma}{\kern0pt}\ of\ t\ s{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}vs{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ long{\isacharunderscore}{\kern0pt}enough{\isacharcomma}{\kern0pt}\ of{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ calculation\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ vwalk{\isacharunderscore}{\kern0pt}bet{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ \ bf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Pbf\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}bellford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ \ t\ bf\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s\isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ rev{\isacharcomma}{\kern0pt}\ OF\ bellford{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}partial{\isacharunderscore}{\kern0pt}function{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ bf{\isacharunderscore}{\kern0pt}bw{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}Pbf{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ \ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}weight{\isacharbrackleft}{\kern0pt}OF\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharcomma}{\kern0pt}\ of\ bf\ t\ s{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path\ vs\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t\ s\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}bellford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path\ t\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeywordONE{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop\ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}computation{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}optimum{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ Pbf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ \ Pbf{\isacharparenright}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}last\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ Pbf{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ ereal\ \ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ \ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ e{\isachardot}{\kern0pt}\ e{\isasymin}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ \ Pbf{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}swap{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}rev\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf{\isacharbrackleft}{\kern0pt}simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ length{\isacharunderscore}{\kern0pt}rev{\isacharbrackleft}{\kern0pt}of\ Pbf{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharcomma}{\kern0pt}\ simplified\ last{\isacharunderscore}{\kern0pt}rev\ hd{\isacharunderscore}{\kern0pt}rev{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ PP{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ sym{\isacharbrackleft}{\kern0pt}OF\ List{\isachardot}{\kern0pt}list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ Pbf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ map{\isacharunderscore}{\kern0pt}map{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}props{\isacharbrackleft}{\kern0pt}OF\ prod{\isachardot}{\kern0pt}collapse{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ PP{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ PP{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ PP{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}elims\ {\isacharbrackleft}{\kern0pt}OF\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ length{\isacharunderscore}{\kern0pt}Pbf\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isachardot}{\kern0pt}simps{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ \isakeywordONE{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ calculation\ \ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ same{\isacharunderscore}{\kern0pt}edges\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ awalk{\isacharunderscore}{\kern0pt}intros{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arc{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}awalk{\isacharbrackleft}{\kern0pt}OF\ UNIV{\isacharunderscore}{\kern0pt}I\ refl{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}metis\ awalk{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}last\ last{\isacharunderscore}{\kern0pt}ConsR\ last{\isacharunderscore}{\kern0pt}map\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}PP\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}Pbf\ same{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ Pbf\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath\ PP{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ Rcap{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ PP{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def\ hd{\isacharunderscore}{\kern0pt}rev\ last{\isacharunderscore}{\kern0pt}rev{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ PP{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk{\isacharunderscore}{\kern0pt}f\ same{\isacharunderscore}{\kern0pt}edges\ Pbf{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}path\ \ awalk{\isacharunderscore}{\kern0pt}ends{\isacharbrackleft}{\kern0pt}OF\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}opt{\isacharunderscore}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ Pbf{\isacharunderscore}{\kern0pt}def\ hd{\isacharunderscore}{\kern0pt}rev\ last{\isacharunderscore}{\kern0pt}rev{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}oedge\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ PP{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isasymF}\ state{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ rule\ ccontr{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ same{\isacharunderscore}{\kern0pt}edges\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ PP{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}map\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ state{\isacharcomma}{\kern0pt}\ OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ distinct{\isacharunderscore}{\kern0pt}Pbf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}distinct\ Pbf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bf\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ pred{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}None\ \isanewline
\ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}search{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}distinct{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ Pbf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ distinctP{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}distinct\ PP{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ distinct{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk{\isacharbrackleft}{\kern0pt}OF\ distinct{\isacharunderscore}{\kern0pt}Pbf{\isacharcomma}{\kern0pt}\ simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ same{\isacharunderscore}{\kern0pt}edges\ {\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ distinct{\isacharunderscore}{\kern0pt}map\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}es\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}\ map\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ qq{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ es{\isacharunderscore}{\kern0pt}sym\ image{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}iff\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}oedge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}reversed{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}qq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ e\ {\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ rcap{\isacharunderscore}{\kern0pt}qq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ e\ {\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}rcap{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}strict{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharbrackright}{\kern0pt}\ knowledge\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}unconstrained{\isacharunderscore}{\kern0pt}awalk\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ qq{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ unconstrained{\isacharunderscore}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}def\ \ is{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}walk\ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ qq{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ qq\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}rev{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}qq\ rcap{\isacharunderscore}{\kern0pt}qq\ awalk{\isacharprime}{\kern0pt}\ qq{\isacharunderscore}{\kern0pt}len\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs{\isacharbrackleft}{\kern0pt}simplified\isanewline
\ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rev{\isacharunderscore}{\kern0pt}erev{\isacharunderscore}{\kern0pt}swap\ {\isacharcomma}{\kern0pt}\ simplified\ rev{\isacharunderscore}{\kern0pt}map{\isacharcomma}{\kern0pt}\ of\ qq\ {\isacharunderscore}{\kern0pt}\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}EE{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharbackquote}{\kern0pt}\ EEE\ {\isacharequal}{\kern0pt}\ {\isasymE}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}oedge{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}{\isasymEE}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ {\isacharbackquote}{\kern0pt}\ set\ PP\ {\isasymsubseteq}\ {\isasymE}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ PP\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ image{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}iff\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ subsetI{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PP\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ weight{\isacharunderscore}{\kern0pt}Pbf{\isacharunderscore}{\kern0pt}snd\ s{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}weight\ Pbf{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}simplified\ sym{\isacharbrackleft}{\kern0pt}OF\ PP{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ qq{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}weight{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}res{\isacharunderscore}{\kern0pt}costs\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ leD\ le{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ PP\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ distinct{\isacharunderscore}{\kern0pt}sum{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ distinctP{\isacharcomma}{\kern0pt}\ meson\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcc}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Q\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}{\isasymCC}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ distinct{\isacharunderscore}{\kern0pt}sum{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ meson\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ P{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t\ PP{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}min\ P{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ distinctP\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ PP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}P\ P{\isacharunderscore}{\kern0pt}min\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ oedge{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}allowed\ s{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}nexistence{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}s{\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ b\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}nexistence{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}s{\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isachargreater}{\kern0pt}\ b\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ b\ {\isasymgamma}\ xs\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}\ {\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ underlying{\isacharunderscore}{\kern0pt}invars\ state{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ e\ {\isasymin}\ {\isasymF}\ state\ {\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ Some\ s\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source\ state{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma\ state{\isasymrbrakk}\isanewline
\ \ \ \ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ t\ {\isasymin}\ VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlongleftrightarrow}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ knowledge\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ tt\ \isakeywordTWO{where}\ {\isachardoublequoteopen}\ tt\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}balance\ state\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vs{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ e\ {\isasymLongrightarrow}\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invarsE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}activeE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE{\isacharparenright}{\kern0pt}\isanewline
\ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymin}\ VV{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ s\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ bs{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}SIG{\isacharparenright}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}pos\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ t\ {\isasymin}\ VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}tt\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ \ all\ {\isacartoucheopen}rule\ ccontr{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ t\ \isakeywordTWO{where}\ {\isachardoublequoteopen}tt\ {\isacharequal}{\kern0pt}\ Some\ t{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ this\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}x{\isasymin}set\ vs{\isachardot}{\kern0pt}\isanewline
\ \ \ \ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isasymand}\isanewline
\ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ tt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ blast\ \isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ x\ \isakeywordTWO{where}\ x{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ set\ vs{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ bx{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ \ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymnoteq}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bs{\isadigit{0}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x{\isasymin}dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}prop\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ s{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p\ \isakeywordTWO{where}\ p{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}last\ p\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}hd\ p\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymle}\ length\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ Set{\isachardot}{\kern0pt}insert\ s\ {\isacharparenleft}{\kern0pt}set\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ x{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ pw{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ pp\ \isakeywordTWO{where}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ transformed{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}last\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e{\isasymin}set\ pp\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ pw{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop\ pp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}hd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}hd\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ \ pp{\isacharunderscore}{\kern0pt}def\ {\isacharcomma}{\kern0pt}\ subst\ hd{\isacharunderscore}{\kern0pt}map{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}insert\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ cases\ p\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}insert\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ cases\ p\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}last{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}last\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sndv\ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ \ pp{\isacharunderscore}{\kern0pt}def\ {\isacharcomma}{\kern0pt}\ subst\ last{\isacharunderscore}{\kern0pt}map{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{subgoal}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}insert\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ cases\ p\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ sym{\isacharbrackleft}{\kern0pt}OF\ last{\isacharunderscore}{\kern0pt}v{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}last{\isacharunderscore}{\kern0pt}e{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ o{\isacharunderscore}{\kern0pt}def\ pp{\isacharunderscore}{\kern0pt}def\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ prepath{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prepath\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}hd\ path{\isacharunderscore}{\kern0pt}last\ same{\isacharunderscore}{\kern0pt}edges\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}Min{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}iff\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ e\ {\isasymin}\ set\ pp\ {\isasymLongrightarrow}\ e\ {\isasymin}\ EEE{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}resreach\ path{\isacharunderscore}{\kern0pt}hd\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}last\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ x{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ t\ \isakeywordTWO{where}\ {\isachardoublequoteopen}t{\isasymin}local{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}{\isasymV}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isachardoublequoteclose}\ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ this\ {\isadigit{2}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ \ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}t\ {\isasymnoteq}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bs{\isadigit{0}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ q\ \isakeywordTWO{where}\ q{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ q{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ q\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}resreach{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}augpath{\isacharbrackleft}{\kern0pt}OF\ \ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ qq\ \isakeywordTWO{where}\ qq{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ qq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}set\ qq\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymunion}\ abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}qq\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}simulate{\isacharunderscore}{\kern0pt}inactives{\isacharbrackleft}{\kern0pt}OF\ q{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ refl\ f{\isacharunderscore}{\kern0pt}is\ refl\ refl\ refl\ refl\ refl\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ spec{\isacharbrackleft}{\kern0pt}OF\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image{\isacharunderscore}{\kern0pt}iff\ {\isasymF}{\isacharunderscore}{\kern0pt}def\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}mp{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}rcap{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ e{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ linorder{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}Min{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}iff\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ augpath{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ Q\ \isakeywordTWO{where}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ Q{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ Q\ {\isasymsubseteq}\ set\ qq{\isachardoublequoteclose}\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ OF\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ Q\ {\isasymLongrightarrow}\ oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ costsQ{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ Q\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ refl\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ e\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}E\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}rcap\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ costsQ\ \ awalk\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf{\isacharbrackleft}{\kern0pt}of\ Q\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ s{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}last\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}OPT\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ s\ t\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}OPTle{\isacharunderscore}{\kern0pt}PInfty{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}tl\ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ cases\ {\isachardoublequoteopen}awalk{\isacharunderscore}{\kern0pt}verts\ s\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isacharunderscore}{\kern0pt}both{\isacharunderscore}{\kern0pt}sides{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}OPT\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}forward\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}shortest{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ s\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ t{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ s{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}forward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}t\ {\isasymin}\ set\ vs{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}tt\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ bf{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ tt{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isachardoublequoteclose}\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE{\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ \ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond\ state\ s\ b\ {\isasymgamma}\ f\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}t{\isasymin}VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ state\ s\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ refl\ refl\ refl{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}\ {\isasymlbrakk}b\ {\isacharequal}{\kern0pt}\ balance\ state{\isacharsemicolon}{\kern0pt}\ {\isasymgamma}\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharsemicolon}{\kern0pt}\ f\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ state{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ underlying{\isacharunderscore}{\kern0pt}invars\ state{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ e\ {\isasymin}\ {\isasymF}\ state\ {\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ e\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ Some\ t\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target\ state{\isacharsemicolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}gamma\ state{\isasymrbrakk}\isanewline
\ \ \ \ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ s\ {\isasymin}\ VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isasymlongleftrightarrow}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{note}\isamarkupfalse%
\ knowledge\ {\isacharequal}{\kern0pt}\ this\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ bf\ \isakeywordTWO{where}\ {\isachardoublequoteopen}bf\ {\isacharequal}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{define}\isamarkupfalse%
\ ss\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux\ bf\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}balance\ state\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vs{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ e\ {\isasymLongrightarrow}\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ algo{\isachardot}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invarsE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}unbl{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}activeE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}actives{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE\ algo{\isachardot}{\kern0pt}inv{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}EE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bellman{\isacharunderscore}{\kern0pt}ford\ connection{\isacharunderscore}{\kern0pt}empty\ connection{\isacharunderscore}{\kern0pt}lookup\ connection{\isacharunderscore}{\kern0pt}invar\ connection{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ es\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ connection{\isacharunderscore}{\kern0pt}update{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isachargreater}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}t\ {\isasymin}\ VV{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ t\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ vs{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{hence}\isamarkupfalse%
\ bt{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ t\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}pos\ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ s\ {\isasymin}\ VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}ss\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule{\isacharcomma}{\kern0pt}\ \ all\ {\isacartoucheopen}rule\ ccontr{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ s\ \isakeywordTWO{where}\ {\isachardoublequoteopen}ss\ {\isacharequal}{\kern0pt}\ Some\ s{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ this\ {\isadigit{1}}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}x{\isasymin}set\ vs{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ ss{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ blast\ \isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ x\ \isakeywordTWO{where}\ x{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ set\ vs{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ bx{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ x\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ \ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymnoteq}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bt{\isadigit{0}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x{\isasymin}dom\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}prop\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}same{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}is{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}infty{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p\ \isakeywordTWO{where}\ p{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}last\ p\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}hd\ p\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymle}\ length\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ Set{\isachardot}{\kern0pt}insert\ t\ {\isacharparenleft}{\kern0pt}set\ vs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}pres{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ x{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}dom\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}pred{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharbrackright}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ pw{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}prop\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ pp\ \isakeywordTWO{where}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}snd\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}fst\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ transformed{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}last\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e{\isasymin}set\ pp\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ pw{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty\ refl{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop\ pp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ non{\isacharunderscore}{\kern0pt}empt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}insert\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ cases\ p\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharsemicolon}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}hd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}last\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fstv\ {\isacharparenleft}{\kern0pt}hd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ last{\isacharunderscore}{\kern0pt}v{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}last{\isacharunderscore}{\kern0pt}e{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}p{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}def\ last{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empt{\isacharbrackright}{\kern0pt}\ \ hd{\isacharunderscore}{\kern0pt}rev\ hd{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empt{\isacharbrackright}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ path{\isacharunderscore}{\kern0pt}last{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}hd\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sndv\ {\isacharparenleft}{\kern0pt}last\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ hd{\isacharunderscore}{\kern0pt}v{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}hd{\isacharunderscore}{\kern0pt}e{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}p{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}def\ last{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empt{\isacharbrackright}{\kern0pt}\ \ last{\isacharunderscore}{\kern0pt}rev\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}pres\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}edges{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}map\ prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}edges{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}vwalk\ {\isacharparenleft}{\kern0pt}p\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}def\ o{\isacharunderscore}{\kern0pt}def\ to{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ prepath{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prepath\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}hd\ path{\isacharunderscore}{\kern0pt}last\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ \ same{\isacharunderscore}{\kern0pt}edges\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}Min{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}iff\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}augpath\ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ pp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ e\ {\isasymin}\ set\ pp\ {\isasymLongrightarrow}\ e\ {\isasymin}\ EEE{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ transformed{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ e{\isacharbrackright}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}o{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}res\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}resreach\ \ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ x\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}resreach{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ of\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ pp{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ path{\isacharunderscore}{\kern0pt}hd\ p{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ path{\isacharunderscore}{\kern0pt}last\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ hd{\isacharunderscore}{\kern0pt}append{\isadigit{2}}\ last{\isacharunderscore}{\kern0pt}snoc\ le{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}extra{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}size{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ x{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ s\ \isakeywordTWO{where}\ {\isachardoublequoteopen}s{\isasymin}multigraph{\isachardot}{\kern0pt}{\isasymV}\ {\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{note}\isamarkupfalse%
\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ this\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}axiom\ algo{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}gamma{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ \ mult{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}left\ mult{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}t\ {\isasymnoteq}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bt{\isadigit{0}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f\ {\isacharequal}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ q\ \isakeywordTWO{where}\ q{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ q{\isachardoublequoteclose}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ q\ {\isasymsubseteq}\ EEE{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}resreach{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}augpath{\isacharbrackleft}{\kern0pt}OF\ \ {\isadigit{2}}{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ qq\ \isakeywordTWO{where}\ qq{\isacharunderscore}{\kern0pt}props{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ qq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ qq{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}set\ qq\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}e\ {\isacharbar}{\kern0pt}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ EEE\ {\isasymand}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e\ {\isasymin}\ to{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}actives\ state{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymunion}\ abstract{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}conv{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rdg\ state{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}digraph{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}{\isasymFF}\ state{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ {\isachardoublequoteopen}qq\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ algo{\isachardot}{\kern0pt}simulate{\isacharunderscore}{\kern0pt}inactives{\isacharbrackleft}{\kern0pt}OF\ q{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ refl\ f{\isacharunderscore}{\kern0pt}is\ refl\ refl\ refl\ refl\ refl\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymF}{\isacharunderscore}{\kern0pt}redges{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\ \ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ spec{\isacharbrackleft}{\kern0pt}OF\ algo{\isachardot}{\kern0pt}from{\isacharunderscore}{\kern0pt}underlying{\isacharunderscore}{\kern0pt}invars{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}oedge{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image{\isacharunderscore}{\kern0pt}iff\ {\isasymF}{\isacharunderscore}{\kern0pt}def\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}mp{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}rcap{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ qq\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}rcap\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ e{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ linorder{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}Min{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}iff\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ augpath{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{obtain}\isamarkupfalse%
\ Q\ \isakeywordTWO{where}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ Q{\isachardoublequoteclose}\ {\isachardoublequoteopen}set\ Q\ {\isasymsubseteq}\ set\ qq{\isachardoublequoteclose}\ {\isachardoublequoteopen}augpath\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}there{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}s{\isacharunderscore}{\kern0pt}t{\isacharunderscore}{\kern0pt}path{\isacharbrackleft}{\kern0pt}OF\ {\isacharcomma}{\kern0pt}\ OF\ qq{\isacharunderscore}{\kern0pt}props{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ refl{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordTHREE{define}\isamarkupfalse%
\ Q{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ {\isachardoublequoteopen}Q{\isacharprime}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ {\isacharparenleft}{\kern0pt}rev\ Q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isachardoublequoteopen}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}distinct\ Q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hd{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}rev\ Q{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ hd{\isacharunderscore}{\kern0pt}rev\ last{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}rev\ Q{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ last{\isacharunderscore}{\kern0pt}rev\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}vs{\isacharunderscore}{\kern0pt}erev\ distinct{\isacharunderscore}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}inj{\isacharunderscore}{\kern0pt}erev\ o{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}E{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ Q\ {\isasymLongrightarrow}\ oedge\ e\ {\isasymin}\ {\isasymE}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\ \isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}E\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ costsQ{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ Q\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ conjunct{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}makes{\isacharunderscore}{\kern0pt}cheaper{\isacharbrackleft}{\kern0pt}OF\ refl\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ of\ e\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}E\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ \ e{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}qq{\isacharunderscore}{\kern0pt}rcap\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isakeywordONE{have}\isamarkupfalse%
\ costsQ{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymin}\ set\ Q{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordTWO{for}\ e\isanewline
\ \ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ helper{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}e{\isachardot}{\kern0pt}\ e\ {\isasymin}\ set\ Q\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}sndv\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}fstv\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ x\ {\isasymin}\ set\ Q\ {\isacharsemicolon}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ x{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\ e\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ e\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev{\isachardot}{\kern0pt}induct{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ all\ {\isacartoucheopen}induction\ x\ rule{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}erev{\isachardot}{\kern0pt}induct{\isacartoucheclose}{\isacharparenright}{\kern0pt}\ fastforce{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ costsQ\isanewline
\ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ intro{\isacharcolon}{\kern0pt}\ helper{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ awalk{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}awalk\ UNIV\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ helper{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}\ s\ {\isacharequal}{\kern0pt}\ fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ \ Q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}Rcap\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ Q{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ t\ {\isacharequal}{\kern0pt}\ sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ to{\isacharunderscore}{\kern0pt}edge\ Q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ awalk\ UNIV\ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}sndv\ {\isacharparenleft}{\kern0pt}last\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ to{\isacharunderscore}{\kern0pt}edge{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}fstv\ {\isacharparenleft}{\kern0pt}hd\ Q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}comp{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ sym{\isacharbrackleft}{\kern0pt}OF\ rev{\isacharunderscore}{\kern0pt}map{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \ intro{\isacharcolon}{\kern0pt}\ awalk{\isacharunderscore}{\kern0pt}UNIV{\isacharunderscore}{\kern0pt}rev{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ \ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Q{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}erev{\isacharunderscore}{\kern0pt}swap\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}augpath{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}prepath{\isacharunderscore}{\kern0pt}def\ Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ intro{\isacharcolon}{\kern0pt}\ helper{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}weight{\isacharunderscore}{\kern0pt}backward\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ costsQ{\isacharprime}{\kern0pt}\ \ awalk\ Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bellman{\isacharunderscore}{\kern0pt}ford\ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ path{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}bf{\isacharunderscore}{\kern0pt}backward{\isacharbrackleft}{\kern0pt}of\ Q{\isacharprime}{\kern0pt}\ {\isachardoublequoteopen}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isachardoublequoteclose}\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}hd\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}last\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ awalk\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}OPT\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ t\ s\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}s\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}weight{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}PInfty{\isacharunderscore}{\kern0pt}OPTle{\isacharunderscore}{\kern0pt}PInfty{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ refl{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}tl\ {\isacharparenleft}{\kern0pt}butlast\ {\isacharparenleft}{\kern0pt}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ cases\ {\isachardoublequoteopen}awalk{\isacharunderscore}{\kern0pt}verts\ t\ {\isacharparenleft}{\kern0pt}map\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}vertex{\isacharunderscore}{\kern0pt}pair\ Q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ rule{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}cases{\isacharunderscore}{\kern0pt}both{\isacharunderscore}{\kern0pt}sides{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}OPT\ vs\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u\ v{\isachardot}{\kern0pt}\ prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}edge{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}costs{\isacharunderscore}{\kern0pt}backward\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\ state{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharunderscore}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\ state{\isacharparenright}{\kern0pt}\ u\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}length\ vs\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ t\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ bellman{\isacharunderscore}{\kern0pt}ford{\isachardot}{\kern0pt}bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}shortest{\isacharbrackleft}{\kern0pt}OF\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharcomma}{\kern0pt}\ of\ t\ {\isachardoublequoteopen}length\ vs\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ s{\isacharbrackright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ t{\isacharunderscore}{\kern0pt}prop{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ bf{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}backward{\isacharunderscore}{\kern0pt}def\ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ bellman{\isacharunderscore}{\kern0pt}ford{\isacharunderscore}{\kern0pt}init{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isasymin}\ set\ vs{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isachargreater}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}connection{\isacharunderscore}{\kern0pt}lookup\ bf\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ PInfty{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}ss\ {\isasymnoteq}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}for{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}aux{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ vs\ {\isachardoublequoteopen}current{\isacharunderscore}{\kern0pt}{\isasymgamma}\ state{\isachardoublequoteclose}\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bf{\isacharbrackright}{\kern0pt}\ knowledge{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ss{\isacharunderscore}{\kern0pt}def\ bf{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algo{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ option{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond\ {\isasymequiv}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isachardoublequoteclose}\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE{\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}cond\ state\ t\ b\ {\isasymgamma}\ f{\isasymLongrightarrow}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isasymexists}s{\isasymin}VV{\isachardot}{\kern0pt}\ {\isasymepsilon}\ {\isacharasterisk}{\kern0pt}\ {\isasymgamma}\ {\isacharless}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ s\ {\isasymand}\ resreach\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ f{\isacharparenright}{\kern0pt}\ s\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ state\ t\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ refl\ refl\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}condE{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux\ b\ xs\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ x\ {\isasymin}\ set\ xs{\isachardot}{\kern0pt}\ b\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ b\ xs\ rule{\isacharcolon}{\kern0pt}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ balance\ state\ \isanewline
\ \ \ {\isasymLongrightarrow}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ state\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isasymin}VV{\isachardot}{\kern0pt}\ abstract{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}map\ b\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}def\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}aux{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}axioms\ snd\ {\isasymu}\ {\isasymE}\ {\isasymc}\ {\isasymemptyset}\isactrlsub N\ vset{\isacharunderscore}{\kern0pt}inv\ isin\ set{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \ \ \ to{\isacharunderscore}{\kern0pt}set\ lookup\ t{\isacharunderscore}{\kern0pt}set\ adj{\isacharunderscore}{\kern0pt}inv\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isasymb}\ {\isasymepsilon}\ fst\isanewline
\ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ get{\isacharunderscore}{\kern0pt}source\ get{\isacharunderscore}{\kern0pt}target\isanewline
\ \ \ \ \ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{5}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}\ state\ s\ t\ P\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}ax\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{7}}\ s\ state\ b\ {\isasymgamma}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{8}}\ state\ b\ {\isasymgamma}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}axioms\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ t\ state\ b\ {\isasymgamma}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}\ state\ b\ {\isasymgamma}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}axioms\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}\ state\ s\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}None\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{2}}\ state\ t\ b\ {\isasymgamma}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ impl{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}None\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{3}}\ state\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ send{\isacharunderscore}{\kern0pt}flow{\isacharcolon}{\kern0pt}\ \isanewline
\ send{\isacharunderscore}{\kern0pt}flow\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymu}\ {\isasymE}\ {\isasymc}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlsub N{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ vset{\isacharunderscore}{\kern0pt}delete\ vset{\isacharunderscore}{\kern0pt}insert\ vset{\isacharunderscore}{\kern0pt}inv\ isin\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ lookup\ t{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ sel\ adj{\isacharunderscore}{\kern0pt}inv\ flow{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}update\ bal{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ conv{\isacharunderscore}{\kern0pt}update\ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ local{\isachardot}{\kern0pt}{\isasymb}\ get{\isacharunderscore}{\kern0pt}max\ local{\isachardot}{\kern0pt}{\isasymepsilon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlsub G{\isachardoublequoteclose}\ N\ fst\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ flow{\isacharunderscore}{\kern0pt}empty\ bal{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ conv{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\isanewline
\ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source\ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}target\ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow\ algo\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ Map\ \isakeywordTWO{where}\ empty\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ \isakeywordTWO{and}\ update{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ \isakeywordTWO{and}\ lookup{\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \isakeywordTWO{and}\ delete{\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ \isakeywordTWO{and}\ invar\ {\isacharequal}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}axioms\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ xs{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ x\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ fl{\isacharparenright}{\kern0pt}\ xs\ flow{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ ys{\isachardot}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}flow{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}update\ x\ \ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ fl{\isacharparenright}{\kern0pt}\ ys\ flow{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ ys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ vs{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ x\ \ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ fl{\isacharparenright}{\kern0pt}\ vs\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ vs{\isachardot}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ x\ \ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ fl{\isacharparenright}{\kern0pt}\ vs\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ vs{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ x\ False\ fl{\isacharparenright}{\kern0pt}\ vs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ vs{\isachardot}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ x\ False\ fl{\isacharparenright}{\kern0pt}\ vs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ set\ vs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}\ vs{\isachardot}{\kern0pt}\ e\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ x\ False\ fl{\isacharparenright}{\kern0pt}\ vs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x\ fl{\isachardot}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ x\ False\ fl{\isacharparenright}{\kern0pt}\ vs\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ e\ {\isacharequal}{\kern0pt}\ Some\ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordTWO{for}\ xs\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ Map{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{2}}\ \isakeywordTWO{for}\ ys\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ ys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ Map{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{3}}\ \isakeywordTWO{for}\ vs\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ vs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}empty\ invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{4}}\ \isakeywordTWO{for}\ vs\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{3}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ vs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}update\ map{\isacharunderscore}{\kern0pt}empty\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{5}}\ \isakeywordTWO{for}\ es\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ es{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}empty\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}invar{\isacharunderscore}{\kern0pt}update{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{6}}\ \isakeywordTWO{for}\ vs\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{5}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ vs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{subgoal}\isamarkupfalse%
\ {\isadigit{7}}\ \isakeywordTWO{for}\ vs\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{5}}\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ vs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}empty\ dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ orlins{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}orlins{\isacharunderscore}{\kern0pt}axioms\ snd\ {\isasymE}\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ {\isasymb}\ get{\isacharunderscore}{\kern0pt}max\ fst\ init{\isacharunderscore}{\kern0pt}flow\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ init{\isacharunderscore}{\kern0pt}bal\ init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ orlins{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ local{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}max\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{4}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}impl\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{5}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}dom\ domIff\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}def\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{7}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{8}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}def\ vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}V\ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ make{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}are{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{9}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{1}}{\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}algo{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}meaning{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}ees{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}def\ local{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{1}}\ e{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\ local{\isachardot}{\kern0pt}init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{3}}\isanewline
\ \ \isakeywordTHREE{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ local{\isachardot}{\kern0pt}{\isasymE}{\isacharunderscore}{\kern0pt}def\ \ init{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}def\ init{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}variables{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ ees{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}invar\ local{\isachardot}{\kern0pt}to{\isacharunderscore}{\kern0pt}list{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ orlins{\isacharcolon}{\kern0pt}\ \isanewline
\ \ Orlins{\isachardot}{\kern0pt}orlins\ snd\ \ create{\isacharunderscore}{\kern0pt}edge\ {\isasymu}\ {\isasymE}\ {\isasymc}\ edge{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}update\ vset{\isacharunderscore}{\kern0pt}empty\ vset{\isacharunderscore}{\kern0pt}delete\ vset{\isacharunderscore}{\kern0pt}insert\isanewline
\ \ \ \ \ vset{\isacharunderscore}{\kern0pt}inv\ isin\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ lookup\ t{\isacharunderscore}{\kern0pt}set\ sel\ adj{\isacharunderscore}{\kern0pt}inv\ flow{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ flow{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}empty\ bal{\isacharunderscore}{\kern0pt}update\ bal{\isacharunderscore}{\kern0pt}delete\ bal{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ bal{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \ \ \ conv{\isacharunderscore}{\kern0pt}empty\ conv{\isacharunderscore}{\kern0pt}update\ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\ conv{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ {\isasymb}\ get{\isacharunderscore}{\kern0pt}max\ {\isasymepsilon}\ N\ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ map{\isacharunderscore}{\kern0pt}empty\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ get{\isacharunderscore}{\kern0pt}path\ fst\isanewline
\ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b\ get{\isacharunderscore}{\kern0pt}source\ get{\isacharunderscore}{\kern0pt}target\isanewline
\ \ \ \ \ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance\ init{\isacharunderscore}{\kern0pt}flow\ init{\isacharunderscore}{\kern0pt}bal\ init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card\ init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ orlins{\isachardot}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ maintain{\isacharunderscore}{\kern0pt}forest{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}axioms\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ send{\isacharunderscore}{\kern0pt}flow{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}axioms\ send{\isacharunderscore}{\kern0pt}flow\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maintain{\isacharunderscore}{\kern0pt}forest{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}axioms\ orlins{\isacharunderscore}{\kern0pt}spec{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orlins{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}orlins{\isacharunderscore}{\kern0pt}initial\ \ {\isacharequal}{\kern0pt}\ orlins{\isachardot}{\kern0pt}initial{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ \ maintain{\isacharunderscore}{\kern0pt}forest{\isachardot}{\kern0pt}maintain{\isacharunderscore}{\kern0pt}forest{\isacharunderscore}{\kern0pt}impl\ {\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}orlins{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ orlins{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ orlins{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl\ {\isacharparenleft}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl\ orlins{\isacharunderscore}{\kern0pt}initial{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ {\isacharequal}{\kern0pt}\ current{\isacharunderscore}{\kern0pt}flow\ final{\isacharunderscore}{\kern0pt}state{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{corollary}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ success\ {\isasymLongrightarrow}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt\ \ {\isasymb}\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ infeasible\ {\isasymLongrightarrow}\ \ {\isasymnexists}\ f{\isachardot}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}network{\isachardot}{\kern0pt}isbflow\ f\ {\isasymb}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}return\ final{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ notyetterm\ {\isasymLongrightarrow}\ \ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ orlins{\isachardot}{\kern0pt}initial{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}dom{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}results{\isacharbrackleft}{\kern0pt}OF\ refl{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ orlins{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orlins{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ fst\ snd\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymnot}\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymc}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeywordTWO{for}\ fst\ snd\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}condI{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}\ D{\isachardot}{\kern0pt}\ {\isasymlbrakk}closed{\isacharunderscore}{\kern0pt}w\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ \ \ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd{\isacharparenright}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}e{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymc}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ D\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ set\ D\ {\isasymsubseteq}\ \ \ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}{\isasymrbrakk}\ {\isasymLongrightarrow}\ False{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymLongrightarrow}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ fst\ snd\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\ \isakeywordTWO{for}\ fst\ snd\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ has{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{term}\isamarkupfalse%
\ {\isacartoucheopen}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd{\isacartoucheclose}\isanewline
\isakeywordONE{thm}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}{\isasymlbrakk}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharsemicolon}{\kern0pt}\ bal{\isacharunderscore}{\kern0pt}invar\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharsemicolon}{\kern0pt}\isanewline
\ \ dVs\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd\ {\isacharbackquote}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}N\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}list\ fst\ snd{\isasymrbrakk}\isanewline
\ \ \ {\isasymLongrightarrow}\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}list\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ set{\isacharunderscore}{\kern0pt}invar\ to{\isacharunderscore}{\kern0pt}set\ \ fst\ snd\ get{\isacharunderscore}{\kern0pt}max{\isachardoublequoteclose}\ \isakeywordTWO{for}\ fst\ snd\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}list\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharunderscore}{\kern0pt}def\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}max\ multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}iterator\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}def\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordONE{lemmas}\isamarkupfalse%
\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator{\isacharequal}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ Map{\isacharunderscore}{\kern0pt}iterator\ flow{\isacharunderscore}{\kern0pt}invar\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}def\ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ \ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordONE{lemmas}\isamarkupfalse%
\ flow{\isacharunderscore}{\kern0pt}iterator{\isacharequal}{\kern0pt}flow{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator{\isacharcolon}{\kern0pt}\ \isanewline
\ \ Map{\isacharunderscore}{\kern0pt}iterator\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ \ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isakeywordONE{lemmas}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator\ {\isacharequal}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}iterator{\isacharunderscore}{\kern0pt}axioms\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}state\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orlins{\isacharunderscore}{\kern0pt}impl\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}initial\ fst\ snd\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ fst\ snd\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}current{\isacharunderscore}{\kern0pt}flow\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state\ \ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ fst\ snd\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ {\isacharequal}{\kern0pt}\ algo{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ flow{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}algo\ {\isacharequal}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ fst\ snd{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}impl\isanewline
\ \ \isakeywordTWO{and}\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharparenright}{\kern0pt}\ list{\isachardoublequoteclose}\ \isakeywordTWO{and}\ create{\isacharunderscore}{\kern0pt}edge\ \isanewline
\ \ \isakeywordTWO{and}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ {\isasymtimes}\ real{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ color{\isacharparenright}{\kern0pt}\ tree{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ c{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}c{\isacharunderscore}{\kern0pt}impl\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}edge{\isacharunderscore}{\kern0pt}type\ {\isasymRightarrow}\ real\ option{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordTWO{assumes}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isachardoublequoteclose}\ {\isachardoublequoteopen}\ bal{\isacharunderscore}{\kern0pt}invar\ {\isacharparenleft}{\kern0pt}{\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ \ Vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dVs\ {\isacharparenleft}{\kern0pt}multigraph{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair\ fst\ snd\ {\isacharbackquote}{\kern0pt}\ to{\isacharunderscore}{\kern0pt}set\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ dom\ {\isacharparenleft}{\kern0pt}bal{\isacharunderscore}{\kern0pt}lookup\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ at{\isacharunderscore}{\kern0pt}least{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}verts{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}N\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}list\ fst\ snd{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{and}\ multigraph{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}multigraph\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isacharparenleft}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{interpretation}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharcolon}{\kern0pt}\isanewline
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}empty\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}update\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}delete\isanewline
\ \ \ \ \ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}lookup\ realising{\isacharunderscore}{\kern0pt}edges{\isacharunderscore}{\kern0pt}invar\ bal{\isacharunderscore}{\kern0pt}empty\ bal{\isacharunderscore}{\kern0pt}delete\ bal{\isacharunderscore}{\kern0pt}lookup\ bal{\isacharunderscore}{\kern0pt}invar\ \isanewline
\ \ \ \ \ flow{\isacharunderscore}{\kern0pt}empty\ flow{\isacharunderscore}{\kern0pt}delete\ flow{\isacharunderscore}{\kern0pt}lookup\ flow{\isacharunderscore}{\kern0pt}invar\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}empty\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}delete\ \isanewline
\ \ \ \ \ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}lookup\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}invar\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}empty\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}delete\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ \isanewline
\ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}invar\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ to{\isacharunderscore}{\kern0pt}list\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup\ filter\ are{\isacharunderscore}{\kern0pt}all\ set{\isacharunderscore}{\kern0pt}invar\isanewline
\ \ \ \ \ get{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}set\ to{\isacharunderscore}{\kern0pt}set\ \ fst\ snd\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}update\ conv{\isacharunderscore}{\kern0pt}empty\ conv{\isacharunderscore}{\kern0pt}delete\ conv{\isacharunderscore}{\kern0pt}lookup\isanewline
\ \ \ \ \ conv{\isacharunderscore}{\kern0pt}invar\ conv{\isacharunderscore}{\kern0pt}update\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}update\ flow{\isacharunderscore}{\kern0pt}update\ bal{\isacharunderscore}{\kern0pt}update\ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ \isanewline
\ \ \ \ \ flow{\isacharunderscore}{\kern0pt}update{\isacharunderscore}{\kern0pt}all\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}all\ get{\isacharunderscore}{\kern0pt}max\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}basic\ at{\isacharunderscore}{\kern0pt}least{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}verts\ gt{\isacharunderscore}{\kern0pt}zero\ multigraph\isanewline
\ \ \ \ \ \ \ \ \ rep{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iterator\ flow{\isacharunderscore}{\kern0pt}iterator\ not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}iterator\ \ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}intro\ \isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ Map{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms\ Set{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}predicate\ {\isasymE}{\isacharunderscore}{\kern0pt}def\ Adj{\isacharunderscore}{\kern0pt}Map{\isacharunderscore}{\kern0pt}Specs{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Map{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}comp\ Map{\isacharunderscore}{\kern0pt}conv\ \ \ bal{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}b\ Vs{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}dom\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Map{\isacharunderscore}{\kern0pt}realising{\isacharunderscore}{\kern0pt}edges\ function{\isacharunderscore}{\kern0pt}generation{\isachardot}{\kern0pt}intro\ bal{\isacharunderscore}{\kern0pt}map{\isachardot}{\kern0pt}Map{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemmas}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof\ {\isacharequal}{\kern0pt}\ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isacharunderscore}{\kern0pt}axioms\isanewline
\isakeywordONE{context}\isamarkupfalse%
\ \ \ \isanewline
\ \ \isakeywordTWO{assumes}\ no{\isacharunderscore}{\kern0pt}cycle{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ fst\ snd\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharunderscore}{\kern0pt}def\isanewline
\ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}multigraph{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ selection{\isacharunderscore}{\kern0pt}functions{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{corollary}\isamarkupfalse%
\ correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}return\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ success\ {\isasymLongrightarrow}\ \ \isanewline
\ \ \ \ \ \ \ \ cost{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}Opt\ fst\ snd\ \ {\isasymu}\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymc}\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymb}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ \isanewline
\ {\isacharparenleft}{\kern0pt}abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}return\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state\ \ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ infeasible\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isasymnexists}\ f{\isachardot}{\kern0pt}\ flow{\isacharunderscore}{\kern0pt}network{\isacharunderscore}{\kern0pt}spec{\isachardot}{\kern0pt}isbflow\ \ fst\ snd\ {\isacharparenleft}{\kern0pt}{\isasymE}\ {\isasymE}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}\ {\isasymu}\ \ f\ {\isacharparenleft}{\kern0pt}{\isasymb}\ {\isasymb}{\isacharunderscore}{\kern0pt}impl{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ {\isachardoublequoteopen}return\ {\isacharparenleft}{\kern0pt}final{\isacharunderscore}{\kern0pt}state\ fst\ snd\ create{\isacharunderscore}{\kern0pt}edge\ {\isasymE}{\isacharunderscore}{\kern0pt}impl\ {\isasymc}{\isacharunderscore}{\kern0pt}impl\ {\isasymb}{\isacharunderscore}{\kern0pt}impl\ c{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ notyetterm\ {\isasymLongrightarrow}\ \ \isanewline
\ \ \ \ \ \ \ \ \ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}correctness{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}implementation{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orlins{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\ N{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}b{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}source{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}target{\isacharunderscore}{\kern0pt}def\ get{\isacharunderscore}{\kern0pt}path{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}vertices{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}balance{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}send{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}loop{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\ initial{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}orlins{\isacharunderscore}{\kern0pt}initial{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\ init{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ init{\isacharunderscore}{\kern0pt}bal{\isacharunderscore}{\kern0pt}def\ init{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}def\ init{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}blocked{\isacharunderscore}{\kern0pt}def\ abstract{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}def\ final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ function{\isacharunderscore}{\kern0pt}generation{\isacharunderscore}{\kern0pt}proof{\isachardot}{\kern0pt}final{\isacharunderscore}{\kern0pt}flow{\isacharunderscore}{\kern0pt}impl{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}OF\ \ no{\isacharunderscore}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}cond{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymE}{\isacharunderscore}{\kern0pt}def\ {\isasymb}{\isacharunderscore}{\kern0pt}def\ {\isasymc}{\isacharunderscore}{\kern0pt}def\ {\isasymu}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
\isanewline
\isakeywordONE{datatype}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ cost{\isacharunderscore}{\kern0pt}wrapper\ {\isacharequal}{\kern0pt}\ cost{\isacharunderscore}{\kern0pt}container\ {\isacharprime}{\kern0pt}a\isanewline
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Isabelle-Graph-Library_second/Mincost_Flow_Algorithms/Use_Orlins_Algorithm/Instantiation.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%32=7%:%
%:%33=8%:%
%:%34=9%:%
%:%48=11%:%
%:%58=13%:%
%:%59=13%:%
%:%60=14%:%
%:%61=14%:%
%:%62=15%:%
%:%63=16%:%
%:%64=16%:%
%:%65=17%:%
%:%66=18%:%
%:%67=19%:%
%:%68=20%:%
%:%69=20%:%
%:%71=22%:%
%:%73=23%:%
%:%74=23%:%
%:%75=24%:%
%:%76=24%:%
%:%77=25%:%
%:%78=26%:%
%:%79=26%:%
%:%80=27%:%
%:%81=27%:%
%:%82=28%:%
%:%83=28%:%
%:%84=29%:%
%:%85=30%:%
%:%86=30%:%
%:%87=31%:%
%:%88=32%:%
%:%89=32%:%
%:%90=33%:%
%:%91=33%:%
%:%92=34%:%
%:%93=34%:%
%:%94=35%:%
%:%95=35%:%
%:%96=36%:%
%:%97=36%:%
%:%98=37%:%
%:%99=38%:%
%:%100=38%:%
%:%101=39%:%
%:%102=39%:%
%:%103=40%:%
%:%104=40%:%
%:%105=41%:%
%:%106=41%:%
%:%107=42%:%
%:%108=42%:%
%:%109=43%:%
%:%110=44%:%
%:%111=44%:%
%:%112=45%:%
%:%113=45%:%
%:%114=46%:%
%:%115=46%:%
%:%116=47%:%
%:%117=47%:%
%:%118=48%:%
%:%119=48%:%
%:%120=49%:%
%:%121=50%:%
%:%122=50%:%
%:%123=51%:%
%:%124=51%:%
%:%125=52%:%
%:%126=52%:%
%:%127=53%:%
%:%128=53%:%
%:%129=54%:%
%:%130=54%:%
%:%131=55%:%
%:%132=56%:%
%:%133=56%:%
%:%134=57%:%
%:%135=57%:%
%:%136=58%:%
%:%137=58%:%
%:%138=59%:%
%:%139=59%:%
%:%140=60%:%
%:%141=60%:%
%:%142=61%:%
%:%143=62%:%
%:%144=62%:%
%:%146=64%:%
%:%147=65%:%
%:%148=65%:%
%:%150=67%:%
%:%151=68%:%
%:%152=68%:%
%:%154=70%:%
%:%155=71%:%
%:%156=72%:%
%:%157=72%:%
%:%158=73%:%
%:%160=75%:%
%:%161=76%:%
%:%163=78%:%
%:%164=79%:%
%:%165=80%:%
%:%166=81%:%
%:%167=82%:%
%:%168=83%:%
%:%170=85%:%
%:%171=86%:%
%:%173=88%:%
%:%174=89%:%
%:%175=90%:%
%:%176=91%:%
%:%177=92%:%
%:%178=93%:%
%:%180=95%:%
%:%181=96%:%
%:%183=98%:%
%:%184=99%:%
%:%185=100%:%
%:%186=101%:%
%:%187=102%:%
%:%188=103%:%
%:%189=104%:%
%:%190=105%:%
%:%193=106%:%
%:%197=106%:%
%:%198=106%:%
%:%199=107%:%
%:%200=107%:%
%:%201=108%:%
%:%202=109%:%
%:%203=110%:%
%:%204=111%:%
%:%205=112%:%
%:%210=112%:%
%:%213=113%:%
%:%214=114%:%
%:%215=114%:%
%:%216=115%:%
%:%217=116%:%
%:%220=117%:%
%:%224=117%:%
%:%225=117%:%
%:%226=118%:%
%:%227=118%:%
%:%232=118%:%
%:%235=119%:%
%:%236=120%:%
%:%237=120%:%
%:%238=121%:%
%:%239=122%:%
%:%240=122%:%
%:%241=123%:%
%:%242=124%:%
%:%243=124%:%
%:%246=125%:%
%:%250=125%:%
%:%251=125%:%
%:%252=126%:%
%:%253=126%:%
%:%254=127%:%
%:%255=127%:%
%:%256=128%:%
%:%257=128%:%
%:%258=129%:%
%:%264=129%:%
%:%267=130%:%
%:%268=131%:%
%:%269=131%:%
%:%270=132%:%
%:%271=133%:%
%:%272=133%:%
%:%273=134%:%
%:%274=135%:%
%:%277=136%:%
%:%281=136%:%
%:%282=136%:%
%:%283=137%:%
%:%284=137%:%
%:%289=137%:%
%:%292=138%:%
%:%293=139%:%
%:%294=139%:%
%:%295=140%:%
%:%296=141%:%
%:%297=141%:%
%:%298=142%:%
%:%299=143%:%
%:%300=143%:%
%:%301=144%:%
%:%302=144%:%
%:%303=145%:%
%:%304=145%:%
%:%305=146%:%
%:%306=146%:%
%:%307=147%:%
%:%308=147%:%
%:%309=148%:%
%:%310=149%:%
%:%311=149%:%
%:%312=150%:%
%:%313=151%:%
%:%316=152%:%
%:%320=152%:%
%:%321=152%:%
%:%322=153%:%
%:%323=153%:%
%:%324=154%:%
%:%329=154%:%
%:%332=155%:%
%:%333=156%:%
%:%334=156%:%
%:%335=157%:%
%:%336=158%:%
%:%337=158%:%
%:%338=159%:%
%:%339=160%:%
%:%340=160%:%
%:%341=161%:%
%:%342=162%:%
%:%343=162%:%
%:%344=163%:%
%:%345=164%:%
%:%346=165%:%
%:%347=166%:%
%:%348=167%:%
%:%349=168%:%
%:%350=169%:%
%:%351=170%:%
%:%352=171%:%
%:%353=172%:%
%:%354=173%:%
%:%355=174%:%
%:%356=175%:%
%:%357=176%:%
%:%358=177%:%
%:%359=178%:%
%:%360=179%:%
%:%361=180%:%
%:%362=181%:%
%:%363=182%:%
%:%364=183%:%
%:%365=184%:%
%:%366=185%:%
%:%367=186%:%
%:%368=187%:%
%:%369=188%:%
%:%370=189%:%
%:%371=190%:%
%:%372=191%:%
%:%373=192%:%
%:%374=193%:%
%:%375=194%:%
%:%376=195%:%
%:%377=196%:%
%:%378=197%:%
%:%379=198%:%
%:%380=199%:%
%:%381=200%:%
%:%382=201%:%
%:%383=202%:%
%:%384=203%:%
%:%385=204%:%
%:%386=205%:%
%:%387=206%:%
%:%388=207%:%
%:%389=208%:%
%:%390=209%:%
%:%391=210%:%
%:%392=211%:%
%:%393=212%:%
%:%394=213%:%
%:%395=214%:%
%:%396=215%:%
%:%397=216%:%
%:%398=217%:%
%:%399=218%:%
%:%400=219%:%
%:%401=220%:%
%:%402=221%:%
%:%403=222%:%
%:%404=222%:%
%:%405=223%:%
%:%406=224%:%
%:%407=224%:%
%:%408=225%:%
%:%409=225%:%
%:%410=226%:%
%:%411=226%:%
%:%412=227%:%
%:%413=227%:%
%:%414=228%:%
%:%415=228%:%
%:%416=229%:%
%:%417=230%:%
%:%418=230%:%
%:%419=231%:%
%:%420=231%:%
%:%421=232%:%
%:%422=232%:%
%:%423=233%:%
%:%424=233%:%
%:%425=234%:%
%:%426=235%:%
%:%427=235%:%
%:%428=236%:%
%:%429=237%:%
%:%430=237%:%
%:%431=238%:%
%:%432=238%:%
%:%433=239%:%
%:%434=240%:%
%:%435=240%:%
%:%436=241%:%
%:%437=241%:%
%:%438=242%:%
%:%439=243%:%
%:%440=243%:%
%:%441=244%:%
%:%442=245%:%
%:%443=245%:%
%:%444=246%:%
%:%445=247%:%
%:%447=249%:%
%:%448=250%:%
%:%449=251%:%
%:%450=251%:%
%:%451=252%:%
%:%452=253%:%
%:%453=253%:%
%:%454=254%:%
%:%455=255%:%
%:%457=257%:%
%:%458=258%:%
%:%459=259%:%
%:%460=259%:%
%:%461=260%:%
%:%462=261%:%
%:%463=261%:%
%:%464=262%:%
%:%465=263%:%
%:%466=263%:%
%:%471=268%:%
%:%472=269%:%
%:%473=270%:%
%:%474=270%:%
%:%475=271%:%
%:%476=272%:%
%:%477=272%:%
%:%481=276%:%
%:%482=277%:%
%:%483=278%:%
%:%484=279%:%
%:%485=279%:%
%:%489=283%:%
%:%490=284%:%
%:%491=285%:%
%:%492=286%:%
%:%493=286%:%
%:%504=297%:%
%:%505=298%:%
%:%506=299%:%
%:%507=300%:%
%:%508=300%:%
%:%519=311%:%
%:%520=312%:%
%:%521=313%:%
%:%522=313%:%
%:%524=315%:%
%:%525=316%:%
%:%526=317%:%
%:%527=317%:%
%:%529=319%:%
%:%530=320%:%
%:%531=321%:%
%:%532=321%:%
%:%533=322%:%
%:%534=323%:%
%:%536=325%:%
%:%537=326%:%
%:%538=327%:%
%:%539=327%:%
%:%540=328%:%
%:%541=329%:%
%:%542=329%:%
%:%543=330%:%
%:%544=331%:%
%:%546=333%:%
%:%547=334%:%
%:%548=335%:%
%:%549=335%:%
%:%550=336%:%
%:%551=337%:%
%:%552=338%:%
%:%553=338%:%
%:%554=339%:%
%:%555=340%:%
%:%556=341%:%
%:%557=341%:%
%:%558=342%:%
%:%559=343%:%
%:%560=344%:%
%:%561=344%:%
%:%564=347%:%
%:%565=348%:%
%:%566=349%:%
%:%567=349%:%
%:%577=359%:%
%:%578=360%:%
%:%579=361%:%
%:%580=361%:%
%:%583=364%:%
%:%584=365%:%
%:%585=366%:%
%:%586=366%:%
%:%596=376%:%
%:%597=377%:%
%:%598=378%:%
%:%599=378%:%
%:%600=379%:%
%:%601=380%:%
%:%602=381%:%
%:%603=382%:%
%:%604=382%:%
%:%605=383%:%
%:%606=384%:%
%:%607=385%:%
%:%608=385%:%
%:%609=386%:%
%:%610=386%:%
%:%611=387%:%
%:%612=387%:%
%:%613=388%:%
%:%614=388%:%
%:%615=389%:%
%:%616=389%:%
%:%617=390%:%
%:%618=390%:%
%:%619=391%:%
%:%620=392%:%
%:%621=392%:%
%:%622=393%:%
%:%623=394%:%
%:%624=394%:%
%:%625=395%:%
%:%626=396%:%
%:%627=397%:%
%:%630=398%:%
%:%634=398%:%
%:%635=398%:%
%:%636=399%:%
%:%637=399%:%
%:%638=400%:%
%:%639=401%:%
%:%640=402%:%
%:%645=402%:%
%:%648=403%:%
%:%649=404%:%
%:%650=404%:%
%:%651=405%:%
%:%652=406%:%
%:%653=406%:%
%:%656=407%:%
%:%660=407%:%
%:%661=407%:%
%:%666=407%:%
%:%669=408%:%
%:%670=409%:%
%:%671=409%:%
%:%672=410%:%
%:%673=411%:%
%:%674=412%:%
%:%675=413%:%
%:%676=414%:%
%:%679=415%:%
%:%683=415%:%
%:%684=415%:%
%:%685=416%:%
%:%686=416%:%
%:%691=416%:%
%:%694=417%:%
%:%695=418%:%
%:%696=418%:%
%:%699=419%:%
%:%703=419%:%
%:%704=419%:%
%:%705=420%:%
%:%706=420%:%
%:%711=420%:%
%:%714=421%:%
%:%715=422%:%
%:%716=422%:%
%:%719=423%:%
%:%723=423%:%
%:%724=423%:%
%:%725=424%:%
%:%726=424%:%
%:%727=425%:%
%:%732=425%:%
%:%735=426%:%
%:%736=427%:%
%:%737=427%:%
%:%738=428%:%
%:%739=429%:%
%:%740=429%:%
%:%741=430%:%
%:%742=431%:%
%:%745=432%:%
%:%749=432%:%
%:%750=432%:%
%:%751=433%:%
%:%752=433%:%
%:%753=434%:%
%:%758=434%:%
%:%761=435%:%
%:%762=436%:%
%:%763=436%:%
%:%764=437%:%
%:%765=438%:%
%:%766=438%:%
%:%769=439%:%
%:%773=439%:%
%:%774=439%:%
%:%775=440%:%
%:%776=440%:%
%:%777=441%:%
%:%782=441%:%
%:%785=442%:%
%:%786=443%:%
%:%787=443%:%
%:%788=444%:%
%:%789=445%:%
%:%790=445%:%
%:%791=446%:%
%:%792=447%:%
%:%795=448%:%
%:%799=448%:%
%:%800=448%:%
%:%801=449%:%
%:%802=449%:%
%:%803=450%:%
%:%808=450%:%
%:%811=451%:%
%:%812=452%:%
%:%813=452%:%
%:%814=453%:%
%:%815=454%:%
%:%816=454%:%
%:%817=455%:%
%:%820=456%:%
%:%824=456%:%
%:%825=456%:%
%:%826=457%:%
%:%827=457%:%
%:%828=458%:%
%:%829=459%:%
%:%834=459%:%
%:%837=460%:%
%:%838=461%:%
%:%839=461%:%
%:%840=462%:%
%:%841=463%:%
%:%842=463%:%
%:%845=464%:%
%:%849=464%:%
%:%850=464%:%
%:%851=465%:%
%:%852=465%:%
%:%853=466%:%
%:%858=466%:%
%:%861=467%:%
%:%862=468%:%
%:%863=468%:%
%:%864=469%:%
%:%865=470%:%
%:%866=470%:%
%:%867=471%:%
%:%868=472%:%
%:%869=473%:%
%:%870=474%:%
%:%871=475%:%
%:%872=476%:%
%:%873=477%:%
%:%874=478%:%
%:%875=479%:%
%:%876=480%:%
%:%877=481%:%
%:%878=482%:%
%:%879=483%:%
%:%880=484%:%
%:%881=485%:%
%:%882=486%:%
%:%883=487%:%
%:%884=488%:%
%:%885=489%:%
%:%886=490%:%
%:%887=491%:%
%:%888=492%:%
%:%889=493%:%
%:%890=494%:%
%:%891=495%:%
%:%892=496%:%
%:%893=497%:%
%:%894=498%:%
%:%895=499%:%
%:%896=500%:%
%:%897=501%:%
%:%898=502%:%
%:%899=503%:%
%:%900=504%:%
%:%901=505%:%
%:%902=506%:%
%:%903=507%:%
%:%904=508%:%
%:%905=509%:%
%:%906=510%:%
%:%907=511%:%
%:%908=512%:%
%:%909=513%:%
%:%910=514%:%
%:%911=515%:%
%:%912=516%:%
%:%913=517%:%
%:%914=518%:%
%:%915=519%:%
%:%916=520%:%
%:%917=521%:%
%:%918=522%:%
%:%919=523%:%
%:%920=524%:%
%:%921=525%:%
%:%922=526%:%
%:%923=527%:%
%:%924=528%:%
%:%925=529%:%
%:%926=530%:%
%:%927=531%:%
%:%928=532%:%
%:%929=533%:%
%:%930=534%:%
%:%931=535%:%
%:%932=536%:%
%:%933=537%:%
%:%934=538%:%
%:%935=539%:%
%:%936=540%:%
%:%937=541%:%
%:%938=542%:%
%:%939=543%:%
%:%940=544%:%
%:%941=545%:%
%:%944=546%:%
%:%948=546%:%
%:%949=546%:%
%:%950=547%:%
%:%955=547%:%
%:%958=548%:%
%:%959=549%:%
%:%960=549%:%
%:%961=550%:%
%:%962=551%:%
%:%963=551%:%
%:%964=552%:%
%:%965=553%:%
%:%966=554%:%
%:%967=555%:%
%:%968=556%:%
%:%969=557%:%
%:%970=558%:%
%:%971=559%:%
%:%972=560%:%
%:%973=561%:%
%:%974=562%:%
%:%975=563%:%
%:%976=564%:%
%:%977=565%:%
%:%978=566%:%
%:%979=567%:%
%:%980=568%:%
%:%981=569%:%
%:%982=570%:%
%:%983=571%:%
%:%984=572%:%
%:%985=573%:%
%:%986=574%:%
%:%987=575%:%
%:%988=576%:%
%:%989=577%:%
%:%990=578%:%
%:%991=579%:%
%:%992=580%:%
%:%993=581%:%
%:%994=582%:%
%:%995=583%:%
%:%996=584%:%
%:%997=585%:%
%:%998=586%:%
%:%999=587%:%
%:%1000=588%:%
%:%1001=589%:%
%:%1002=590%:%
%:%1003=591%:%
%:%1004=592%:%
%:%1005=593%:%
%:%1006=594%:%
%:%1007=595%:%
%:%1008=596%:%
%:%1009=597%:%
%:%1010=598%:%
%:%1011=599%:%
%:%1012=600%:%
%:%1013=601%:%
%:%1014=602%:%
%:%1015=603%:%
%:%1016=604%:%
%:%1017=605%:%
%:%1018=606%:%
%:%1019=607%:%
%:%1020=608%:%
%:%1021=609%:%
%:%1022=610%:%
%:%1023=611%:%
%:%1024=612%:%
%:%1025=613%:%
%:%1026=614%:%
%:%1027=615%:%
%:%1028=616%:%
%:%1029=617%:%
%:%1030=618%:%
%:%1031=619%:%
%:%1032=620%:%
%:%1033=621%:%
%:%1034=622%:%
%:%1035=623%:%
%:%1036=624%:%
%:%1037=625%:%
%:%1038=626%:%
%:%1039=627%:%
%:%1040=628%:%
%:%1041=629%:%
%:%1042=630%:%
%:%1043=631%:%
%:%1044=632%:%
%:%1045=633%:%
%:%1046=634%:%
%:%1047=635%:%
%:%1048=636%:%
%:%1049=637%:%
%:%1050=638%:%
%:%1051=639%:%
%:%1052=640%:%
%:%1053=641%:%
%:%1054=642%:%
%:%1055=643%:%
%:%1056=644%:%
%:%1057=645%:%
%:%1058=646%:%
%:%1059=647%:%
%:%1060=648%:%
%:%1061=649%:%
%:%1062=650%:%
%:%1063=651%:%
%:%1064=652%:%
%:%1065=653%:%
%:%1066=654%:%
%:%1069=655%:%
%:%1073=655%:%
%:%1074=655%:%
%:%1075=656%:%
%:%1076=656%:%
%:%1077=657%:%
%:%1078=658%:%
%:%1079=659%:%
%:%1084=659%:%
%:%1087=660%:%
%:%1088=661%:%
%:%1089=661%:%
%:%1090=662%:%
%:%1091=663%:%
%:%1092=663%:%
%:%1093=664%:%
%:%1094=664%:%
%:%1095=665%:%
%:%1096=665%:%
%:%1097=666%:%
%:%1098=666%:%
%:%1105=668%:%
%:%1115=670%:%
%:%1116=670%:%
%:%1117=671%:%
%:%1118=672%:%
%:%1121=673%:%
%:%1125=673%:%
%:%1126=673%:%
%:%1127=674%:%
%:%1128=674%:%
%:%1133=674%:%
%:%1136=675%:%
%:%1137=676%:%
%:%1138=676%:%
%:%1141=677%:%
%:%1145=677%:%
%:%1146=677%:%
%:%1151=677%:%
%:%1154=678%:%
%:%1155=679%:%
%:%1156=679%:%
%:%1157=680%:%
%:%1158=681%:%
%:%1161=682%:%
%:%1165=682%:%
%:%1166=682%:%
%:%1171=682%:%
%:%1174=683%:%
%:%1175=684%:%
%:%1176=684%:%
%:%1177=685%:%
%:%1179=687%:%
%:%1182=688%:%
%:%1186=688%:%
%:%1187=688%:%
%:%1188=689%:%
%:%1193=689%:%
%:%1196=690%:%
%:%1197=691%:%
%:%1198=691%:%
%:%1199=692%:%
%:%1201=694%:%
%:%1204=695%:%
%:%1208=695%:%
%:%1209=695%:%
%:%1210=696%:%
%:%1211=696%:%
%:%1212=696%:%
%:%1213=697%:%
%:%1214=697%:%
%:%1215=698%:%
%:%1216=698%:%
%:%1217=699%:%
%:%1218=699%:%
%:%1219=700%:%
%:%1220=700%:%
%:%1221=701%:%
%:%1222=701%:%
%:%1223=702%:%
%:%1224=702%:%
%:%1225=703%:%
%:%1226=703%:%
%:%1227=704%:%
%:%1228=704%:%
%:%1229=705%:%
%:%1230=705%:%
%:%1231=706%:%
%:%1232=706%:%
%:%1233=707%:%
%:%1239=707%:%
%:%1242=708%:%
%:%1243=709%:%
%:%1244=709%:%
%:%1245=710%:%
%:%1248=711%:%
%:%1252=711%:%
%:%1253=711%:%
%:%1254=711%:%
%:%1259=711%:%
%:%1262=712%:%
%:%1263=713%:%
%:%1264=713%:%
%:%1265=714%:%
%:%1268=715%:%
%:%1272=715%:%
%:%1273=715%:%
%:%1278=715%:%
%:%1281=716%:%
%:%1282=717%:%
%:%1283=717%:%
%:%1284=718%:%
%:%1286=720%:%
%:%1289=721%:%
%:%1293=721%:%
%:%1294=721%:%
%:%1295=722%:%
%:%1296=722%:%
%:%1297=723%:%
%:%1298=723%:%
%:%1299=724%:%
%:%1300=724%:%
%:%1305=724%:%
%:%1308=725%:%
%:%1309=726%:%
%:%1310=726%:%
%:%1311=727%:%
%:%1312=728%:%
%:%1315=729%:%
%:%1319=729%:%
%:%1320=729%:%
%:%1321=729%:%
%:%1326=729%:%
%:%1329=730%:%
%:%1330=731%:%
%:%1331=731%:%
%:%1332=732%:%
%:%1333=733%:%
%:%1336=734%:%
%:%1340=734%:%
%:%1341=734%:%
%:%1342=734%:%
%:%1347=734%:%
%:%1350=735%:%
%:%1351=736%:%
%:%1352=736%:%
%:%1353=737%:%
%:%1354=738%:%
%:%1357=739%:%
%:%1361=739%:%
%:%1362=739%:%
%:%1363=739%:%
%:%1368=739%:%
%:%1371=740%:%
%:%1372=741%:%
%:%1373=741%:%
%:%1376=742%:%
%:%1380=742%:%
%:%1381=742%:%
%:%1382=743%:%
%:%1383=744%:%
%:%1384=745%:%
%:%1389=745%:%
%:%1392=746%:%
%:%1393=747%:%
%:%1394=747%:%
%:%1397=748%:%
%:%1401=748%:%
%:%1402=748%:%
%:%1407=748%:%
%:%1410=749%:%
%:%1411=750%:%
%:%1412=750%:%
%:%1415=751%:%
%:%1419=751%:%
%:%1420=751%:%
%:%1425=751%:%
%:%1428=752%:%
%:%1429=753%:%
%:%1430=753%:%
%:%1431=754%:%
%:%1434=755%:%
%:%1438=755%:%
%:%1439=755%:%
%:%1444=755%:%
%:%1447=756%:%
%:%1448=757%:%
%:%1449=757%:%
%:%1450=758%:%
%:%1451=759%:%
%:%1452=759%:%
%:%1453=760%:%
%:%1454=761%:%
%:%1455=762%:%
%:%1456=763%:%
%:%1457=764%:%
%:%1458=765%:%
%:%1459=766%:%
%:%1460=767%:%
%:%1461=768%:%
%:%1462=769%:%
%:%1463=770%:%
%:%1464=771%:%
%:%1465=772%:%
%:%1466=773%:%
%:%1467=774%:%
%:%1468=775%:%
%:%1469=776%:%
%:%1470=777%:%
%:%1471=778%:%
%:%1472=779%:%
%:%1473=780%:%
%:%1474=781%:%
%:%1475=782%:%
%:%1476=783%:%
%:%1477=784%:%
%:%1478=785%:%
%:%1479=786%:%
%:%1480=787%:%
%:%1481=788%:%
%:%1482=789%:%
%:%1483=790%:%
%:%1484=791%:%
%:%1485=792%:%
%:%1486=793%:%
%:%1487=794%:%
%:%1488=795%:%
%:%1489=796%:%
%:%1490=797%:%
%:%1491=798%:%
%:%1492=799%:%
%:%1493=800%:%
%:%1494=801%:%
%:%1495=802%:%
%:%1496=803%:%
%:%1497=804%:%
%:%1498=805%:%
%:%1499=806%:%
%:%1500=807%:%
%:%1501=808%:%
%:%1502=809%:%
%:%1503=810%:%
%:%1504=811%:%
%:%1505=812%:%
%:%1506=813%:%
%:%1507=814%:%
%:%1508=815%:%
%:%1509=816%:%
%:%1510=817%:%
%:%1511=818%:%
%:%1512=819%:%
%:%1513=819%:%
%:%1514=820%:%
%:%1515=820%:%
%:%1516=821%:%
%:%1517=821%:%
%:%1518=822%:%
%:%1519=823%:%
%:%1520=823%:%
%:%1521=824%:%
%:%1522=825%:%
%:%1523=825%:%
%:%1524=826%:%
%:%1527=827%:%
%:%1531=827%:%
%:%1532=827%:%
%:%1533=828%:%
%:%1538=828%:%
%:%1541=829%:%
%:%1542=830%:%
%:%1543=830%:%
%:%1544=831%:%
%:%1545=832%:%
%:%1546=832%:%
%:%1549=833%:%
%:%1553=833%:%
%:%1554=833%:%
%:%1555=834%:%
%:%1556=834%:%
%:%1561=834%:%
%:%1564=835%:%
%:%1565=836%:%
%:%1566=836%:%
%:%1567=837%:%
%:%1568=838%:%
%:%1571=839%:%
%:%1575=839%:%
%:%1576=839%:%
%:%1577=840%:%
%:%1578=840%:%
%:%1579=841%:%
%:%1580=841%:%
%:%1581=841%:%
%:%1582=842%:%
%:%1583=842%:%
%:%1584=843%:%
%:%1585=843%:%
%:%1586=844%:%
%:%1587=844%:%
%:%1588=845%:%
%:%1589=845%:%
%:%1590=845%:%
%:%1591=846%:%
%:%1592=846%:%
%:%1593=846%:%
%:%1594=847%:%
%:%1595=847%:%
%:%1596=848%:%
%:%1597=848%:%
%:%1598=849%:%
%:%1599=849%:%
%:%1600=849%:%
%:%1601=850%:%
%:%1602=850%:%
%:%1603=851%:%
%:%1604=851%:%
%:%1605=852%:%
%:%1606=852%:%
%:%1607=853%:%
%:%1608=853%:%
%:%1609=853%:%
%:%1610=854%:%
%:%1611=854%:%
%:%1612=854%:%
%:%1613=855%:%
%:%1614=855%:%
%:%1615=856%:%
%:%1616=856%:%
%:%1617=857%:%
%:%1618=857%:%
%:%1619=857%:%
%:%1620=858%:%
%:%1621=858%:%
%:%1622=858%:%
%:%1623=859%:%
%:%1624=859%:%
%:%1625=860%:%
%:%1626=860%:%
%:%1627=861%:%
%:%1628=861%:%
%:%1629=861%:%
%:%1630=862%:%
%:%1631=862%:%
%:%1632=863%:%
%:%1633=863%:%
%:%1634=864%:%
%:%1635=864%:%
%:%1636=865%:%
%:%1637=865%:%
%:%1638=866%:%
%:%1639=866%:%
%:%1640=866%:%
%:%1641=867%:%
%:%1642=867%:%
%:%1643=868%:%
%:%1644=868%:%
%:%1645=869%:%
%:%1646=869%:%
%:%1647=870%:%
%:%1648=870%:%
%:%1649=870%:%
%:%1650=871%:%
%:%1651=871%:%
%:%1652=872%:%
%:%1653=872%:%
%:%1654=873%:%
%:%1655=874%:%
%:%1656=874%:%
%:%1657=875%:%
%:%1658=875%:%
%:%1659=876%:%
%:%1660=876%:%
%:%1661=876%:%
%:%1662=877%:%
%:%1663=877%:%
%:%1664=878%:%
%:%1670=878%:%
%:%1673=879%:%
%:%1674=880%:%
%:%1675=880%:%
%:%1678=881%:%
%:%1682=881%:%
%:%1683=881%:%
%:%1684=882%:%
%:%1685=882%:%
%:%1686=883%:%
%:%1691=883%:%
%:%1694=884%:%
%:%1695=885%:%
%:%1696=885%:%
%:%1699=886%:%
%:%1703=886%:%
%:%1704=886%:%
%:%1705=886%:%
%:%1710=886%:%
%:%1713=887%:%
%:%1714=888%:%
%:%1715=888%:%
%:%1716=889%:%
%:%1717=890%:%
%:%1720=891%:%
%:%1724=891%:%
%:%1725=891%:%
%:%1726=892%:%
%:%1727=892%:%
%:%1732=892%:%
%:%1735=893%:%
%:%1736=894%:%
%:%1737=894%:%
%:%1738=895%:%
%:%1739=896%:%
%:%1740=896%:%
%:%1741=897%:%
%:%1742=897%:%
%:%1743=898%:%
%:%1744=898%:%
%:%1745=899%:%
%:%1746=899%:%
%:%1747=900%:%
%:%1748=901%:%
%:%1749=901%:%
%:%1752=902%:%
%:%1756=902%:%
%:%1757=902%:%
%:%1758=902%:%
%:%1763=902%:%
%:%1766=903%:%
%:%1767=904%:%
%:%1768=904%:%
%:%1771=905%:%
%:%1775=905%:%
%:%1776=905%:%
%:%1777=906%:%
%:%1778=906%:%
%:%1783=906%:%
%:%1786=907%:%
%:%1787=908%:%
%:%1788=908%:%
%:%1795=909%:%
%:%1796=909%:%
%:%1797=910%:%
%:%1798=910%:%
%:%1799=911%:%
%:%1800=912%:%
%:%1801=912%:%
%:%1802=913%:%
%:%1803=913%:%
%:%1804=914%:%
%:%1805=914%:%
%:%1806=914%:%
%:%1807=915%:%
%:%1808=915%:%
%:%1809=916%:%
%:%1810=916%:%
%:%1811=916%:%
%:%1812=917%:%
%:%1813=917%:%
%:%1814=918%:%
%:%1815=918%:%
%:%1816=919%:%
%:%1817=919%:%
%:%1818=920%:%
%:%1819=921%:%
%:%1820=921%:%
%:%1821=922%:%
%:%1822=922%:%
%:%1823=922%:%
%:%1824=923%:%
%:%1825=923%:%
%:%1826=923%:%
%:%1827=924%:%
%:%1828=924%:%
%:%1829=924%:%
%:%1830=925%:%
%:%1831=925%:%
%:%1832=926%:%
%:%1833=926%:%
%:%1834=926%:%
%:%1835=927%:%
%:%1836=927%:%
%:%1837=927%:%
%:%1838=928%:%
%:%1839=928%:%
%:%1840=929%:%
%:%1841=929%:%
%:%1842=930%:%
%:%1843=930%:%
%:%1844=931%:%
%:%1845=931%:%
%:%1846=932%:%
%:%1847=932%:%
%:%1848=933%:%
%:%1849=934%:%
%:%1850=934%:%
%:%1851=935%:%
%:%1852=935%:%
%:%1853=936%:%
%:%1854=936%:%
%:%1855=937%:%
%:%1856=937%:%
%:%1857=937%:%
%:%1858=938%:%
%:%1859=938%:%
%:%1860=939%:%
%:%1861=939%:%
%:%1862=939%:%
%:%1863=939%:%
%:%1864=940%:%
%:%1865=940%:%
%:%1866=941%:%
%:%1867=941%:%
%:%1868=942%:%
%:%1869=942%:%
%:%1870=943%:%
%:%1876=943%:%
%:%1879=944%:%
%:%1880=945%:%
%:%1881=945%:%
%:%1884=946%:%
%:%1888=946%:%
%:%1889=946%:%
%:%1890=947%:%
%:%1891=947%:%
%:%1896=947%:%
%:%1899=948%:%
%:%1900=949%:%
%:%1901=949%:%
%:%1902=950%:%
%:%1903=951%:%
%:%1904=951%:%
%:%1905=952%:%
%:%1906=953%:%
%:%1907=954%:%
%:%1908=955%:%
%:%1909=955%:%
%:%1910=956%:%
%:%1913=957%:%
%:%1917=957%:%
%:%1918=957%:%
%:%1919=958%:%
%:%1920=958%:%
%:%1921=959%:%
%:%1926=959%:%
%:%1929=960%:%
%:%1930=961%:%
%:%1931=961%:%
%:%1932=962%:%
%:%1933=963%:%
%:%1934=963%:%
%:%1935=964%:%
%:%1938=965%:%
%:%1942=965%:%
%:%1943=965%:%
%:%1944=966%:%
%:%1945=966%:%
%:%1946=967%:%
%:%1947=968%:%
%:%1952=968%:%
%:%1955=969%:%
%:%1956=970%:%
%:%1957=970%:%
%:%1958=971%:%
%:%1959=972%:%
%:%1960=972%:%
%:%1961=973%:%
%:%1962=974%:%
%:%1963=975%:%
%:%1966=976%:%
%:%1970=976%:%
%:%1971=976%:%
%:%1972=977%:%
%:%1973=978%:%
%:%1978=978%:%
%:%1981=979%:%
%:%1982=980%:%
%:%1983=980%:%
%:%1984=981%:%
%:%1986=983%:%
%:%1987=984%:%
%:%1988=985%:%
%:%1995=986%:%
%:%1996=986%:%
%:%1997=987%:%
%:%1998=988%:%
%:%1999=988%:%
%:%2000=989%:%
%:%2001=989%:%
%:%2002=990%:%
%:%2003=990%:%
%:%2004=991%:%
%:%2005=992%:%
%:%2006=993%:%
%:%2007=993%:%
%:%2008=993%:%
%:%2009=994%:%
%:%2010=994%:%
%:%2011=995%:%
%:%2012=995%:%
%:%2013=996%:%
%:%2014=996%:%
%:%2015=997%:%
%:%2016=997%:%
%:%2017=998%:%
%:%2018=998%:%
%:%2019=999%:%
%:%2020=1000%:%
%:%2021=1001%:%
%:%2022=1001%:%
%:%2023=1002%:%
%:%2024=1002%:%
%:%2025=1003%:%
%:%2026=1003%:%
%:%2027=1003%:%
%:%2028=1004%:%
%:%2029=1004%:%
%:%2030=1005%:%
%:%2031=1005%:%
%:%2032=1006%:%
%:%2033=1007%:%
%:%2034=1007%:%
%:%2035=1008%:%
%:%2036=1008%:%
%:%2037=1009%:%
%:%2038=1009%:%
%:%2039=1009%:%
%:%2040=1010%:%
%:%2041=1010%:%
%:%2042=1011%:%
%:%2043=1012%:%
%:%2044=1012%:%
%:%2045=1013%:%
%:%2046=1013%:%
%:%2047=1014%:%
%:%2048=1014%:%
%:%2049=1015%:%
%:%2050=1016%:%
%:%2051=1016%:%
%:%2052=1017%:%
%:%2053=1017%:%
%:%2054=1018%:%
%:%2055=1019%:%
%:%2056=1019%:%
%:%2057=1020%:%
%:%2058=1020%:%
%:%2059=1021%:%
%:%2060=1021%:%
%:%2061=1022%:%
%:%2062=1023%:%
%:%2063=1023%:%
%:%2064=1024%:%
%:%2065=1024%:%
%:%2066=1025%:%
%:%2067=1026%:%
%:%2068=1026%:%
%:%2069=1027%:%
%:%2070=1027%:%
%:%2071=1028%:%
%:%2072=1028%:%
%:%2073=1029%:%
%:%2074=1029%:%
%:%2075=1030%:%
%:%2076=1030%:%
%:%2077=1031%:%
%:%2078=1031%:%
%:%2079=1032%:%
%:%2080=1032%:%
%:%2081=1033%:%
%:%2082=1033%:%
%:%2083=1033%:%
%:%2084=1034%:%
%:%2085=1034%:%
%:%2086=1035%:%
%:%2087=1035%:%
%:%2088=1036%:%
%:%2089=1036%:%
%:%2090=1036%:%
%:%2091=1037%:%
%:%2092=1037%:%
%:%2093=1038%:%
%:%2094=1038%:%
%:%2095=1038%:%
%:%2096=1038%:%
%:%2097=1039%:%
%:%2098=1039%:%
%:%2099=1040%:%
%:%2100=1040%:%
%:%2101=1041%:%
%:%2102=1041%:%
%:%2103=1042%:%
%:%2104=1043%:%
%:%2105=1043%:%
%:%2106=1044%:%
%:%2107=1044%:%
%:%2108=1045%:%
%:%2109=1046%:%
%:%2110=1046%:%
%:%2111=1047%:%
%:%2112=1047%:%
%:%2113=1048%:%
%:%2114=1048%:%
%:%2115=1049%:%
%:%2116=1049%:%
%:%2117=1050%:%
%:%2118=1050%:%
%:%2119=1051%:%
%:%2120=1051%:%
%:%2121=1052%:%
%:%2122=1053%:%
%:%2123=1053%:%
%:%2124=1054%:%
%:%2125=1055%:%
%:%2131=1055%:%
%:%2134=1056%:%
%:%2135=1057%:%
%:%2136=1057%:%
%:%2137=1058%:%
%:%2140=1059%:%
%:%2144=1059%:%
%:%2145=1059%:%
%:%2146=1060%:%
%:%2147=1060%:%
%:%2148=1061%:%
%:%2153=1061%:%
%:%2156=1062%:%
%:%2157=1063%:%
%:%2158=1063%:%
%:%2159=1064%:%
%:%2160=1065%:%
%:%2163=1066%:%
%:%2167=1066%:%
%:%2168=1066%:%
%:%2169=1067%:%
%:%2170=1067%:%
%:%2171=1068%:%
%:%2176=1068%:%
%:%2179=1069%:%
%:%2180=1070%:%
%:%2181=1070%:%
%:%2182=1071%:%
%:%2183=1072%:%
%:%2186=1073%:%
%:%2190=1073%:%
%:%2191=1073%:%
%:%2192=1074%:%
%:%2193=1074%:%
%:%2194=1075%:%
%:%2199=1075%:%
%:%2202=1076%:%
%:%2203=1077%:%
%:%2204=1077%:%
%:%2205=1078%:%
%:%2206=1079%:%
%:%2207=1080%:%
%:%2208=1081%:%
%:%2209=1082%:%
%:%2210=1083%:%
%:%2211=1084%:%
%:%2212=1085%:%
%:%2213=1086%:%
%:%2214=1087%:%
%:%2215=1088%:%
%:%2216=1089%:%
%:%2217=1090%:%
%:%2218=1091%:%
%:%2219=1092%:%
%:%2220=1093%:%
%:%2221=1094%:%
%:%2222=1095%:%
%:%2223=1096%:%
%:%2224=1097%:%
%:%2225=1098%:%
%:%2226=1099%:%
%:%2227=1100%:%
%:%2228=1101%:%
%:%2229=1102%:%
%:%2230=1103%:%
%:%2231=1104%:%
%:%2232=1105%:%
%:%2233=1106%:%
%:%2234=1107%:%
%:%2235=1108%:%
%:%2236=1109%:%
%:%2237=1110%:%
%:%2238=1111%:%
%:%2239=1112%:%
%:%2240=1113%:%
%:%2241=1114%:%
%:%2242=1115%:%
%:%2243=1116%:%
%:%2244=1117%:%
%:%2245=1118%:%
%:%2246=1119%:%
%:%2247=1120%:%
%:%2248=1121%:%
%:%2249=1122%:%
%:%2250=1123%:%
%:%2251=1124%:%
%:%2252=1125%:%
%:%2253=1126%:%
%:%2254=1127%:%
%:%2255=1128%:%
%:%2256=1129%:%
%:%2257=1130%:%
%:%2258=1131%:%
%:%2259=1132%:%
%:%2262=1133%:%
%:%2266=1133%:%
%:%2267=1133%:%
%:%2268=1134%:%
%:%2269=1134%:%
%:%2270=1135%:%
%:%2271=1136%:%
%:%2276=1136%:%
%:%2279=1137%:%
%:%2280=1138%:%
%:%2281=1138%:%
%:%2282=1139%:%
%:%2283=1140%:%
%:%2284=1140%:%
%:%2285=1141%:%
%:%2286=1142%:%
%:%2289=1143%:%
%:%2293=1143%:%
%:%2294=1143%:%
%:%2299=1143%:%
%:%2302=1144%:%
%:%2303=1145%:%
%:%2304=1145%:%
%:%2305=1146%:%
%:%2306=1147%:%
%:%2307=1148%:%
%:%2308=1149%:%
%:%2309=1150%:%
%:%2310=1151%:%
%:%2311=1152%:%
%:%2314=1153%:%
%:%2318=1153%:%
%:%2319=1153%:%
%:%2320=1154%:%
%:%2325=1154%:%
%:%2328=1155%:%
%:%2329=1156%:%
%:%2330=1156%:%
%:%2331=1157%:%
%:%2334=1158%:%
%:%2338=1158%:%
%:%2339=1158%:%
%:%2340=1159%:%
%:%2341=1159%:%
%:%2342=1160%:%
%:%2343=1161%:%
%:%2344=1162%:%
%:%2349=1162%:%
%:%2352=1163%:%
%:%2353=1164%:%
%:%2354=1164%:%
%:%2355=1165%:%
%:%2356=1166%:%
%:%2359=1167%:%
%:%2363=1167%:%
%:%2364=1167%:%
%:%2365=1168%:%
%:%2366=1168%:%
%:%2367=1169%:%
%:%2368=1169%:%
%:%2369=1170%:%
%:%2370=1170%:%
%:%2371=1170%:%
%:%2372=1171%:%
%:%2373=1171%:%
%:%2374=1172%:%
%:%2375=1172%:%
%:%2376=1173%:%
%:%2377=1173%:%
%:%2378=1174%:%
%:%2379=1174%:%
%:%2380=1175%:%
%:%2381=1175%:%
%:%2382=1176%:%
%:%2383=1176%:%
%:%2384=1177%:%
%:%2385=1177%:%
%:%2386=1178%:%
%:%2387=1178%:%
%:%2388=1179%:%
%:%2389=1179%:%
%:%2390=1180%:%
%:%2391=1180%:%
%:%2392=1181%:%
%:%2393=1181%:%
%:%2394=1182%:%
%:%2395=1183%:%
%:%2396=1184%:%
%:%2397=1184%:%
%:%2398=1185%:%
%:%2399=1185%:%
%:%2400=1186%:%
%:%2401=1186%:%
%:%2402=1187%:%
%:%2403=1188%:%
%:%2404=1188%:%
%:%2405=1188%:%
%:%2406=1189%:%
%:%2407=1189%:%
%:%2408=1190%:%
%:%2409=1190%:%
%:%2410=1191%:%
%:%2411=1191%:%
%:%2412=1192%:%
%:%2413=1192%:%
%:%2414=1193%:%
%:%2415=1193%:%
%:%2416=1194%:%
%:%2417=1195%:%
%:%2418=1196%:%
%:%2419=1197%:%
%:%2420=1198%:%
%:%2421=1198%:%
%:%2422=1199%:%
%:%2428=1199%:%
%:%2431=1200%:%
%:%2432=1201%:%
%:%2433=1201%:%
%:%2434=1202%:%
%:%2435=1203%:%
%:%2438=1204%:%
%:%2442=1204%:%
%:%2443=1204%:%
%:%2444=1205%:%
%:%2445=1205%:%
%:%2450=1205%:%
%:%2453=1206%:%
%:%2454=1207%:%
%:%2455=1207%:%
%:%2456=1208%:%
%:%2457=1209%:%
%:%2460=1210%:%
%:%2464=1210%:%
%:%2465=1210%:%
%:%2466=1211%:%
%:%2467=1211%:%
%:%2472=1211%:%
%:%2475=1212%:%
%:%2476=1213%:%
%:%2477=1213%:%
%:%2478=1214%:%
%:%2479=1215%:%
%:%2480=1216%:%
%:%2481=1217%:%
%:%2482=1218%:%
%:%2485=1219%:%
%:%2489=1219%:%
%:%2490=1219%:%
%:%2491=1220%:%
%:%2492=1220%:%
%:%2493=1221%:%
%:%2494=1221%:%
%:%2495=1222%:%
%:%2496=1223%:%
%:%2501=1223%:%
%:%2504=1224%:%
%:%2505=1225%:%
%:%2506=1225%:%
%:%2507=1226%:%
%:%2508=1227%:%
%:%2509=1228%:%
%:%2510=1229%:%
%:%2511=1230%:%
%:%2514=1231%:%
%:%2518=1231%:%
%:%2519=1231%:%
%:%2520=1232%:%
%:%2521=1232%:%
%:%2522=1233%:%
%:%2523=1233%:%
%:%2524=1234%:%
%:%2525=1235%:%
%:%2530=1235%:%
%:%2533=1236%:%
%:%2534=1237%:%
%:%2535=1237%:%
%:%2536=1238%:%
%:%2539=1239%:%
%:%2543=1239%:%
%:%2544=1239%:%
%:%2545=1240%:%
%:%2546=1240%:%
%:%2547=1241%:%
%:%2548=1242%:%
%:%2549=1243%:%
%:%2550=1244%:%
%:%2551=1245%:%
%:%2552=1246%:%
%:%2553=1247%:%
%:%2554=1248%:%
%:%2555=1249%:%
%:%2556=1249%:%
%:%2557=1250%:%
%:%2562=1250%:%
%:%2565=1251%:%
%:%2566=1252%:%
%:%2567=1252%:%
%:%2568=1253%:%
%:%2571=1254%:%
%:%2575=1254%:%
%:%2576=1254%:%
%:%2577=1255%:%
%:%2578=1255%:%
%:%2579=1256%:%
%:%2580=1256%:%
%:%2581=1257%:%
%:%2582=1258%:%
%:%2583=1259%:%
%:%2584=1260%:%
%:%2585=1260%:%
%:%2586=1261%:%
%:%2587=1262%:%
%:%2588=1263%:%
%:%2589=1264%:%
%:%2590=1264%:%
%:%2591=1265%:%
%:%2596=1265%:%
%:%2599=1266%:%
%:%2600=1267%:%
%:%2601=1267%:%
%:%2602=1268%:%
%:%2604=1270%:%
%:%2605=1271%:%
%:%2608=1272%:%
%:%2612=1272%:%
%:%2613=1272%:%
%:%2614=1273%:%
%:%2615=1273%:%
%:%2616=1274%:%
%:%2617=1274%:%
%:%2618=1275%:%
%:%2619=1276%:%
%:%2620=1276%:%
%:%2621=1277%:%
%:%2622=1277%:%
%:%2623=1278%:%
%:%2624=1278%:%
%:%2625=1279%:%
%:%2626=1279%:%
%:%2627=1280%:%
%:%2628=1280%:%
%:%2629=1281%:%
%:%2630=1281%:%
%:%2631=1282%:%
%:%2632=1282%:%
%:%2633=1283%:%
%:%2634=1283%:%
%:%2635=1284%:%
%:%2636=1284%:%
%:%2637=1285%:%
%:%2638=1285%:%
%:%2639=1286%:%
%:%2640=1286%:%
%:%2641=1287%:%
%:%2642=1287%:%
%:%2643=1288%:%
%:%2644=1289%:%
%:%2645=1290%:%
%:%2651=1290%:%
%:%2654=1291%:%
%:%2655=1292%:%
%:%2656=1292%:%
%:%2657=1293%:%
%:%2658=1294%:%
%:%2661=1295%:%
%:%2665=1295%:%
%:%2666=1295%:%
%:%2667=1296%:%
%:%2668=1296%:%
%:%2673=1296%:%
%:%2676=1297%:%
%:%2677=1298%:%
%:%2678=1298%:%
%:%2679=1299%:%
%:%2680=1300%:%
%:%2683=1301%:%
%:%2687=1301%:%
%:%2688=1301%:%
%:%2693=1301%:%
%:%2696=1302%:%
%:%2697=1303%:%
%:%2698=1303%:%
%:%2699=1304%:%
%:%2700=1305%:%
%:%2701=1306%:%
%:%2708=1307%:%
%:%2709=1307%:%
%:%2710=1308%:%
%:%2711=1308%:%
%:%2714=1311%:%
%:%2715=1312%:%
%:%2716=1312%:%
%:%2719=1315%:%
%:%2720=1316%:%
%:%2721=1316%:%
%:%2722=1317%:%
%:%2723=1318%:%
%:%2724=1318%:%
%:%2725=1319%:%
%:%2726=1320%:%
%:%2727=1320%:%
%:%2728=1321%:%
%:%2729=1322%:%
%:%2730=1322%:%
%:%2731=1323%:%
%:%2732=1324%:%
%:%2733=1324%:%
%:%2734=1325%:%
%:%2735=1325%:%
%:%2736=1326%:%
%:%2737=1327%:%
%:%2738=1327%:%
%:%2739=1328%:%
%:%2740=1328%:%
%:%2741=1329%:%
%:%2742=1329%:%
%:%2743=1330%:%
%:%2744=1330%:%
%:%2745=1331%:%
%:%2746=1331%:%
%:%2747=1331%:%
%:%2748=1332%:%
%:%2749=1332%:%
%:%2751=1334%:%
%:%2752=1335%:%
%:%2753=1335%:%
%:%2754=1336%:%
%:%2755=1336%:%
%:%2756=1337%:%
%:%2757=1338%:%
%:%2758=1338%:%
%:%2759=1339%:%
%:%2760=1339%:%
%:%2761=1340%:%
%:%2762=1341%:%
%:%2763=1341%:%
%:%2764=1342%:%
%:%2765=1342%:%
%:%2766=1343%:%
%:%2767=1343%:%
%:%2768=1343%:%
%:%2769=1344%:%
%:%2770=1344%:%
%:%2771=1345%:%
%:%2772=1345%:%
%:%2773=1346%:%
%:%2774=1346%:%
%:%2775=1347%:%
%:%2776=1347%:%
%:%2777=1347%:%
%:%2778=1348%:%
%:%2779=1348%:%
%:%2780=1349%:%
%:%2781=1349%:%
%:%2782=1350%:%
%:%2783=1350%:%
%:%2784=1351%:%
%:%2785=1351%:%
%:%2786=1352%:%
%:%2787=1352%:%
%:%2788=1353%:%
%:%2789=1353%:%
%:%2790=1354%:%
%:%2791=1354%:%
%:%2792=1355%:%
%:%2793=1355%:%
%:%2794=1356%:%
%:%2795=1356%:%
%:%2796=1357%:%
%:%2797=1357%:%
%:%2798=1358%:%
%:%2799=1358%:%
%:%2800=1359%:%
%:%2801=1359%:%
%:%2802=1360%:%
%:%2803=1360%:%
%:%2804=1361%:%
%:%2805=1361%:%
%:%2806=1361%:%
%:%2807=1362%:%
%:%2808=1362%:%
%:%2810=1364%:%
%:%2811=1365%:%
%:%2812=1365%:%
%:%2813=1366%:%
%:%2814=1366%:%
%:%2815=1367%:%
%:%2816=1368%:%
%:%2817=1368%:%
%:%2818=1369%:%
%:%2819=1369%:%
%:%2820=1370%:%
%:%2821=1371%:%
%:%2822=1371%:%
%:%2823=1372%:%
%:%2824=1372%:%
%:%2825=1373%:%
%:%2826=1373%:%
%:%2827=1373%:%
%:%2828=1374%:%
%:%2829=1374%:%
%:%2830=1375%:%
%:%2831=1375%:%
%:%2832=1376%:%
%:%2833=1376%:%
%:%2834=1377%:%
%:%2835=1377%:%
%:%2836=1377%:%
%:%2837=1378%:%
%:%2838=1378%:%
%:%2839=1379%:%
%:%2840=1379%:%
%:%2841=1380%:%
%:%2842=1380%:%
%:%2843=1381%:%
%:%2844=1381%:%
%:%2845=1382%:%
%:%2846=1382%:%
%:%2847=1383%:%
%:%2848=1383%:%
%:%2849=1384%:%
%:%2850=1384%:%
%:%2851=1385%:%
%:%2852=1385%:%
%:%2853=1386%:%
%:%2854=1386%:%
%:%2855=1387%:%
%:%2856=1387%:%
%:%2857=1388%:%
%:%2858=1388%:%
%:%2859=1389%:%
%:%2865=1389%:%
%:%2868=1390%:%
%:%2869=1391%:%
%:%2870=1391%:%
%:%2871=1392%:%
%:%2872=1393%:%
%:%2879=1394%:%
%:%2880=1394%:%
%:%2881=1395%:%
%:%2882=1395%:%
%:%2885=1398%:%
%:%2886=1399%:%
%:%2887=1399%:%
%:%2890=1402%:%
%:%2891=1403%:%
%:%2892=1403%:%
%:%2893=1404%:%
%:%2894=1405%:%
%:%2895=1405%:%
%:%2896=1406%:%
%:%2897=1407%:%
%:%2898=1407%:%
%:%2899=1408%:%
%:%2900=1409%:%
%:%2901=1409%:%
%:%2902=1410%:%
%:%2903=1411%:%
%:%2904=1411%:%
%:%2905=1412%:%
%:%2906=1412%:%
%:%2907=1413%:%
%:%2908=1414%:%
%:%2909=1414%:%
%:%2910=1415%:%
%:%2911=1415%:%
%:%2912=1416%:%
%:%2913=1416%:%
%:%2914=1417%:%
%:%2915=1417%:%
%:%2916=1418%:%
%:%2917=1418%:%
%:%2918=1418%:%
%:%2919=1419%:%
%:%2920=1419%:%
%:%2922=1421%:%
%:%2923=1422%:%
%:%2924=1422%:%
%:%2925=1423%:%
%:%2926=1423%:%
%:%2927=1424%:%
%:%2928=1425%:%
%:%2929=1425%:%
%:%2930=1426%:%
%:%2931=1426%:%
%:%2932=1427%:%
%:%2933=1428%:%
%:%2934=1428%:%
%:%2935=1429%:%
%:%2936=1429%:%
%:%2937=1430%:%
%:%2938=1430%:%
%:%2939=1430%:%
%:%2940=1431%:%
%:%2941=1431%:%
%:%2942=1432%:%
%:%2943=1432%:%
%:%2944=1433%:%
%:%2945=1433%:%
%:%2946=1434%:%
%:%2947=1434%:%
%:%2948=1434%:%
%:%2949=1435%:%
%:%2950=1435%:%
%:%2951=1436%:%
%:%2952=1436%:%
%:%2953=1437%:%
%:%2954=1437%:%
%:%2955=1438%:%
%:%2956=1438%:%
%:%2957=1439%:%
%:%2958=1439%:%
%:%2959=1440%:%
%:%2960=1440%:%
%:%2961=1441%:%
%:%2962=1441%:%
%:%2963=1442%:%
%:%2964=1442%:%
%:%2965=1443%:%
%:%2966=1443%:%
%:%2967=1444%:%
%:%2968=1444%:%
%:%2969=1445%:%
%:%2970=1445%:%
%:%2971=1446%:%
%:%2972=1446%:%
%:%2973=1447%:%
%:%2974=1447%:%
%:%2975=1448%:%
%:%2976=1448%:%
%:%2977=1448%:%
%:%2978=1449%:%
%:%2979=1449%:%
%:%2981=1451%:%
%:%2982=1452%:%
%:%2983=1452%:%
%:%2984=1453%:%
%:%2985=1453%:%
%:%2986=1454%:%
%:%2987=1455%:%
%:%2988=1455%:%
%:%2989=1456%:%
%:%2990=1456%:%
%:%2991=1457%:%
%:%2992=1458%:%
%:%2993=1458%:%
%:%2994=1459%:%
%:%2995=1459%:%
%:%2996=1460%:%
%:%2997=1460%:%
%:%2998=1460%:%
%:%2999=1461%:%
%:%3000=1461%:%
%:%3001=1462%:%
%:%3002=1462%:%
%:%3003=1463%:%
%:%3004=1463%:%
%:%3005=1464%:%
%:%3006=1464%:%
%:%3007=1464%:%
%:%3008=1465%:%
%:%3009=1465%:%
%:%3010=1466%:%
%:%3011=1466%:%
%:%3012=1467%:%
%:%3013=1467%:%
%:%3014=1468%:%
%:%3015=1468%:%
%:%3016=1469%:%
%:%3017=1469%:%
%:%3018=1470%:%
%:%3019=1470%:%
%:%3020=1471%:%
%:%3021=1471%:%
%:%3022=1472%:%
%:%3023=1472%:%
%:%3024=1473%:%
%:%3025=1473%:%
%:%3026=1474%:%
%:%3027=1474%:%
%:%3028=1475%:%
%:%3029=1475%:%
%:%3030=1476%:%
%:%3036=1476%:%
%:%3039=1477%:%
%:%3040=1478%:%
%:%3041=1478%:%
%:%3042=1479%:%
%:%3043=1480%:%
%:%3044=1480%:%
%:%3051=1481%:%
%:%3052=1481%:%
%:%3053=1482%:%
%:%3054=1482%:%
%:%3055=1483%:%
%:%3056=1483%:%
%:%3057=1484%:%
%:%3058=1485%:%
%:%3059=1485%:%
%:%3060=1486%:%
%:%3061=1486%:%
%:%3062=1487%:%
%:%3063=1487%:%
%:%3065=1489%:%
%:%3066=1490%:%
%:%3067=1491%:%
%:%3068=1491%:%
%:%3069=1492%:%
%:%3070=1492%:%
%:%3071=1493%:%
%:%3072=1493%:%
%:%3074=1495%:%
%:%3075=1496%:%
%:%3076=1497%:%
%:%3077=1497%:%
%:%3078=1498%:%
%:%3079=1499%:%
%:%3080=1499%:%
%:%3081=1500%:%
%:%3082=1500%:%
%:%3083=1501%:%
%:%3084=1502%:%
%:%3085=1503%:%
%:%3091=1503%:%
%:%3094=1504%:%
%:%3095=1505%:%
%:%3096=1505%:%
%:%3097=1506%:%
%:%3100=1507%:%
%:%3104=1507%:%
%:%3105=1507%:%
%:%3106=1508%:%
%:%3107=1508%:%
%:%3108=1509%:%
%:%3109=1509%:%
%:%3110=1510%:%
%:%3111=1510%:%
%:%3115=1514%:%
%:%3116=1515%:%
%:%3117=1516%:%
%:%3118=1516%:%
%:%3119=1517%:%
%:%3120=1518%:%
%:%3121=1518%:%
%:%3122=1519%:%
%:%3123=1519%:%
%:%3127=1523%:%
%:%3128=1524%:%
%:%3129=1525%:%
%:%3130=1525%:%
%:%3131=1526%:%
%:%3132=1527%:%
%:%3133=1527%:%
%:%3134=1528%:%
%:%3135=1528%:%
%:%3139=1532%:%
%:%3140=1533%:%
%:%3141=1534%:%
%:%3142=1534%:%
%:%3143=1535%:%
%:%3144=1536%:%
%:%3145=1537%:%
%:%3146=1537%:%
%:%3147=1538%:%
%:%3148=1538%:%
%:%3152=1542%:%
%:%3153=1543%:%
%:%3154=1544%:%
%:%3155=1544%:%
%:%3156=1545%:%
%:%3157=1546%:%
%:%3158=1547%:%
%:%3159=1547%:%
%:%3160=1548%:%
%:%3161=1548%:%
%:%3162=1549%:%
%:%3163=1549%:%
%:%3164=1550%:%
%:%3165=1551%:%
%:%3166=1552%:%
%:%3167=1553%:%
%:%3173=1553%:%
%:%3176=1554%:%
%:%3177=1555%:%
%:%3178=1555%:%
%:%3179=1556%:%
%:%3182=1557%:%
%:%3186=1557%:%
%:%3187=1557%:%
%:%3188=1558%:%
%:%3189=1558%:%
%:%3190=1559%:%
%:%3191=1559%:%
%:%3192=1560%:%
%:%3193=1560%:%
%:%3197=1564%:%
%:%3198=1565%:%
%:%3199=1566%:%
%:%3200=1566%:%
%:%3201=1567%:%
%:%3202=1568%:%
%:%3203=1568%:%
%:%3204=1569%:%
%:%3205=1569%:%
%:%3209=1573%:%
%:%3210=1574%:%
%:%3211=1575%:%
%:%3212=1575%:%
%:%3213=1576%:%
%:%3214=1576%:%
%:%3215=1577%:%
%:%3216=1577%:%
%:%3217=1578%:%
%:%3218=1578%:%
%:%3219=1579%:%
%:%3220=1579%:%
%:%3224=1583%:%
%:%3225=1584%:%
%:%3226=1585%:%
%:%3227=1585%:%
%:%3228=1586%:%
%:%3229=1586%:%
%:%3230=1587%:%
%:%3231=1587%:%
%:%3232=1588%:%
%:%3233=1588%:%
%:%3234=1589%:%
%:%3235=1589%:%
%:%3239=1593%:%
%:%3240=1594%:%
%:%3241=1595%:%
%:%3242=1595%:%
%:%3243=1596%:%
%:%3244=1596%:%
%:%3245=1597%:%
%:%3246=1597%:%
%:%3247=1598%:%
%:%3248=1598%:%
%:%3249=1599%:%
%:%3250=1599%:%
%:%3251=1600%:%
%:%3252=1600%:%
%:%3253=1601%:%
%:%3254=1602%:%
%:%3255=1603%:%
%:%3256=1604%:%
%:%3262=1604%:%
%:%3265=1605%:%
%:%3266=1606%:%
%:%3267=1606%:%
%:%3268=1607%:%
%:%3271=1608%:%
%:%3275=1608%:%
%:%3276=1608%:%
%:%3277=1609%:%
%:%3278=1610%:%
%:%3279=1611%:%
%:%3280=1611%:%
%:%3285=1611%:%
%:%3288=1612%:%
%:%3289=1613%:%
%:%3290=1613%:%
%:%3291=1614%:%
%:%3294=1615%:%
%:%3298=1615%:%
%:%3299=1615%:%
%:%3300=1616%:%
%:%3301=1617%:%
%:%3302=1618%:%
%:%3303=1618%:%
%:%3308=1618%:%
%:%3311=1619%:%
%:%3312=1620%:%
%:%3313=1620%:%
%:%3314=1621%:%
%:%3315=1622%:%
%:%3322=1623%:%
%:%3323=1623%:%
%:%3324=1624%:%
%:%3325=1624%:%
%:%3326=1625%:%
%:%3327=1625%:%
%:%3328=1625%:%
%:%3329=1626%:%
%:%3330=1626%:%
%:%3331=1627%:%
%:%3332=1627%:%
%:%3333=1628%:%
%:%3334=1628%:%
%:%3335=1629%:%
%:%3341=1629%:%
%:%3344=1630%:%
%:%3345=1631%:%
%:%3346=1631%:%
%:%3347=1632%:%
%:%3348=1633%:%
%:%3349=1634%:%
%:%3350=1635%:%
%:%3351=1636%:%
%:%3352=1637%:%
%:%3353=1638%:%
%:%3354=1639%:%
%:%3355=1640%:%
%:%3358=1641%:%
%:%3362=1641%:%
%:%3363=1641%:%
%:%3364=1641%:%
%:%3369=1641%:%
%:%3372=1642%:%
%:%3373=1643%:%
%:%3374=1643%:%
%:%3377=1644%:%
%:%3381=1644%:%
%:%3382=1644%:%
%:%3383=1645%:%
%:%3384=1645%:%
%:%3389=1645%:%
%:%3392=1646%:%
%:%3393=1647%:%
%:%3394=1647%:%
%:%3395=1648%:%
%:%3396=1649%:%
%:%3403=1650%:%
%:%3404=1650%:%
%:%3405=1651%:%
%:%3406=1651%:%
%:%3407=1652%:%
%:%3408=1652%:%
%:%3409=1652%:%
%:%3410=1653%:%
%:%3411=1653%:%
%:%3412=1654%:%
%:%3413=1654%:%
%:%3414=1655%:%
%:%3415=1655%:%
%:%3416=1656%:%
%:%3422=1656%:%
%:%3425=1657%:%
%:%3426=1658%:%
%:%3427=1658%:%
%:%3428=1659%:%
%:%3429=1660%:%
%:%3430=1661%:%
%:%3431=1662%:%
%:%3432=1663%:%
%:%3433=1664%:%
%:%3434=1665%:%
%:%3435=1666%:%
%:%3436=1667%:%
%:%3439=1668%:%
%:%3443=1668%:%
%:%3444=1668%:%
%:%3445=1668%:%
%:%3450=1668%:%
%:%3453=1669%:%
%:%3454=1670%:%
%:%3455=1670%:%
%:%3456=1671%:%
%:%3457=1672%:%
%:%3458=1673%:%
%:%3461=1674%:%
%:%3465=1674%:%
%:%3466=1674%:%
%:%3467=1675%:%
%:%3468=1675%:%
%:%3473=1675%:%
%:%3476=1676%:%
%:%3477=1677%:%
%:%3478=1677%:%
%:%3479=1678%:%
%:%3480=1679%:%
%:%3481=1680%:%
%:%3484=1681%:%
%:%3488=1681%:%
%:%3489=1681%:%
%:%3490=1682%:%
%:%3491=1682%:%
%:%3496=1682%:%
%:%3499=1683%:%
%:%3500=1684%:%
%:%3501=1684%:%
%:%3502=1685%:%
%:%3503=1685%:%
%:%3504=1686%:%
%:%3505=1686%:%
%:%3506=1687%:%
%:%3507=1687%:%
%:%3508=1688%:%
%:%3509=1688%:%
%:%3510=1689%:%
%:%3511=1689%:%
%:%3512=1690%:%
%:%3513=1690%:%
%:%3514=1691%:%
%:%3515=1691%:%
%:%3516=1692%:%
%:%3517=1693%:%
%:%3518=1693%:%
%:%3519=1694%:%
%:%3520=1694%:%
%:%3521=1695%:%
%:%3522=1696%:%
%:%3523=1696%:%
%:%3524=1697%:%
%:%3525=1697%:%
%:%3526=1698%:%
%:%3527=1699%:%
%:%3528=1699%:%
%:%3531=1700%:%
%:%3535=1700%:%
%:%3536=1700%:%
%:%3541=1700%:%
%:%3544=1701%:%
%:%3545=1702%:%
%:%3546=1702%:%
%:%3547=1703%:%
%:%3548=1704%:%
%:%3551=1705%:%
%:%3555=1705%:%
%:%3556=1705%:%
%:%3557=1706%:%
%:%3558=1706%:%
%:%3563=1706%:%
%:%3566=1707%:%
%:%3567=1708%:%
%:%3568=1708%:%
%:%3569=1709%:%
%:%3570=1710%:%
%:%3571=1711%:%
%:%3574=1712%:%
%:%3578=1712%:%
%:%3579=1712%:%
%:%3580=1713%:%
%:%3581=1713%:%
%:%3582=1714%:%
%:%3583=1714%:%
%:%3584=1715%:%
%:%3585=1715%:%
%:%3586=1716%:%
%:%3587=1716%:%
%:%3588=1716%:%
%:%3589=1717%:%
%:%3590=1717%:%
%:%3591=1718%:%
%:%3592=1718%:%
%:%3593=1719%:%
%:%3594=1719%:%
%:%3595=1720%:%
%:%3596=1720%:%
%:%3597=1721%:%
%:%3598=1721%:%
%:%3599=1722%:%
%:%3600=1722%:%
%:%3603=1725%:%
%:%3604=1726%:%
%:%3605=1726%:%
%:%3608=1729%:%
%:%3609=1730%:%
%:%3610=1730%:%
%:%3611=1731%:%
%:%3612=1732%:%
%:%3613=1732%:%
%:%3614=1733%:%
%:%3615=1734%:%
%:%3616=1734%:%
%:%3617=1735%:%
%:%3618=1736%:%
%:%3619=1736%:%
%:%3620=1737%:%
%:%3621=1738%:%
%:%3622=1738%:%
%:%3624=1740%:%
%:%3625=1741%:%
%:%3626=1741%:%
%:%3627=1742%:%
%:%3628=1743%:%
%:%3629=1743%:%
%:%3630=1744%:%
%:%3631=1744%:%
%:%3632=1745%:%
%:%3633=1745%:%
%:%3634=1746%:%
%:%3635=1746%:%
%:%3637=1748%:%
%:%3638=1749%:%
%:%3639=1749%:%
%:%3640=1750%:%
%:%3641=1750%:%
%:%3642=1751%:%
%:%3643=1752%:%
%:%3644=1752%:%
%:%3645=1753%:%
%:%3646=1753%:%
%:%3647=1754%:%
%:%3648=1755%:%
%:%3649=1755%:%
%:%3650=1756%:%
%:%3651=1756%:%
%:%3652=1757%:%
%:%3653=1757%:%
%:%3654=1758%:%
%:%3655=1758%:%
%:%3656=1759%:%
%:%3657=1759%:%
%:%3658=1760%:%
%:%3659=1761%:%
%:%3660=1762%:%
%:%3661=1763%:%
%:%3662=1763%:%
%:%3663=1764%:%
%:%3664=1764%:%
%:%3665=1765%:%
%:%3666=1765%:%
%:%3667=1766%:%
%:%3668=1766%:%
%:%3669=1767%:%
%:%3670=1767%:%
%:%3671=1767%:%
%:%3672=1768%:%
%:%3673=1768%:%
%:%3674=1768%:%
%:%3675=1769%:%
%:%3676=1769%:%
%:%3677=1769%:%
%:%3678=1770%:%
%:%3679=1770%:%
%:%3680=1771%:%
%:%3681=1772%:%
%:%3682=1772%:%
%:%3683=1773%:%
%:%3684=1773%:%
%:%3685=1774%:%
%:%3686=1774%:%
%:%3687=1775%:%
%:%3688=1775%:%
%:%3690=1777%:%
%:%3691=1778%:%
%:%3692=1778%:%
%:%3693=1779%:%
%:%3694=1779%:%
%:%3695=1780%:%
%:%3696=1781%:%
%:%3697=1781%:%
%:%3698=1782%:%
%:%3699=1783%:%
%:%3700=1783%:%
%:%3701=1784%:%
%:%3702=1785%:%
%:%3703=1785%:%
%:%3704=1786%:%
%:%3705=1786%:%
%:%3706=1787%:%
%:%3707=1787%:%
%:%3708=1788%:%
%:%3709=1788%:%
%:%3710=1789%:%
%:%3711=1789%:%
%:%3712=1790%:%
%:%3713=1791%:%
%:%3714=1792%:%
%:%3715=1793%:%
%:%3716=1793%:%
%:%3717=1794%:%
%:%3718=1794%:%
%:%3719=1795%:%
%:%3720=1795%:%
%:%3721=1796%:%
%:%3722=1796%:%
%:%3723=1797%:%
%:%3724=1797%:%
%:%3725=1797%:%
%:%3726=1798%:%
%:%3727=1798%:%
%:%3728=1798%:%
%:%3729=1799%:%
%:%3730=1799%:%
%:%3731=1799%:%
%:%3732=1800%:%
%:%3733=1800%:%
%:%3734=1801%:%
%:%3735=1802%:%
%:%3736=1802%:%
%:%3737=1803%:%
%:%3738=1803%:%
%:%3739=1804%:%
%:%3745=1804%:%
%:%3748=1805%:%
%:%3749=1806%:%
%:%3750=1806%:%
%:%3751=1807%:%
%:%3752=1808%:%
%:%3753=1809%:%
%:%3756=1810%:%
%:%3760=1810%:%
%:%3761=1810%:%
%:%3762=1811%:%
%:%3763=1811%:%
%:%3764=1812%:%
%:%3765=1812%:%
%:%3766=1813%:%
%:%3767=1813%:%
%:%3768=1814%:%
%:%3769=1814%:%
%:%3770=1814%:%
%:%3771=1815%:%
%:%3772=1815%:%
%:%3773=1816%:%
%:%3774=1816%:%
%:%3775=1817%:%
%:%3776=1817%:%
%:%3777=1818%:%
%:%3778=1818%:%
%:%3779=1819%:%
%:%3780=1819%:%
%:%3781=1820%:%
%:%3782=1820%:%
%:%3785=1823%:%
%:%3786=1824%:%
%:%3787=1824%:%
%:%3790=1827%:%
%:%3791=1828%:%
%:%3792=1828%:%
%:%3793=1829%:%
%:%3794=1830%:%
%:%3795=1830%:%
%:%3796=1831%:%
%:%3797=1832%:%
%:%3798=1832%:%
%:%3799=1833%:%
%:%3800=1834%:%
%:%3801=1834%:%
%:%3802=1835%:%
%:%3803=1836%:%
%:%3804=1836%:%
%:%3805=1837%:%
%:%3806=1838%:%
%:%3807=1838%:%
%:%3808=1839%:%
%:%3809=1840%:%
%:%3810=1840%:%
%:%3811=1841%:%
%:%3812=1841%:%
%:%3813=1842%:%
%:%3814=1842%:%
%:%3815=1843%:%
%:%3816=1843%:%
%:%3818=1845%:%
%:%3819=1846%:%
%:%3820=1846%:%
%:%3821=1847%:%
%:%3822=1847%:%
%:%3823=1848%:%
%:%3824=1849%:%
%:%3825=1849%:%
%:%3826=1850%:%
%:%3827=1850%:%
%:%3828=1851%:%
%:%3829=1852%:%
%:%3830=1852%:%
%:%3831=1853%:%
%:%3832=1853%:%
%:%3833=1854%:%
%:%3834=1854%:%
%:%3835=1855%:%
%:%3836=1855%:%
%:%3837=1856%:%
%:%3838=1856%:%
%:%3839=1857%:%
%:%3840=1858%:%
%:%3841=1859%:%
%:%3842=1860%:%
%:%3843=1860%:%
%:%3844=1861%:%
%:%3845=1861%:%
%:%3846=1862%:%
%:%3847=1862%:%
%:%3848=1863%:%
%:%3849=1863%:%
%:%3850=1864%:%
%:%3851=1864%:%
%:%3852=1864%:%
%:%3853=1865%:%
%:%3854=1865%:%
%:%3855=1865%:%
%:%3856=1866%:%
%:%3857=1866%:%
%:%3858=1866%:%
%:%3859=1867%:%
%:%3860=1867%:%
%:%3861=1868%:%
%:%3862=1869%:%
%:%3863=1869%:%
%:%3864=1870%:%
%:%3865=1870%:%
%:%3866=1871%:%
%:%3867=1871%:%
%:%3868=1872%:%
%:%3869=1872%:%
%:%3871=1874%:%
%:%3872=1875%:%
%:%3873=1875%:%
%:%3874=1876%:%
%:%3875=1876%:%
%:%3876=1877%:%
%:%3877=1878%:%
%:%3878=1878%:%
%:%3879=1879%:%
%:%3880=1880%:%
%:%3881=1880%:%
%:%3882=1881%:%
%:%3883=1882%:%
%:%3884=1882%:%
%:%3885=1883%:%
%:%3886=1883%:%
%:%3887=1884%:%
%:%3888=1884%:%
%:%3889=1885%:%
%:%3890=1885%:%
%:%3891=1886%:%
%:%3892=1886%:%
%:%3893=1887%:%
%:%3894=1888%:%
%:%3895=1889%:%
%:%3896=1890%:%
%:%3897=1890%:%
%:%3898=1891%:%
%:%3899=1891%:%
%:%3900=1892%:%
%:%3901=1892%:%
%:%3902=1893%:%
%:%3903=1893%:%
%:%3904=1894%:%
%:%3905=1894%:%
%:%3906=1894%:%
%:%3907=1895%:%
%:%3908=1895%:%
%:%3909=1895%:%
%:%3910=1896%:%
%:%3911=1896%:%
%:%3912=1896%:%
%:%3913=1897%:%
%:%3914=1897%:%
%:%3915=1898%:%
%:%3916=1899%:%
%:%3917=1899%:%
%:%3918=1900%:%
%:%3919=1900%:%
%:%3920=1901%:%
%:%3926=1901%:%
%:%3929=1902%:%
%:%3930=1903%:%
%:%3931=1903%:%
%:%3932=1904%:%
%:%3933=1905%:%
%:%3936=1906%:%
%:%3940=1906%:%
%:%3941=1906%:%
%:%3942=1906%:%
%:%3947=1906%:%
%:%3950=1907%:%
%:%3951=1908%:%
%:%3952=1908%:%
%:%3953=1909%:%
%:%3954=1910%:%
%:%3957=1911%:%
%:%3961=1911%:%
%:%3962=1911%:%
%:%3963=1911%:%
%:%3968=1911%:%
%:%3971=1912%:%
%:%3972=1913%:%
%:%3973=1913%:%
%:%3974=1914%:%
%:%3975=1915%:%
%:%3976=1915%:%
%:%3977=1916%:%
%:%3978=1917%:%
%:%3979=1917%:%
%:%3980=1918%:%
%:%3981=1919%:%
%:%3982=1920%:%
%:%3984=1922%:%
%:%3987=1923%:%
%:%3991=1923%:%
%:%3992=1923%:%
%:%3997=1923%:%
%:%4000=1924%:%
%:%4001=1925%:%
%:%4002=1925%:%
%:%4003=1926%:%
%:%4005=1928%:%
%:%4008=1929%:%
%:%4012=1929%:%
%:%4013=1929%:%
%:%4014=1930%:%
%:%4019=1930%:%
%:%4022=1931%:%
%:%4023=1932%:%
%:%4024=1932%:%
%:%4025=1933%:%
%:%4026=1934%:%
%:%4027=1935%:%
%:%4029=1937%:%
%:%4032=1938%:%
%:%4036=1938%:%
%:%4037=1938%:%
%:%4042=1938%:%
%:%4045=1939%:%
%:%4046=1940%:%
%:%4047=1940%:%
%:%4048=1941%:%
%:%4050=1943%:%
%:%4053=1944%:%
%:%4057=1944%:%
%:%4058=1944%:%
%:%4059=1945%:%
%:%4064=1945%:%
%:%4067=1946%:%
%:%4068=1947%:%
%:%4069=1947%:%
%:%4070=1948%:%
%:%4071=1949%:%
%:%4072=1950%:%
%:%4073=1951%:%
%:%4074=1952%:%
%:%4075=1953%:%
%:%4076=1954%:%
%:%4077=1955%:%
%:%4078=1956%:%
%:%4079=1957%:%
%:%4080=1958%:%
%:%4081=1959%:%
%:%4082=1960%:%
%:%4083=1961%:%
%:%4084=1962%:%
%:%4085=1963%:%
%:%4086=1964%:%
%:%4087=1965%:%
%:%4088=1966%:%
%:%4089=1967%:%
%:%4090=1968%:%
%:%4091=1969%:%
%:%4092=1970%:%
%:%4093=1971%:%
%:%4094=1972%:%
%:%4095=1973%:%
%:%4096=1974%:%
%:%4097=1975%:%
%:%4098=1976%:%
%:%4099=1977%:%
%:%4100=1978%:%
%:%4101=1979%:%
%:%4102=1980%:%
%:%4103=1981%:%
%:%4104=1982%:%
%:%4105=1983%:%
%:%4106=1984%:%
%:%4107=1985%:%
%:%4108=1986%:%
%:%4109=1987%:%
%:%4110=1988%:%
%:%4111=1989%:%
%:%4112=1990%:%
%:%4113=1991%:%
%:%4114=1992%:%
%:%4115=1993%:%
%:%4116=1994%:%
%:%4117=1995%:%
%:%4118=1996%:%
%:%4119=1997%:%
%:%4120=1998%:%
%:%4121=1999%:%
%:%4122=2000%:%
%:%4123=2001%:%
%:%4124=2002%:%
%:%4125=2003%:%
%:%4126=2004%:%
%:%4127=2005%:%
%:%4128=2006%:%
%:%4129=2007%:%
%:%4130=2008%:%
%:%4131=2009%:%
%:%4134=2010%:%
%:%4138=2010%:%
%:%4139=2010%:%
%:%4144=2010%:%
%:%4147=2011%:%
%:%4148=2012%:%
%:%4149=2012%:%
%:%4150=2013%:%
%:%4151=2014%:%
%:%4152=2014%:%
%:%4153=2015%:%
%:%4154=2015%:%
%:%4155=2016%:%
%:%4156=2016%:%
%:%4157=2017%:%
%:%4158=2017%:%
%:%4159=2018%:%
%:%4160=2018%:%
%:%4161=2019%:%
%:%4162=2019%:%
%:%4163=2020%:%
%:%4164=2020%:%
%:%4165=2021%:%
%:%4166=2021%:%
%:%4167=2022%:%
%:%4168=2022%:%
%:%4169=2023%:%
%:%4170=2023%:%
%:%4171=2024%:%
%:%4172=2024%:%
%:%4173=2025%:%
%:%4174=2025%:%
%:%4175=2026%:%
%:%4176=2026%:%
%:%4177=2027%:%
%:%4178=2027%:%
%:%4179=2028%:%
%:%4180=2028%:%
%:%4181=2029%:%
%:%4182=2030%:%
%:%4183=2030%:%
%:%4184=2031%:%
%:%4185=2031%:%
%:%4186=2032%:%
%:%4187=2032%:%
%:%4188=2033%:%
%:%4189=2033%:%
%:%4190=2034%:%
%:%4191=2035%:%
%:%4192=2035%:%
%:%4193=2036%:%
%:%4194=2036%:%
%:%4195=2037%:%
%:%4196=2037%:%
%:%4197=2038%:%
%:%4198=2038%:%
%:%4199=2039%:%
%:%4200=2039%:%
%:%4201=2040%:%
%:%4202=2040%:%
%:%4203=2041%:%
%:%4204=2041%:%
%:%4205=2042%:%
%:%4206=2042%:%
%:%4207=2043%:%
%:%4208=2043%:%
%:%4209=2044%:%
%:%4210=2044%:%
%:%4211=2045%:%
%:%4212=2045%:%
%:%4213=2046%:%
%:%4214=2047%:%
%:%4215=2047%:%
%:%4216=2048%:%
%:%4217=2048%:%
%:%4218=2049%:%
%:%4219=2050%:%
%:%4220=2050%:%
%:%4221=2051%:%
%:%4222=2052%:%
%:%4223=2053%:%
%:%4224=2054%:%
%:%4227=2055%:%
%:%4231=2055%:%
%:%4232=2055%:%
%:%4233=2056%:%
%:%4234=2057%:%
%:%4235=2057%:%
%:%4236=2058%:%
%:%4241=2058%:%
%:%4244=2059%:%
%:%4245=2060%:%
%:%4246=2060%:%
%:%4247=2061%:%
%:%4248=2062%:%
%:%4249=2063%:%
%:%4252=2064%:%
%:%4256=2064%:%
%:%4257=2064%:%
%:%4258=2065%:%
%:%4259=2066%:%
%:%4260=2066%:%
%:%4261=2067%:%
%:%4266=2067%:%
%:%4269=2068%:%
%:%4270=2069%:%
%:%4271=2069%:%
%:%4272=2070%:%
%:%4273=2071%:%
%:%4274=2072%:%
%:%4277=2073%:%
%:%4281=2073%:%
%:%4282=2073%:%
%:%4283=2074%:%
%:%4284=2075%:%
%:%4285=2075%:%
%:%4286=2076%:%
%:%4291=2076%:%
%:%4294=2077%:%
%:%4295=2078%:%
%:%4296=2078%:%
%:%4297=2079%:%
%:%4298=2080%:%
%:%4299=2081%:%
%:%4300=2082%:%
%:%4303=2083%:%
%:%4307=2083%:%
%:%4308=2083%:%
%:%4309=2084%:%
%:%4310=2085%:%
%:%4311=2085%:%
%:%4312=2086%:%
%:%4317=2086%:%
%:%4320=2087%:%
%:%4321=2088%:%
%:%4322=2088%:%
%:%4323=2089%:%
%:%4324=2090%:%
%:%4325=2091%:%
%:%4326=2092%:%
%:%4328=2094%:%
%:%4329=2095%:%
%:%4332=2096%:%
%:%4336=2096%:%
%:%4337=2096%:%
%:%4338=2097%:%
%:%4339=2097%:%
%:%4340=2098%:%
%:%4341=2098%:%
%:%4342=2099%:%
%:%4343=2099%:%
%:%4344=2099%:%
%:%4345=2100%:%
%:%4346=2100%:%
%:%4347=2100%:%
%:%4348=2101%:%
%:%4349=2101%:%
%:%4350=2102%:%
%:%4351=2102%:%
%:%4352=2103%:%
%:%4353=2103%:%
%:%4354=2103%:%
%:%4355=2104%:%
%:%4356=2104%:%
%:%4357=2104%:%
%:%4358=2105%:%
%:%4359=2105%:%
%:%4360=2106%:%
%:%4361=2106%:%
%:%4362=2107%:%
%:%4363=2108%:%
%:%4364=2108%:%
%:%4365=2109%:%
%:%4366=2109%:%
%:%4367=2110%:%
%:%4368=2110%:%
%:%4369=2111%:%
%:%4370=2111%:%
%:%4371=2112%:%
%:%4372=2112%:%
%:%4373=2113%:%
%:%4374=2113%:%
%:%4375=2114%:%
%:%4376=2115%:%
%:%4377=2116%:%
%:%4378=2117%:%
%:%4379=2118%:%
%:%4380=2118%:%
%:%4383=2121%:%
%:%4384=2122%:%
%:%4385=2122%:%
%:%4386=2123%:%
%:%4387=2123%:%
%:%4388=2124%:%
%:%4389=2125%:%
%:%4390=2126%:%
%:%4391=2127%:%
%:%4392=2127%:%
%:%4393=2127%:%
%:%4394=2128%:%
%:%4395=2128%:%
%:%4396=2128%:%
%:%4397=2129%:%
%:%4398=2129%:%
%:%4399=2129%:%
%:%4400=2130%:%
%:%4401=2130%:%
%:%4402=2131%:%
%:%4403=2131%:%
%:%4404=2132%:%
%:%4405=2133%:%
%:%4406=2134%:%
%:%4407=2134%:%
%:%4408=2134%:%
%:%4409=2134%:%
%:%4410=2135%:%
%:%4416=2135%:%
%:%4419=2136%:%
%:%4420=2137%:%
%:%4421=2137%:%
%:%4422=2138%:%
%:%4423=2139%:%
%:%4424=2140%:%
%:%4425=2141%:%
%:%4429=2145%:%
%:%4436=2146%:%
%:%4437=2146%:%
%:%4438=2147%:%
%:%4439=2147%:%
%:%4440=2148%:%
%:%4441=2149%:%
%:%4442=2149%:%
%:%4443=2150%:%
%:%4444=2150%:%
%:%4445=2151%:%
%:%4446=2151%:%
%:%4447=2152%:%
%:%4448=2152%:%
%:%4449=2153%:%
%:%4450=2153%:%
%:%4451=2154%:%
%:%4452=2154%:%
%:%4453=2154%:%
%:%4454=2155%:%
%:%4455=2155%:%
%:%4456=2155%:%
%:%4457=2156%:%
%:%4458=2156%:%
%:%4459=2157%:%
%:%4460=2157%:%
%:%4461=2158%:%
%:%4462=2158%:%
%:%4463=2159%:%
%:%4464=2159%:%
%:%4465=2159%:%
%:%4466=2160%:%
%:%4467=2160%:%
%:%4468=2161%:%
%:%4469=2162%:%
%:%4470=2162%:%
%:%4471=2162%:%
%:%4473=2164%:%
%:%4474=2165%:%
%:%4475=2165%:%
%:%4476=2166%:%
%:%4477=2166%:%
%:%4478=2167%:%
%:%4479=2167%:%
%:%4480=2167%:%
%:%4481=2168%:%
%:%4482=2169%:%
%:%4483=2169%:%
%:%4484=2170%:%
%:%4485=2171%:%
%:%4486=2171%:%
%:%4487=2172%:%
%:%4488=2172%:%
%:%4489=2172%:%
%:%4490=2172%:%
%:%4491=2173%:%
%:%4492=2173%:%
%:%4493=2174%:%
%:%4494=2174%:%
%:%4495=2175%:%
%:%4496=2175%:%
%:%4497=2176%:%
%:%4498=2176%:%
%:%4499=2177%:%
%:%4500=2177%:%
%:%4501=2178%:%
%:%4502=2179%:%
%:%4503=2179%:%
%:%4504=2180%:%
%:%4505=2180%:%
%:%4506=2180%:%
%:%4507=2181%:%
%:%4508=2182%:%
%:%4509=2182%:%
%:%4510=2182%:%
%:%4511=2183%:%
%:%4512=2183%:%
%:%4513=2183%:%
%:%4516=2186%:%
%:%4517=2187%:%
%:%4518=2187%:%
%:%4519=2187%:%
%:%4520=2188%:%
%:%4521=2188%:%
%:%4522=2188%:%
%:%4523=2189%:%
%:%4524=2190%:%
%:%4525=2190%:%
%:%4526=2191%:%
%:%4527=2191%:%
%:%4528=2192%:%
%:%4529=2192%:%
%:%4530=2192%:%
%:%4531=2193%:%
%:%4532=2194%:%
%:%4533=2194%:%
%:%4534=2195%:%
%:%4535=2195%:%
%:%4536=2195%:%
%:%4537=2196%:%
%:%4538=2196%:%
%:%4539=2197%:%
%:%4540=2198%:%
%:%4541=2198%:%
%:%4542=2199%:%
%:%4543=2199%:%
%:%4544=2199%:%
%:%4545=2200%:%
%:%4546=2200%:%
%:%4547=2201%:%
%:%4548=2202%:%
%:%4549=2203%:%
%:%4550=2203%:%
%:%4551=2204%:%
%:%4552=2204%:%
%:%4553=2204%:%
%:%4554=2205%:%
%:%4555=2205%:%
%:%4556=2206%:%
%:%4557=2206%:%
%:%4558=2207%:%
%:%4564=2207%:%
%:%4567=2208%:%
%:%4568=2209%:%
%:%4569=2209%:%
%:%4570=2210%:%
%:%4571=2211%:%
%:%4578=2212%:%
%:%4579=2212%:%
%:%4580=2213%:%
%:%4581=2213%:%
%:%4582=2214%:%
%:%4583=2214%:%
%:%4584=2215%:%
%:%4585=2216%:%
%:%4586=2216%:%
%:%4587=2217%:%
%:%4588=2217%:%
%:%4589=2218%:%
%:%4590=2218%:%
%:%4591=2219%:%
%:%4592=2219%:%
%:%4593=2220%:%
%:%4594=2220%:%
%:%4595=2221%:%
%:%4596=2221%:%
%:%4597=2221%:%
%:%4598=2222%:%
%:%4599=2222%:%
%:%4600=2223%:%
%:%4603=2226%:%
%:%4604=2227%:%
%:%4607=2230%:%
%:%4608=2231%:%
%:%4609=2231%:%
%:%4610=2231%:%
%:%4611=2232%:%
%:%4612=2232%:%
%:%4613=2233%:%
%:%4614=2234%:%
%:%4615=2234%:%
%:%4617=2236%:%
%:%4618=2237%:%
%:%4619=2237%:%
%:%4620=2238%:%
%:%4621=2238%:%
%:%4622=2239%:%
%:%4623=2239%:%
%:%4624=2240%:%
%:%4625=2240%:%
%:%4626=2241%:%
%:%4627=2241%:%
%:%4628=2242%:%
%:%4629=2242%:%
%:%4630=2243%:%
%:%4631=2243%:%
%:%4632=2244%:%
%:%4633=2244%:%
%:%4634=2245%:%
%:%4635=2246%:%
%:%4636=2246%:%
%:%4637=2247%:%
%:%4638=2247%:%
%:%4639=2247%:%
%:%4640=2248%:%
%:%4641=2248%:%
%:%4642=2249%:%
%:%4643=2249%:%
%:%4645=2251%:%
%:%4646=2252%:%
%:%4647=2253%:%
%:%4648=2253%:%
%:%4649=2254%:%
%:%4650=2254%:%
%:%4651=2255%:%
%:%4652=2255%:%
%:%4653=2256%:%
%:%4654=2256%:%
%:%4655=2257%:%
%:%4656=2257%:%
%:%4657=2258%:%
%:%4658=2258%:%
%:%4659=2259%:%
%:%4660=2259%:%
%:%4661=2260%:%
%:%4662=2260%:%
%:%4663=2261%:%
%:%4664=2261%:%
%:%4665=2262%:%
%:%4666=2262%:%
%:%4667=2262%:%
%:%4668=2263%:%
%:%4669=2263%:%
%:%4670=2263%:%
%:%4671=2264%:%
%:%4672=2264%:%
%:%4673=2264%:%
%:%4674=2265%:%
%:%4675=2265%:%
%:%4676=2266%:%
%:%4677=2266%:%
%:%4678=2267%:%
%:%4679=2267%:%
%:%4680=2267%:%
%:%4681=2268%:%
%:%4682=2268%:%
%:%4683=2269%:%
%:%4684=2269%:%
%:%4685=2270%:%
%:%4686=2270%:%
%:%4687=2271%:%
%:%4688=2271%:%
%:%4689=2272%:%
%:%4690=2272%:%
%:%4691=2273%:%
%:%4692=2273%:%
%:%4693=2274%:%
%:%4694=2274%:%
%:%4695=2274%:%
%:%4696=2275%:%
%:%4697=2275%:%
%:%4698=2276%:%
%:%4699=2276%:%
%:%4700=2277%:%
%:%4701=2277%:%
%:%4702=2278%:%
%:%4703=2278%:%
%:%4704=2279%:%
%:%4705=2279%:%
%:%4706=2280%:%
%:%4707=2280%:%
%:%4708=2281%:%
%:%4709=2281%:%
%:%4710=2282%:%
%:%4711=2282%:%
%:%4712=2283%:%
%:%4713=2283%:%
%:%4714=2284%:%
%:%4715=2285%:%
%:%4716=2285%:%
%:%4717=2286%:%
%:%4718=2286%:%
%:%4719=2287%:%
%:%4720=2287%:%
%:%4722=2289%:%
%:%4723=2289%:%
%:%4724=2290%:%
%:%4725=2290%:%
%:%4726=2291%:%
%:%4727=2291%:%
%:%4728=2292%:%
%:%4729=2292%:%
%:%4730=2293%:%
%:%4731=2293%:%
%:%4732=2294%:%
%:%4733=2294%:%
%:%4734=2294%:%
%:%4735=2295%:%
%:%4736=2295%:%
%:%4737=2296%:%
%:%4738=2296%:%
%:%4739=2297%:%
%:%4740=2297%:%
%:%4741=2297%:%
%:%4742=2298%:%
%:%4743=2298%:%
%:%4744=2299%:%
%:%4745=2299%:%
%:%4746=2300%:%
%:%4747=2300%:%
%:%4748=2301%:%
%:%4749=2302%:%
%:%4750=2302%:%
%:%4751=2303%:%
%:%4752=2303%:%
%:%4753=2304%:%
%:%4754=2304%:%
%:%4755=2304%:%
%:%4756=2305%:%
%:%4757=2305%:%
%:%4758=2306%:%
%:%4759=2306%:%
%:%4760=2307%:%
%:%4761=2307%:%
%:%4762=2308%:%
%:%4763=2308%:%
%:%4764=2309%:%
%:%4765=2310%:%
%:%4766=2310%:%
%:%4767=2311%:%
%:%4768=2311%:%
%:%4769=2311%:%
%:%4770=2312%:%
%:%4771=2312%:%
%:%4772=2312%:%
%:%4773=2313%:%
%:%4779=2313%:%
%:%4782=2314%:%
%:%4783=2315%:%
%:%4784=2316%:%
%:%4785=2316%:%
%:%4786=2317%:%
%:%4789=2320%:%
%:%4796=2321%:%
%:%4797=2321%:%
%:%4798=2322%:%
%:%4799=2322%:%
%:%4800=2323%:%
%:%4801=2323%:%
%:%4802=2324%:%
%:%4803=2324%:%
%:%4804=2325%:%
%:%4805=2325%:%
%:%4806=2325%:%
%:%4807=2326%:%
%:%4808=2326%:%
%:%4809=2327%:%
%:%4810=2327%:%
%:%4812=2329%:%
%:%4813=2330%:%
%:%4814=2330%:%
%:%4815=2331%:%
%:%4816=2331%:%
%:%4817=2332%:%
%:%4818=2332%:%
%:%4819=2333%:%
%:%4820=2333%:%
%:%4821=2334%:%
%:%4822=2334%:%
%:%4823=2335%:%
%:%4824=2336%:%
%:%4825=2337%:%
%:%4826=2337%:%
%:%4827=2338%:%
%:%4828=2338%:%
%:%4829=2338%:%
%:%4830=2339%:%
%:%4831=2339%:%
%:%4832=2339%:%
%:%4833=2340%:%
%:%4834=2340%:%
%:%4835=2341%:%
%:%4836=2341%:%
%:%4837=2342%:%
%:%4838=2342%:%
%:%4839=2343%:%
%:%4840=2343%:%
%:%4841=2344%:%
%:%4842=2344%:%
%:%4844=2346%:%
%:%4845=2347%:%
%:%4846=2347%:%
%:%4847=2348%:%
%:%4848=2348%:%
%:%4849=2349%:%
%:%4850=2349%:%
%:%4851=2350%:%
%:%4852=2350%:%
%:%4853=2351%:%
%:%4854=2351%:%
%:%4855=2352%:%
%:%4856=2353%:%
%:%4857=2354%:%
%:%4858=2355%:%
%:%4859=2356%:%
%:%4860=2356%:%
%:%4861=2356%:%
%:%4862=2357%:%
%:%4863=2357%:%
%:%4864=2358%:%
%:%4865=2359%:%
%:%4866=2360%:%
%:%4867=2360%:%
%:%4868=2361%:%
%:%4869=2362%:%
%:%4870=2362%:%
%:%4871=2363%:%
%:%4872=2363%:%
%:%4873=2364%:%
%:%4874=2365%:%
%:%4875=2365%:%
%:%4876=2365%:%
%:%4877=2366%:%
%:%4878=2366%:%
%:%4879=2367%:%
%:%4880=2368%:%
%:%4881=2368%:%
%:%4882=2369%:%
%:%4883=2369%:%
%:%4884=2369%:%
%:%4885=2370%:%
%:%4886=2370%:%
%:%4887=2371%:%
%:%4888=2372%:%
%:%4889=2372%:%
%:%4890=2372%:%
%:%4891=2373%:%
%:%4892=2373%:%
%:%4893=2374%:%
%:%4894=2374%:%
%:%4895=2375%:%
%:%4896=2375%:%
%:%4897=2376%:%
%:%4898=2376%:%
%:%4899=2377%:%
%:%4900=2377%:%
%:%4901=2378%:%
%:%4902=2378%:%
%:%4903=2379%:%
%:%4904=2380%:%
%:%4905=2381%:%
%:%4906=2382%:%
%:%4907=2382%:%
%:%4908=2383%:%
%:%4909=2383%:%
%:%4910=2384%:%
%:%4911=2384%:%
%:%4912=2385%:%
%:%4913=2386%:%
%:%4914=2387%:%
%:%4915=2387%:%
%:%4916=2388%:%
%:%4917=2388%:%
%:%4918=2389%:%
%:%4919=2390%:%
%:%4920=2390%:%
%:%4921=2391%:%
%:%4922=2391%:%
%:%4923=2392%:%
%:%4924=2392%:%
%:%4925=2393%:%
%:%4926=2394%:%
%:%4927=2395%:%
%:%4928=2396%:%
%:%4929=2396%:%
%:%4930=2397%:%
%:%4931=2397%:%
%:%4932=2397%:%
%:%4933=2398%:%
%:%4934=2398%:%
%:%4936=2400%:%
%:%4937=2401%:%
%:%4938=2401%:%
%:%4939=2402%:%
%:%4940=2402%:%
%:%4941=2403%:%
%:%4942=2404%:%
%:%4943=2405%:%
%:%4944=2405%:%
%:%4945=2406%:%
%:%4946=2406%:%
%:%4947=2407%:%
%:%4948=2408%:%
%:%4949=2408%:%
%:%4957=2416%:%
%:%4958=2417%:%
%:%4959=2417%:%
%:%4960=2418%:%
%:%4961=2418%:%
%:%4962=2419%:%
%:%4965=2422%:%
%:%4966=2423%:%
%:%4969=2426%:%
%:%4970=2427%:%
%:%4971=2427%:%
%:%4972=2428%:%
%:%4973=2428%:%
%:%4974=2429%:%
%:%4975=2430%:%
%:%4976=2430%:%
%:%4977=2431%:%
%:%4978=2431%:%
%:%4979=2432%:%
%:%4980=2432%:%
%:%4981=2433%:%
%:%4982=2434%:%
%:%4983=2434%:%
%:%4984=2435%:%
%:%4985=2435%:%
%:%4986=2435%:%
%:%4987=2436%:%
%:%4988=2437%:%
%:%4989=2437%:%
%:%4990=2438%:%
%:%4991=2438%:%
%:%4992=2439%:%
%:%4993=2439%:%
%:%4994=2440%:%
%:%4995=2440%:%
%:%4996=2441%:%
%:%4997=2441%:%
%:%4998=2442%:%
%:%4999=2443%:%
%:%5000=2444%:%
%:%5001=2444%:%
%:%5002=2444%:%
%:%5003=2445%:%
%:%5004=2445%:%
%:%5005=2446%:%
%:%5006=2446%:%
%:%5007=2447%:%
%:%5008=2447%:%
%:%5009=2447%:%
%:%5010=2448%:%
%:%5011=2448%:%
%:%5012=2449%:%
%:%5013=2449%:%
%:%5014=2449%:%
%:%5015=2450%:%
%:%5016=2450%:%
%:%5017=2451%:%
%:%5018=2451%:%
%:%5019=2452%:%
%:%5020=2452%:%
%:%5021=2452%:%
%:%5022=2453%:%
%:%5023=2453%:%
%:%5024=2454%:%
%:%5025=2454%:%
%:%5026=2454%:%
%:%5027=2455%:%
%:%5028=2455%:%
%:%5029=2456%:%
%:%5030=2456%:%
%:%5031=2457%:%
%:%5032=2458%:%
%:%5033=2458%:%
%:%5034=2458%:%
%:%5035=2459%:%
%:%5036=2459%:%
%:%5037=2460%:%
%:%5038=2460%:%
%:%5039=2461%:%
%:%5040=2462%:%
%:%5041=2462%:%
%:%5042=2462%:%
%:%5043=2463%:%
%:%5044=2463%:%
%:%5045=2464%:%
%:%5046=2464%:%
%:%5047=2465%:%
%:%5048=2465%:%
%:%5049=2466%:%
%:%5050=2466%:%
%:%5051=2467%:%
%:%5052=2467%:%
%:%5053=2467%:%
%:%5054=2468%:%
%:%5055=2468%:%
%:%5056=2469%:%
%:%5057=2469%:%
%:%5058=2470%:%
%:%5059=2470%:%
%:%5060=2471%:%
%:%5061=2471%:%
%:%5062=2472%:%
%:%5063=2472%:%
%:%5064=2473%:%
%:%5065=2473%:%
%:%5066=2474%:%
%:%5067=2474%:%
%:%5068=2475%:%
%:%5069=2475%:%
%:%5070=2476%:%
%:%5071=2476%:%
%:%5072=2477%:%
%:%5073=2478%:%
%:%5074=2478%:%
%:%5075=2479%:%
%:%5076=2479%:%
%:%5077=2480%:%
%:%5078=2480%:%
%:%5080=2482%:%
%:%5081=2482%:%
%:%5082=2483%:%
%:%5083=2483%:%
%:%5084=2484%:%
%:%5085=2484%:%
%:%5086=2485%:%
%:%5087=2485%:%
%:%5088=2486%:%
%:%5089=2486%:%
%:%5090=2487%:%
%:%5091=2487%:%
%:%5092=2487%:%
%:%5093=2488%:%
%:%5094=2488%:%
%:%5095=2489%:%
%:%5096=2489%:%
%:%5097=2490%:%
%:%5098=2490%:%
%:%5099=2490%:%
%:%5100=2491%:%
%:%5101=2491%:%
%:%5102=2492%:%
%:%5103=2492%:%
%:%5104=2493%:%
%:%5105=2493%:%
%:%5106=2494%:%
%:%5107=2494%:%
%:%5108=2495%:%
%:%5109=2495%:%
%:%5110=2495%:%
%:%5111=2496%:%
%:%5112=2496%:%
%:%5113=2497%:%
%:%5114=2497%:%
%:%5115=2497%:%
%:%5116=2498%:%
%:%5117=2498%:%
%:%5118=2498%:%
%:%5119=2499%:%
%:%5120=2499%:%
%:%5121=2500%:%
%:%5122=2500%:%
%:%5123=2500%:%
%:%5124=2501%:%
%:%5125=2501%:%
%:%5126=2502%:%
%:%5132=2502%:%
%:%5135=2503%:%
%:%5136=2504%:%
%:%5137=2504%:%
%:%5138=2505%:%
%:%5139=2506%:%
%:%5140=2507%:%
%:%5141=2508%:%
%:%5142=2509%:%
%:%5143=2510%:%
%:%5145=2512%:%
%:%5148=2513%:%
%:%5152=2513%:%
%:%5153=2513%:%
%:%5154=2514%:%
%:%5155=2514%:%
%:%5156=2515%:%
%:%5157=2515%:%
%:%5158=2516%:%
%:%5159=2516%:%
%:%5160=2516%:%
%:%5161=2517%:%
%:%5162=2517%:%
%:%5163=2517%:%
%:%5164=2518%:%
%:%5165=2518%:%
%:%5166=2519%:%
%:%5167=2519%:%
%:%5168=2520%:%
%:%5169=2520%:%
%:%5170=2520%:%
%:%5171=2521%:%
%:%5172=2521%:%
%:%5173=2522%:%
%:%5174=2523%:%
%:%5175=2524%:%
%:%5176=2525%:%
%:%5177=2526%:%
%:%5178=2527%:%
%:%5179=2528%:%
%:%5180=2528%:%
%:%5181=2529%:%
%:%5182=2529%:%
%:%5183=2530%:%
%:%5184=2530%:%
%:%5185=2531%:%
%:%5194=2540%:%
%:%5195=2541%:%
%:%5196=2541%:%
%:%5197=2542%:%
%:%5198=2542%:%
%:%5199=2543%:%
%:%5200=2544%:%
%:%5201=2545%:%
%:%5202=2546%:%
%:%5203=2547%:%
%:%5204=2548%:%
%:%5205=2549%:%
%:%5206=2549%:%
%:%5207=2550%:%
%:%5216=2559%:%
%:%5217=2560%:%
%:%5218=2560%:%
%:%5219=2561%:%
%:%5220=2561%:%
%:%5221=2562%:%
%:%5222=2563%:%
%:%5223=2564%:%
%:%5224=2565%:%
%:%5225=2566%:%
%:%5226=2567%:%
%:%5227=2568%:%
%:%5228=2568%:%
%:%5229=2569%:%
%:%5238=2578%:%
%:%5239=2579%:%
%:%5240=2580%:%
%:%5241=2580%:%
%:%5242=2581%:%
%:%5243=2581%:%
%:%5244=2582%:%
%:%5245=2583%:%
%:%5246=2584%:%
%:%5247=2585%:%
%:%5248=2586%:%
%:%5249=2587%:%
%:%5250=2588%:%
%:%5251=2588%:%
%:%5252=2589%:%
%:%5261=2598%:%
%:%5262=2599%:%
%:%5263=2599%:%
%:%5264=2600%:%
%:%5265=2600%:%
%:%5266=2601%:%
%:%5267=2602%:%
%:%5268=2603%:%
%:%5269=2604%:%
%:%5270=2605%:%
%:%5271=2606%:%
%:%5272=2607%:%
%:%5273=2607%:%
%:%5274=2608%:%
%:%5275=2608%:%
%:%5276=2609%:%
%:%5277=2609%:%
%:%5278=2610%:%
%:%5279=2611%:%
%:%5280=2612%:%
%:%5281=2613%:%
%:%5282=2614%:%
%:%5288=2614%:%
%:%5291=2615%:%
%:%5292=2616%:%
%:%5293=2616%:%
%:%5294=2617%:%
%:%5295=2617%:%
%:%5296=2618%:%
%:%5297=2618%:%
%:%5298=2619%:%
%:%5299=2620%:%
%:%5300=2620%:%
%:%5301=2621%:%
%:%5302=2622%:%
%:%5304=2624%:%
%:%5311=2625%:%
%:%5312=2625%:%
%:%5313=2626%:%
%:%5314=2626%:%
%:%5315=2627%:%
%:%5316=2627%:%
%:%5318=2629%:%
%:%5319=2630%:%
%:%5320=2630%:%
%:%5321=2631%:%
%:%5322=2631%:%
%:%5323=2632%:%
%:%5324=2632%:%
%:%5325=2633%:%
%:%5326=2633%:%
%:%5327=2634%:%
%:%5328=2634%:%
%:%5329=2635%:%
%:%5330=2636%:%
%:%5331=2637%:%
%:%5332=2637%:%
%:%5333=2638%:%
%:%5334=2638%:%
%:%5335=2638%:%
%:%5336=2639%:%
%:%5337=2639%:%
%:%5338=2639%:%
%:%5339=2640%:%
%:%5340=2640%:%
%:%5341=2641%:%
%:%5342=2641%:%
%:%5343=2642%:%
%:%5344=2642%:%
%:%5345=2643%:%
%:%5346=2643%:%
%:%5347=2644%:%
%:%5348=2644%:%
%:%5350=2646%:%
%:%5351=2647%:%
%:%5352=2647%:%
%:%5353=2648%:%
%:%5354=2648%:%
%:%5355=2649%:%
%:%5356=2649%:%
%:%5357=2650%:%
%:%5358=2650%:%
%:%5359=2651%:%
%:%5360=2651%:%
%:%5361=2652%:%
%:%5362=2653%:%
%:%5363=2654%:%
%:%5364=2655%:%
%:%5365=2656%:%
%:%5366=2656%:%
%:%5367=2656%:%
%:%5368=2657%:%
%:%5369=2657%:%
%:%5370=2658%:%
%:%5371=2659%:%
%:%5372=2660%:%
%:%5373=2660%:%
%:%5374=2661%:%
%:%5375=2662%:%
%:%5376=2662%:%
%:%5377=2663%:%
%:%5378=2663%:%
%:%5379=2664%:%
%:%5380=2665%:%
%:%5381=2665%:%
%:%5382=2666%:%
%:%5383=2666%:%
%:%5384=2667%:%
%:%5385=2667%:%
%:%5386=2668%:%
%:%5387=2668%:%
%:%5388=2669%:%
%:%5389=2669%:%
%:%5390=2670%:%
%:%5391=2670%:%
%:%5392=2671%:%
%:%5393=2671%:%
%:%5394=2672%:%
%:%5395=2672%:%
%:%5396=2673%:%
%:%5397=2673%:%
%:%5398=2674%:%
%:%5399=2674%:%
%:%5400=2675%:%
%:%5401=2676%:%
%:%5402=2676%:%
%:%5403=2677%:%
%:%5404=2677%:%
%:%5405=2677%:%
%:%5406=2678%:%
%:%5407=2678%:%
%:%5408=2679%:%
%:%5409=2680%:%
%:%5410=2681%:%
%:%5411=2682%:%
%:%5412=2683%:%
%:%5413=2684%:%
%:%5414=2685%:%
%:%5415=2686%:%
%:%5416=2687%:%
%:%5417=2688%:%
%:%5418=2689%:%
%:%5419=2690%:%
%:%5420=2691%:%
%:%5421=2692%:%
%:%5422=2692%:%
%:%5423=2693%:%
%:%5424=2693%:%
%:%5425=2694%:%
%:%5426=2694%:%
%:%5427=2695%:%
%:%5428=2696%:%
%:%5429=2697%:%
%:%5430=2697%:%
%:%5431=2698%:%
%:%5432=2698%:%
%:%5433=2699%:%
%:%5434=2700%:%
%:%5435=2700%:%
%:%5436=2700%:%
%:%5437=2701%:%
%:%5438=2701%:%
%:%5439=2702%:%
%:%5440=2702%:%
%:%5441=2702%:%
%:%5442=2703%:%
%:%5443=2703%:%
%:%5444=2703%:%
%:%5445=2704%:%
%:%5446=2704%:%
%:%5447=2704%:%
%:%5448=2705%:%
%:%5449=2705%:%
%:%5450=2706%:%
%:%5451=2707%:%
%:%5452=2707%:%
%:%5453=2708%:%
%:%5454=2708%:%
%:%5455=2709%:%
%:%5456=2709%:%
%:%5457=2710%:%
%:%5458=2710%:%
%:%5459=2711%:%
%:%5460=2711%:%
%:%5461=2712%:%
%:%5462=2712%:%
%:%5463=2713%:%
%:%5464=2713%:%
%:%5465=2714%:%
%:%5466=2715%:%
%:%5467=2715%:%
%:%5468=2716%:%
%:%5469=2717%:%
%:%5470=2717%:%
%:%5471=2718%:%
%:%5472=2718%:%
%:%5473=2719%:%
%:%5474=2719%:%
%:%5475=2720%:%
%:%5476=2720%:%
%:%5477=2721%:%
%:%5478=2722%:%
%:%5479=2723%:%
%:%5481=2725%:%
%:%5482=2726%:%
%:%5483=2727%:%
%:%5484=2727%:%
%:%5485=2728%:%
%:%5486=2729%:%
%:%5487=2730%:%
%:%5488=2730%:%
%:%5489=2731%:%
%:%5490=2731%:%
%:%5491=2732%:%
%:%5492=2732%:%
%:%5493=2733%:%
%:%5494=2733%:%
%:%5495=2734%:%
%:%5496=2734%:%
%:%5498=2736%:%
%:%5499=2737%:%
%:%5500=2737%:%
%:%5501=2737%:%
%:%5502=2738%:%
%:%5503=2738%:%
%:%5504=2739%:%
%:%5505=2739%:%
%:%5506=2739%:%
%:%5507=2740%:%
%:%5508=2740%:%
%:%5509=2741%:%
%:%5510=2741%:%
%:%5511=2741%:%
%:%5512=2742%:%
%:%5513=2742%:%
%:%5514=2743%:%
%:%5515=2744%:%
%:%5516=2744%:%
%:%5517=2745%:%
%:%5518=2745%:%
%:%5519=2746%:%
%:%5520=2746%:%
%:%5521=2747%:%
%:%5522=2747%:%
%:%5523=2747%:%
%:%5524=2748%:%
%:%5525=2748%:%
%:%5526=2748%:%
%:%5527=2749%:%
%:%5528=2749%:%
%:%5529=2750%:%
%:%5530=2750%:%
%:%5531=2750%:%
%:%5532=2751%:%
%:%5533=2751%:%
%:%5534=2752%:%
%:%5535=2752%:%
%:%5536=2752%:%
%:%5537=2753%:%
%:%5538=2753%:%
%:%5539=2754%:%
%:%5540=2755%:%
%:%5541=2755%:%
%:%5542=2756%:%
%:%5543=2756%:%
%:%5544=2757%:%
%:%5545=2758%:%
%:%5546=2758%:%
%:%5547=2758%:%
%:%5548=2759%:%
%:%5549=2759%:%
%:%5550=2760%:%
%:%5551=2760%:%
%:%5552=2761%:%
%:%5553=2762%:%
%:%5554=2762%:%
%:%5555=2763%:%
%:%5556=2763%:%
%:%5557=2764%:%
%:%5558=2764%:%
%:%5559=2764%:%
%:%5560=2765%:%
%:%5561=2765%:%
%:%5562=2766%:%
%:%5563=2766%:%
%:%5564=2766%:%
%:%5565=2767%:%
%:%5566=2767%:%
%:%5567=2767%:%
%:%5568=2768%:%
%:%5569=2769%:%
%:%5570=2769%:%
%:%5571=2769%:%
%:%5572=2770%:%
%:%5573=2770%:%
%:%5574=2771%:%
%:%5575=2771%:%
%:%5576=2772%:%
%:%5577=2772%:%
%:%5578=2773%:%
%:%5579=2773%:%
%:%5580=2774%:%
%:%5581=2774%:%
%:%5582=2775%:%
%:%5583=2776%:%
%:%5584=2776%:%
%:%5585=2777%:%
%:%5586=2777%:%
%:%5587=2778%:%
%:%5588=2778%:%
%:%5589=2779%:%
%:%5590=2779%:%
%:%5591=2780%:%
%:%5592=2780%:%
%:%5593=2781%:%
%:%5594=2782%:%
%:%5595=2782%:%
%:%5597=2784%:%
%:%5598=2785%:%
%:%5599=2785%:%
%:%5600=2786%:%
%:%5601=2787%:%
%:%5602=2788%:%
%:%5603=2789%:%
%:%5604=2790%:%
%:%5605=2791%:%
%:%5606=2791%:%
%:%5607=2792%:%
%:%5608=2792%:%
%:%5609=2793%:%
%:%5610=2793%:%
%:%5611=2793%:%
%:%5612=2794%:%
%:%5613=2794%:%
%:%5614=2795%:%
%:%5615=2795%:%
%:%5616=2795%:%
%:%5617=2796%:%
%:%5618=2797%:%
%:%5619=2798%:%
%:%5620=2798%:%
%:%5621=2799%:%
%:%5622=2799%:%
%:%5623=2800%:%
%:%5624=2800%:%
%:%5625=2801%:%
%:%5626=2802%:%
%:%5627=2803%:%
%:%5628=2803%:%
%:%5629=2804%:%
%:%5630=2804%:%
%:%5631=2805%:%
%:%5632=2805%:%
%:%5633=2806%:%
%:%5634=2806%:%
%:%5635=2807%:%
%:%5636=2807%:%
%:%5637=2808%:%
%:%5638=2809%:%
%:%5639=2810%:%
%:%5640=2810%:%
%:%5641=2811%:%
%:%5642=2812%:%
%:%5643=2812%:%
%:%5644=2813%:%
%:%5645=2813%:%
%:%5646=2814%:%
%:%5647=2814%:%
%:%5648=2815%:%
%:%5649=2816%:%
%:%5650=2817%:%
%:%5651=2817%:%
%:%5652=2818%:%
%:%5653=2818%:%
%:%5654=2818%:%
%:%5655=2819%:%
%:%5656=2819%:%
%:%5658=2821%:%
%:%5659=2822%:%
%:%5660=2822%:%
%:%5661=2823%:%
%:%5662=2823%:%
%:%5663=2824%:%
%:%5664=2825%:%
%:%5665=2825%:%
%:%5666=2826%:%
%:%5667=2826%:%
%:%5668=2827%:%
%:%5669=2827%:%
%:%5670=2828%:%
%:%5671=2828%:%
%:%5672=2829%:%
%:%5673=2830%:%
%:%5674=2831%:%
%:%5675=2831%:%
%:%5683=2839%:%
%:%5684=2840%:%
%:%5685=2840%:%
%:%5686=2841%:%
%:%5687=2841%:%
%:%5688=2842%:%
%:%5691=2845%:%
%:%5692=2846%:%
%:%5695=2849%:%
%:%5696=2850%:%
%:%5697=2850%:%
%:%5698=2851%:%
%:%5699=2851%:%
%:%5702=2854%:%
%:%5703=2855%:%
%:%5704=2855%:%
%:%5705=2856%:%
%:%5706=2856%:%
%:%5707=2857%:%
%:%5708=2857%:%
%:%5709=2858%:%
%:%5710=2858%:%
%:%5711=2859%:%
%:%5712=2859%:%
%:%5713=2860%:%
%:%5714=2860%:%
%:%5715=2861%:%
%:%5716=2861%:%
%:%5717=2861%:%
%:%5718=2862%:%
%:%5719=2863%:%
%:%5720=2863%:%
%:%5721=2864%:%
%:%5722=2864%:%
%:%5723=2865%:%
%:%5724=2865%:%
%:%5725=2866%:%
%:%5726=2866%:%
%:%5727=2867%:%
%:%5728=2867%:%
%:%5729=2868%:%
%:%5730=2869%:%
%:%5731=2870%:%
%:%5732=2870%:%
%:%5733=2870%:%
%:%5734=2871%:%
%:%5735=2871%:%
%:%5736=2872%:%
%:%5737=2872%:%
%:%5738=2873%:%
%:%5739=2873%:%
%:%5740=2873%:%
%:%5741=2874%:%
%:%5742=2874%:%
%:%5743=2875%:%
%:%5744=2875%:%
%:%5745=2875%:%
%:%5746=2876%:%
%:%5747=2876%:%
%:%5748=2877%:%
%:%5749=2877%:%
%:%5750=2878%:%
%:%5751=2878%:%
%:%5752=2878%:%
%:%5753=2879%:%
%:%5754=2879%:%
%:%5755=2880%:%
%:%5756=2880%:%
%:%5757=2880%:%
%:%5758=2881%:%
%:%5759=2881%:%
%:%5760=2882%:%
%:%5761=2882%:%
%:%5762=2883%:%
%:%5763=2884%:%
%:%5764=2884%:%
%:%5765=2884%:%
%:%5766=2885%:%
%:%5767=2885%:%
%:%5768=2886%:%
%:%5769=2886%:%
%:%5770=2887%:%
%:%5771=2888%:%
%:%5772=2888%:%
%:%5773=2888%:%
%:%5774=2889%:%
%:%5775=2889%:%
%:%5776=2890%:%
%:%5777=2890%:%
%:%5778=2891%:%
%:%5779=2891%:%
%:%5780=2892%:%
%:%5781=2892%:%
%:%5782=2892%:%
%:%5783=2893%:%
%:%5784=2893%:%
%:%5785=2894%:%
%:%5786=2894%:%
%:%5787=2894%:%
%:%5788=2895%:%
%:%5789=2895%:%
%:%5790=2896%:%
%:%5791=2896%:%
%:%5792=2897%:%
%:%5793=2897%:%
%:%5794=2898%:%
%:%5795=2898%:%
%:%5796=2899%:%
%:%5797=2899%:%
%:%5798=2900%:%
%:%5799=2901%:%
%:%5800=2901%:%
%:%5801=2902%:%
%:%5802=2902%:%
%:%5803=2903%:%
%:%5804=2903%:%
%:%5805=2904%:%
%:%5806=2904%:%
%:%5807=2905%:%
%:%5808=2905%:%
%:%5809=2905%:%
%:%5810=2906%:%
%:%5811=2906%:%
%:%5812=2907%:%
%:%5813=2907%:%
%:%5814=2907%:%
%:%5815=2908%:%
%:%5816=2908%:%
%:%5817=2909%:%
%:%5818=2909%:%
%:%5819=2909%:%
%:%5820=2910%:%
%:%5821=2910%:%
%:%5822=2911%:%
%:%5823=2911%:%
%:%5824=2911%:%
%:%5825=2912%:%
%:%5826=2912%:%
%:%5827=2913%:%
%:%5828=2913%:%
%:%5829=2914%:%
%:%5830=2914%:%
%:%5832=2916%:%
%:%5833=2917%:%
%:%5834=2917%:%
%:%5835=2918%:%
%:%5836=2918%:%
%:%5837=2919%:%
%:%5838=2919%:%
%:%5839=2920%:%
%:%5840=2920%:%
%:%5841=2921%:%
%:%5842=2921%:%
%:%5843=2922%:%
%:%5844=2922%:%
%:%5845=2922%:%
%:%5846=2923%:%
%:%5847=2923%:%
%:%5848=2924%:%
%:%5849=2924%:%
%:%5850=2925%:%
%:%5851=2925%:%
%:%5852=2926%:%
%:%5853=2926%:%
%:%5854=2927%:%
%:%5855=2928%:%
%:%5856=2928%:%
%:%5857=2929%:%
%:%5858=2929%:%
%:%5859=2929%:%
%:%5860=2930%:%
%:%5861=2930%:%
%:%5862=2931%:%
%:%5863=2931%:%
%:%5864=2932%:%
%:%5865=2932%:%
%:%5866=2932%:%
%:%5867=2933%:%
%:%5868=2933%:%
%:%5869=2934%:%
%:%5870=2934%:%
%:%5871=2935%:%
%:%5872=2935%:%
%:%5873=2935%:%
%:%5874=2936%:%
%:%5875=2936%:%
%:%5876=2937%:%
%:%5877=2937%:%
%:%5878=2938%:%
%:%5879=2939%:%
%:%5880=2939%:%
%:%5881=2940%:%
%:%5882=2940%:%
%:%5883=2941%:%
%:%5884=2941%:%
%:%5885=2942%:%
%:%5886=2942%:%
%:%5887=2943%:%
%:%5893=2943%:%
%:%5896=2944%:%
%:%5897=2945%:%
%:%5898=2945%:%
%:%5899=2946%:%
%:%5900=2947%:%
%:%5901=2948%:%
%:%5902=2949%:%
%:%5904=2951%:%
%:%5905=2952%:%
%:%5908=2953%:%
%:%5912=2953%:%
%:%5913=2953%:%
%:%5914=2954%:%
%:%5915=2954%:%
%:%5916=2955%:%
%:%5917=2955%:%
%:%5918=2956%:%
%:%5919=2956%:%
%:%5920=2956%:%
%:%5921=2957%:%
%:%5922=2957%:%
%:%5923=2957%:%
%:%5924=2958%:%
%:%5925=2958%:%
%:%5926=2959%:%
%:%5927=2959%:%
%:%5928=2960%:%
%:%5929=2960%:%
%:%5930=2960%:%
%:%5931=2961%:%
%:%5932=2961%:%
%:%5933=2961%:%
%:%5934=2962%:%
%:%5935=2962%:%
%:%5936=2963%:%
%:%5937=2963%:%
%:%5938=2964%:%
%:%5939=2965%:%
%:%5940=2966%:%
%:%5941=2966%:%
%:%5942=2967%:%
%:%5943=2967%:%
%:%5944=2968%:%
%:%5945=2968%:%
%:%5946=2969%:%
%:%5947=2969%:%
%:%5948=2970%:%
%:%5949=2970%:%
%:%5950=2971%:%
%:%5951=2971%:%
%:%5952=2972%:%
%:%5953=2973%:%
%:%5954=2974%:%
%:%5955=2975%:%
%:%5956=2975%:%
%:%5959=2978%:%
%:%5960=2979%:%
%:%5961=2979%:%
%:%5962=2980%:%
%:%5963=2980%:%
%:%5964=2981%:%
%:%5965=2982%:%
%:%5966=2983%:%
%:%5967=2984%:%
%:%5968=2984%:%
%:%5969=2984%:%
%:%5970=2985%:%
%:%5971=2985%:%
%:%5972=2985%:%
%:%5973=2986%:%
%:%5974=2986%:%
%:%5975=2986%:%
%:%5976=2987%:%
%:%5977=2987%:%
%:%5978=2988%:%
%:%5979=2988%:%
%:%5980=2989%:%
%:%5981=2990%:%
%:%5982=2991%:%
%:%5983=2991%:%
%:%5984=2991%:%
%:%5985=2991%:%
%:%5986=2992%:%
%:%5992=2992%:%
%:%5995=2993%:%
%:%5996=2994%:%
%:%5997=2994%:%
%:%5998=2995%:%
%:%5999=2996%:%
%:%6000=2997%:%
%:%6001=2998%:%
%:%6002=2999%:%
%:%6006=3003%:%
%:%6013=3004%:%
%:%6014=3004%:%
%:%6015=3005%:%
%:%6016=3005%:%
%:%6017=3006%:%
%:%6018=3007%:%
%:%6019=3007%:%
%:%6020=3008%:%
%:%6021=3008%:%
%:%6022=3009%:%
%:%6023=3009%:%
%:%6024=3010%:%
%:%6025=3010%:%
%:%6026=3011%:%
%:%6027=3011%:%
%:%6028=3012%:%
%:%6029=3012%:%
%:%6030=3012%:%
%:%6031=3013%:%
%:%6032=3013%:%
%:%6033=3013%:%
%:%6034=3014%:%
%:%6035=3014%:%
%:%6036=3015%:%
%:%6037=3015%:%
%:%6038=3016%:%
%:%6039=3016%:%
%:%6040=3017%:%
%:%6041=3017%:%
%:%6042=3017%:%
%:%6043=3018%:%
%:%6044=3018%:%
%:%6045=3019%:%
%:%6046=3020%:%
%:%6047=3020%:%
%:%6048=3020%:%
%:%6051=3023%:%
%:%6052=3024%:%
%:%6053=3024%:%
%:%6054=3025%:%
%:%6055=3025%:%
%:%6056=3026%:%
%:%6057=3026%:%
%:%6058=3026%:%
%:%6059=3027%:%
%:%6060=3028%:%
%:%6061=3028%:%
%:%6062=3029%:%
%:%6063=3029%:%
%:%6064=3030%:%
%:%6065=3030%:%
%:%6066=3030%:%
%:%6067=3030%:%
%:%6068=3031%:%
%:%6069=3031%:%
%:%6070=3032%:%
%:%6071=3032%:%
%:%6072=3033%:%
%:%6073=3033%:%
%:%6074=3034%:%
%:%6075=3034%:%
%:%6076=3035%:%
%:%6077=3035%:%
%:%6078=3036%:%
%:%6079=3037%:%
%:%6080=3037%:%
%:%6081=3038%:%
%:%6082=3039%:%
%:%6083=3039%:%
%:%6084=3039%:%
%:%6085=3040%:%
%:%6086=3041%:%
%:%6087=3041%:%
%:%6088=3041%:%
%:%6089=3042%:%
%:%6090=3042%:%
%:%6091=3042%:%
%:%6095=3046%:%
%:%6096=3047%:%
%:%6097=3047%:%
%:%6098=3047%:%
%:%6099=3048%:%
%:%6100=3048%:%
%:%6101=3048%:%
%:%6102=3049%:%
%:%6103=3050%:%
%:%6104=3050%:%
%:%6105=3051%:%
%:%6106=3051%:%
%:%6107=3052%:%
%:%6108=3052%:%
%:%6109=3052%:%
%:%6111=3054%:%
%:%6112=3055%:%
%:%6113=3055%:%
%:%6114=3056%:%
%:%6115=3056%:%
%:%6116=3056%:%
%:%6117=3057%:%
%:%6118=3057%:%
%:%6119=3058%:%
%:%6120=3058%:%
%:%6121=3059%:%
%:%6122=3059%:%
%:%6123=3059%:%
%:%6124=3060%:%
%:%6125=3060%:%
%:%6126=3061%:%
%:%6127=3061%:%
%:%6128=3062%:%
%:%6129=3062%:%
%:%6130=3062%:%
%:%6131=3063%:%
%:%6132=3063%:%
%:%6133=3064%:%
%:%6134=3064%:%
%:%6135=3065%:%
%:%6141=3065%:%
%:%6144=3066%:%
%:%6145=3067%:%
%:%6146=3067%:%
%:%6149=3068%:%
%:%6153=3068%:%
%:%6154=3068%:%
%:%6155=3069%:%
%:%6156=3069%:%
%:%6157=3070%:%
%:%6158=3070%:%
%:%6159=3071%:%
%:%6160=3071%:%
%:%6161=3072%:%
%:%6167=3072%:%
%:%6170=3073%:%
%:%6171=3074%:%
%:%6172=3074%:%
%:%6173=3075%:%
%:%6174=3076%:%
%:%6181=3077%:%
%:%6182=3077%:%
%:%6183=3078%:%
%:%6184=3078%:%
%:%6185=3079%:%
%:%6186=3079%:%
%:%6188=3081%:%
%:%6189=3082%:%
%:%6190=3082%:%
%:%6191=3083%:%
%:%6192=3083%:%
%:%6193=3084%:%
%:%6194=3084%:%
%:%6195=3085%:%
%:%6196=3085%:%
%:%6197=3086%:%
%:%6198=3086%:%
%:%6199=3087%:%
%:%6200=3087%:%
%:%6201=3087%:%
%:%6202=3088%:%
%:%6203=3088%:%
%:%6204=3089%:%
%:%6209=3094%:%
%:%6210=3095%:%
%:%6212=3097%:%
%:%6213=3098%:%
%:%6214=3098%:%
%:%6215=3098%:%
%:%6216=3099%:%
%:%6217=3099%:%
%:%6218=3100%:%
%:%6219=3101%:%
%:%6220=3101%:%
%:%6221=3102%:%
%:%6222=3102%:%
%:%6223=3102%:%
%:%6224=3103%:%
%:%6225=3103%:%
%:%6226=3104%:%
%:%6227=3104%:%
%:%6228=3105%:%
%:%6229=3106%:%
%:%6230=3106%:%
%:%6231=3107%:%
%:%6232=3107%:%
%:%6233=3107%:%
%:%6234=3108%:%
%:%6235=3108%:%
%:%6236=3109%:%
%:%6237=3109%:%
%:%6238=3110%:%
%:%6239=3110%:%
%:%6240=3111%:%
%:%6241=3111%:%
%:%6242=3112%:%
%:%6243=3112%:%
%:%6244=3113%:%
%:%6245=3113%:%
%:%6246=3114%:%
%:%6247=3115%:%
%:%6248=3116%:%
%:%6249=3116%:%
%:%6250=3116%:%
%:%6251=3117%:%
%:%6252=3117%:%
%:%6253=3117%:%
%:%6254=3118%:%
%:%6255=3118%:%
%:%6256=3118%:%
%:%6257=3119%:%
%:%6258=3119%:%
%:%6259=3120%:%
%:%6260=3120%:%
%:%6261=3121%:%
%:%6262=3121%:%
%:%6263=3121%:%
%:%6264=3122%:%
%:%6265=3122%:%
%:%6266=3123%:%
%:%6267=3123%:%
%:%6268=3124%:%
%:%6269=3124%:%
%:%6270=3125%:%
%:%6271=3125%:%
%:%6272=3126%:%
%:%6273=3126%:%
%:%6274=3127%:%
%:%6275=3127%:%
%:%6276=3128%:%
%:%6277=3128%:%
%:%6278=3128%:%
%:%6279=3129%:%
%:%6280=3129%:%
%:%6281=3130%:%
%:%6282=3130%:%
%:%6283=3131%:%
%:%6284=3131%:%
%:%6285=3132%:%
%:%6286=3132%:%
%:%6287=3133%:%
%:%6288=3133%:%
%:%6289=3134%:%
%:%6290=3134%:%
%:%6291=3135%:%
%:%6292=3135%:%
%:%6293=3136%:%
%:%6294=3136%:%
%:%6295=3137%:%
%:%6296=3137%:%
%:%6297=3138%:%
%:%6298=3138%:%
%:%6299=3139%:%
%:%6300=3139%:%
%:%6301=3140%:%
%:%6302=3140%:%
%:%6303=3141%:%
%:%6304=3141%:%
%:%6305=3142%:%
%:%6306=3143%:%
%:%6307=3143%:%
%:%6308=3144%:%
%:%6309=3144%:%
%:%6310=3145%:%
%:%6311=3145%:%
%:%6313=3147%:%
%:%6314=3147%:%
%:%6315=3148%:%
%:%6316=3148%:%
%:%6317=3149%:%
%:%6318=3149%:%
%:%6319=3150%:%
%:%6320=3150%:%
%:%6321=3151%:%
%:%6322=3151%:%
%:%6323=3152%:%
%:%6324=3152%:%
%:%6325=3152%:%
%:%6326=3153%:%
%:%6327=3153%:%
%:%6328=3154%:%
%:%6329=3154%:%
%:%6330=3155%:%
%:%6331=3155%:%
%:%6332=3155%:%
%:%6333=3156%:%
%:%6334=3156%:%
%:%6335=3157%:%
%:%6336=3157%:%
%:%6337=3158%:%
%:%6338=3158%:%
%:%6339=3159%:%
%:%6340=3159%:%
%:%6341=3160%:%
%:%6342=3160%:%
%:%6343=3160%:%
%:%6344=3161%:%
%:%6345=3161%:%
%:%6346=3162%:%
%:%6347=3162%:%
%:%6348=3163%:%
%:%6349=3163%:%
%:%6350=3164%:%
%:%6351=3164%:%
%:%6352=3165%:%
%:%6353=3166%:%
%:%6354=3166%:%
%:%6355=3167%:%
%:%6356=3167%:%
%:%6357=3167%:%
%:%6358=3168%:%
%:%6359=3168%:%
%:%6360=3168%:%
%:%6361=3169%:%
%:%6367=3169%:%
%:%6370=3170%:%
%:%6371=3171%:%
%:%6372=3171%:%
%:%6373=3172%:%
%:%6374=3173%:%
%:%6377=3174%:%
%:%6381=3174%:%
%:%6382=3174%:%
%:%6383=3174%:%
%:%6388=3174%:%
%:%6391=3175%:%
%:%6392=3176%:%
%:%6393=3176%:%
%:%6394=3177%:%
%:%6397=3180%:%
%:%6400=3181%:%
%:%6404=3181%:%
%:%6405=3181%:%
%:%6406=3182%:%
%:%6407=3182%:%
%:%6408=3183%:%
%:%6409=3183%:%
%:%6410=3184%:%
%:%6411=3184%:%
%:%6412=3185%:%
%:%6413=3185%:%
%:%6414=3185%:%
%:%6415=3186%:%
%:%6416=3186%:%
%:%6417=3187%:%
%:%6418=3187%:%
%:%6420=3189%:%
%:%6421=3190%:%
%:%6422=3190%:%
%:%6423=3191%:%
%:%6424=3191%:%
%:%6425=3192%:%
%:%6426=3192%:%
%:%6427=3193%:%
%:%6428=3193%:%
%:%6429=3194%:%
%:%6430=3194%:%
%:%6431=3195%:%
%:%6432=3196%:%
%:%6433=3197%:%
%:%6434=3197%:%
%:%6435=3198%:%
%:%6436=3198%:%
%:%6437=3198%:%
%:%6438=3199%:%
%:%6439=3199%:%
%:%6440=3199%:%
%:%6441=3200%:%
%:%6442=3200%:%
%:%6443=3201%:%
%:%6444=3201%:%
%:%6445=3202%:%
%:%6446=3202%:%
%:%6447=3203%:%
%:%6448=3203%:%
%:%6449=3204%:%
%:%6450=3204%:%
%:%6452=3206%:%
%:%6453=3207%:%
%:%6454=3207%:%
%:%6455=3208%:%
%:%6456=3208%:%
%:%6457=3209%:%
%:%6458=3209%:%
%:%6459=3210%:%
%:%6460=3210%:%
%:%6461=3211%:%
%:%6462=3211%:%
%:%6463=3212%:%
%:%6464=3213%:%
%:%6465=3214%:%
%:%6466=3215%:%
%:%6467=3216%:%
%:%6468=3216%:%
%:%6469=3216%:%
%:%6470=3217%:%
%:%6471=3217%:%
%:%6472=3218%:%
%:%6473=3219%:%
%:%6474=3220%:%
%:%6475=3220%:%
%:%6476=3221%:%
%:%6477=3222%:%
%:%6478=3222%:%
%:%6479=3223%:%
%:%6480=3223%:%
%:%6481=3224%:%
%:%6482=3225%:%
%:%6483=3225%:%
%:%6484=3225%:%
%:%6485=3226%:%
%:%6486=3226%:%
%:%6487=3227%:%
%:%6488=3228%:%
%:%6489=3228%:%
%:%6490=3229%:%
%:%6491=3229%:%
%:%6492=3229%:%
%:%6493=3230%:%
%:%6494=3230%:%
%:%6495=3231%:%
%:%6496=3232%:%
%:%6497=3232%:%
%:%6498=3232%:%
%:%6499=3233%:%
%:%6500=3233%:%
%:%6501=3234%:%
%:%6502=3234%:%
%:%6503=3235%:%
%:%6504=3235%:%
%:%6505=3236%:%
%:%6506=3236%:%
%:%6507=3237%:%
%:%6508=3237%:%
%:%6509=3238%:%
%:%6510=3238%:%
%:%6511=3239%:%
%:%6512=3240%:%
%:%6513=3241%:%
%:%6514=3242%:%
%:%6515=3242%:%
%:%6516=3243%:%
%:%6517=3243%:%
%:%6518=3244%:%
%:%6519=3244%:%
%:%6520=3245%:%
%:%6521=3246%:%
%:%6522=3247%:%
%:%6523=3247%:%
%:%6524=3248%:%
%:%6525=3248%:%
%:%6526=3249%:%
%:%6527=3249%:%
%:%6528=3249%:%
%:%6529=3250%:%
%:%6530=3250%:%
%:%6531=3251%:%
%:%6532=3252%:%
%:%6533=3252%:%
%:%6534=3253%:%
%:%6535=3253%:%
%:%6536=3254%:%
%:%6537=3254%:%
%:%6538=3255%:%
%:%6539=3256%:%
%:%6540=3257%:%
%:%6541=3258%:%
%:%6542=3258%:%
%:%6543=3259%:%
%:%6544=3259%:%
%:%6545=3259%:%
%:%6546=3260%:%
%:%6547=3260%:%
%:%6549=3262%:%
%:%6550=3263%:%
%:%6551=3263%:%
%:%6552=3264%:%
%:%6553=3264%:%
%:%6554=3265%:%
%:%6555=3266%:%
%:%6556=3267%:%
%:%6557=3267%:%
%:%6558=3268%:%
%:%6559=3268%:%
%:%6560=3269%:%
%:%6561=3270%:%
%:%6562=3270%:%
%:%6563=3271%:%
%:%6568=3276%:%
%:%6569=3277%:%
%:%6571=3279%:%
%:%6572=3280%:%
%:%6573=3280%:%
%:%6574=3280%:%
%:%6575=3281%:%
%:%6576=3281%:%
%:%6577=3282%:%
%:%6578=3283%:%
%:%6579=3283%:%
%:%6580=3284%:%
%:%6581=3284%:%
%:%6582=3285%:%
%:%6583=3285%:%
%:%6584=3286%:%
%:%6585=3286%:%
%:%6586=3286%:%
%:%6587=3287%:%
%:%6588=3288%:%
%:%6589=3288%:%
%:%6590=3289%:%
%:%6591=3289%:%
%:%6592=3290%:%
%:%6593=3290%:%
%:%6594=3291%:%
%:%6595=3291%:%
%:%6596=3292%:%
%:%6597=3292%:%
%:%6598=3293%:%
%:%6599=3294%:%
%:%6600=3295%:%
%:%6601=3295%:%
%:%6602=3295%:%
%:%6603=3296%:%
%:%6604=3296%:%
%:%6605=3297%:%
%:%6606=3297%:%
%:%6607=3298%:%
%:%6608=3298%:%
%:%6609=3298%:%
%:%6610=3299%:%
%:%6611=3299%:%
%:%6612=3300%:%
%:%6613=3300%:%
%:%6614=3300%:%
%:%6615=3301%:%
%:%6616=3301%:%
%:%6617=3302%:%
%:%6618=3302%:%
%:%6619=3303%:%
%:%6620=3303%:%
%:%6621=3303%:%
%:%6622=3304%:%
%:%6623=3304%:%
%:%6624=3305%:%
%:%6625=3305%:%
%:%6626=3305%:%
%:%6627=3306%:%
%:%6628=3306%:%
%:%6629=3307%:%
%:%6630=3308%:%
%:%6631=3309%:%
%:%6632=3309%:%
%:%6633=3310%:%
%:%6634=3310%:%
%:%6635=3310%:%
%:%6636=3311%:%
%:%6637=3311%:%
%:%6638=3312%:%
%:%6639=3312%:%
%:%6640=3313%:%
%:%6641=3314%:%
%:%6642=3314%:%
%:%6643=3315%:%
%:%6644=3315%:%
%:%6645=3315%:%
%:%6646=3316%:%
%:%6647=3316%:%
%:%6648=3317%:%
%:%6649=3317%:%
%:%6650=3318%:%
%:%6651=3318%:%
%:%6652=3319%:%
%:%6653=3319%:%
%:%6654=3320%:%
%:%6655=3320%:%
%:%6656=3320%:%
%:%6657=3321%:%
%:%6658=3321%:%
%:%6659=3322%:%
%:%6660=3322%:%
%:%6661=3323%:%
%:%6662=3323%:%
%:%6663=3324%:%
%:%6664=3324%:%
%:%6665=3325%:%
%:%6666=3325%:%
%:%6667=3326%:%
%:%6668=3326%:%
%:%6669=3327%:%
%:%6670=3327%:%
%:%6671=3328%:%
%:%6672=3328%:%
%:%6673=3329%:%
%:%6674=3329%:%
%:%6675=3330%:%
%:%6676=3330%:%
%:%6677=3331%:%
%:%6678=3331%:%
%:%6679=3332%:%
%:%6680=3332%:%
%:%6681=3333%:%
%:%6682=3333%:%
%:%6683=3334%:%
%:%6684=3335%:%
%:%6685=3335%:%
%:%6686=3336%:%
%:%6687=3336%:%
%:%6688=3337%:%
%:%6689=3337%:%
%:%6692=3340%:%
%:%6693=3340%:%
%:%6694=3341%:%
%:%6695=3341%:%
%:%6696=3342%:%
%:%6697=3342%:%
%:%6698=3343%:%
%:%6699=3343%:%
%:%6700=3344%:%
%:%6701=3344%:%
%:%6702=3345%:%
%:%6703=3345%:%
%:%6704=3345%:%
%:%6705=3346%:%
%:%6706=3346%:%
%:%6707=3347%:%
%:%6708=3347%:%
%:%6709=3348%:%
%:%6710=3348%:%
%:%6711=3348%:%
%:%6712=3349%:%
%:%6713=3349%:%
%:%6714=3350%:%
%:%6715=3350%:%
%:%6716=3351%:%
%:%6717=3351%:%
%:%6718=3352%:%
%:%6719=3353%:%
%:%6720=3353%:%
%:%6721=3354%:%
%:%6722=3354%:%
%:%6723=3354%:%
%:%6724=3355%:%
%:%6725=3355%:%
%:%6726=3356%:%
%:%6727=3356%:%
%:%6728=3356%:%
%:%6729=3357%:%
%:%6730=3357%:%
%:%6731=3357%:%
%:%6732=3358%:%
%:%6733=3358%:%
%:%6734=3359%:%
%:%6735=3359%:%
%:%6736=3359%:%
%:%6737=3360%:%
%:%6738=3360%:%
%:%6739=3361%:%
%:%6745=3361%:%
%:%6748=3362%:%
%:%6749=3363%:%
%:%6750=3363%:%
%:%6751=3364%:%
%:%6752=3365%:%
%:%6753=3366%:%
%:%6754=3367%:%
%:%6755=3368%:%
%:%6756=3369%:%
%:%6758=3371%:%
%:%6761=3372%:%
%:%6765=3372%:%
%:%6766=3372%:%
%:%6767=3373%:%
%:%6768=3373%:%
%:%6769=3374%:%
%:%6770=3374%:%
%:%6771=3375%:%
%:%6772=3375%:%
%:%6773=3375%:%
%:%6774=3376%:%
%:%6775=3376%:%
%:%6776=3376%:%
%:%6777=3377%:%
%:%6778=3377%:%
%:%6779=3378%:%
%:%6780=3378%:%
%:%6781=3379%:%
%:%6782=3379%:%
%:%6783=3380%:%
%:%6784=3380%:%
%:%6785=3381%:%
%:%6786=3381%:%
%:%6787=3382%:%
%:%6788=3383%:%
%:%6789=3384%:%
%:%6790=3385%:%
%:%6791=3386%:%
%:%6792=3387%:%
%:%6793=3388%:%
%:%6794=3388%:%
%:%6795=3389%:%
%:%6796=3389%:%
%:%6797=3390%:%
%:%6798=3390%:%
%:%6799=3391%:%
%:%6802=3394%:%
%:%6803=3395%:%
%:%6806=3398%:%
%:%6807=3399%:%
%:%6808=3400%:%
%:%6809=3401%:%
%:%6810=3402%:%
%:%6811=3403%:%
%:%6812=3404%:%
%:%6813=3405%:%
%:%6814=3406%:%
%:%6815=3406%:%
%:%6816=3407%:%
%:%6817=3407%:%
%:%6818=3408%:%
%:%6819=3409%:%
%:%6820=3410%:%
%:%6821=3410%:%
%:%6824=3413%:%
%:%6825=3414%:%
%:%6828=3417%:%
%:%6829=3418%:%
%:%6830=3419%:%
%:%6831=3420%:%
%:%6832=3421%:%
%:%6833=3422%:%
%:%6834=3423%:%
%:%6835=3423%:%
%:%6836=3424%:%
%:%6837=3424%:%
%:%6838=3425%:%
%:%6839=3425%:%
%:%6840=3426%:%
%:%6841=3427%:%
%:%6842=3428%:%
%:%6843=3428%:%
%:%6846=3431%:%
%:%6847=3432%:%
%:%6850=3435%:%
%:%6851=3436%:%
%:%6852=3437%:%
%:%6853=3438%:%
%:%6854=3439%:%
%:%6855=3440%:%
%:%6856=3441%:%
%:%6857=3442%:%
%:%6858=3442%:%
%:%6859=3443%:%
%:%6860=3443%:%
%:%6861=3444%:%
%:%6862=3444%:%
%:%6863=3445%:%
%:%6864=3445%:%
%:%6865=3446%:%
%:%6866=3446%:%
%:%6867=3447%:%
%:%6868=3447%:%
%:%6869=3448%:%
%:%6870=3449%:%
%:%6871=3450%:%
%:%6872=3451%:%
%:%6873=3451%:%
%:%6876=3454%:%
%:%6877=3455%:%
%:%6880=3458%:%
%:%6881=3459%:%
%:%6882=3460%:%
%:%6883=3461%:%
%:%6884=3462%:%
%:%6885=3463%:%
%:%6886=3463%:%
%:%6887=3464%:%
%:%6888=3464%:%
%:%6889=3465%:%
%:%6890=3465%:%
%:%6891=3466%:%
%:%6892=3466%:%
%:%6893=3467%:%
%:%6894=3467%:%
%:%6895=3468%:%
%:%6896=3468%:%
%:%6897=3469%:%
%:%6898=3470%:%
%:%6899=3471%:%
%:%6900=3472%:%
%:%6901=3472%:%
%:%6902=3473%:%
%:%6903=3473%:%
%:%6904=3474%:%
%:%6905=3474%:%
%:%6906=3475%:%
%:%6907=3476%:%
%:%6908=3477%:%
%:%6909=3478%:%
%:%6910=3479%:%
%:%6911=3480%:%
%:%6917=3480%:%
%:%6920=3481%:%
%:%6921=3482%:%
%:%6922=3482%:%
%:%6923=3483%:%
%:%6924=3484%:%
%:%6925=3485%:%
%:%6932=3486%:%
%:%6933=3486%:%
%:%6934=3487%:%
%:%6935=3488%:%
%:%6936=3488%:%
%:%6937=3489%:%
%:%6938=3489%:%
%:%6939=3489%:%
%:%6940=3490%:%
%:%6941=3490%:%
%:%6942=3491%:%
%:%6943=3491%:%
%:%6944=3491%:%
%:%6945=3492%:%
%:%6946=3492%:%
%:%6947=3493%:%
%:%6948=3493%:%
%:%6949=3494%:%
%:%6950=3494%:%
%:%6951=3495%:%
%:%6952=3496%:%
%:%6953=3496%:%
%:%6954=3496%:%
%:%6955=3497%:%
%:%6956=3497%:%
%:%6957=3497%:%
%:%6958=3498%:%
%:%6959=3498%:%
%:%6960=3499%:%
%:%6961=3499%:%
%:%6962=3500%:%
%:%6963=3500%:%
%:%6964=3500%:%
%:%6965=3501%:%
%:%6966=3501%:%
%:%6967=3502%:%
%:%6968=3502%:%
%:%6969=3502%:%
%:%6970=3503%:%
%:%6971=3503%:%
%:%6972=3504%:%
%:%6973=3504%:%
%:%6974=3505%:%
%:%6975=3505%:%
%:%6976=3506%:%
%:%6977=3507%:%
%:%6978=3507%:%
%:%6979=3507%:%
%:%6980=3508%:%
%:%6981=3508%:%
%:%6982=3508%:%
%:%6983=3509%:%
%:%6984=3509%:%
%:%6985=3510%:%
%:%6986=3510%:%
%:%6987=3511%:%
%:%6988=3511%:%
%:%6989=3512%:%
%:%6990=3512%:%
%:%6991=3513%:%
%:%6992=3513%:%
%:%6993=3514%:%
%:%6994=3515%:%
%:%6995=3516%:%
%:%6996=3516%:%
%:%6997=3517%:%
%:%6998=3517%:%
%:%6999=3517%:%
%:%7000=3518%:%
%:%7001=3518%:%
%:%7002=3518%:%
%:%7003=3518%:%
%:%7004=3519%:%
%:%7005=3519%:%
%:%7006=3519%:%
%:%7007=3520%:%
%:%7008=3520%:%
%:%7009=3521%:%
%:%7010=3521%:%
%:%7011=3522%:%
%:%7012=3522%:%
%:%7013=3522%:%
%:%7014=3523%:%
%:%7015=3523%:%
%:%7016=3523%:%
%:%7017=3524%:%
%:%7018=3524%:%
%:%7019=3525%:%
%:%7020=3525%:%
%:%7021=3526%:%
%:%7022=3526%:%
%:%7023=3527%:%
%:%7024=3527%:%
%:%7025=3528%:%
%:%7026=3529%:%
%:%7027=3530%:%
%:%7028=3530%:%
%:%7029=3531%:%
%:%7030=3531%:%
%:%7031=3531%:%
%:%7032=3532%:%
%:%7033=3532%:%
%:%7034=3532%:%
%:%7035=3532%:%
%:%7036=3533%:%
%:%7037=3533%:%
%:%7038=3533%:%
%:%7039=3534%:%
%:%7040=3534%:%
%:%7041=3535%:%
%:%7042=3535%:%
%:%7043=3536%:%
%:%7044=3536%:%
%:%7045=3536%:%
%:%7046=3537%:%
%:%7047=3537%:%
%:%7048=3537%:%
%:%7049=3538%:%
%:%7055=3538%:%
%:%7058=3539%:%
%:%7059=3540%:%
%:%7060=3540%:%
%:%7061=3541%:%
%:%7062=3541%:%
%:%7063=3542%:%
%:%7064=3542%:%
%:%7065=3543%:%
%:%7066=3544%:%
%:%7067=3544%:%
%:%7068=3545%:%
%:%7069=3546%:%
%:%7071=3548%:%
%:%7078=3549%:%
%:%7079=3549%:%
%:%7080=3550%:%
%:%7081=3550%:%
%:%7082=3551%:%
%:%7083=3551%:%
%:%7085=3553%:%
%:%7086=3554%:%
%:%7087=3554%:%
%:%7088=3555%:%
%:%7089=3555%:%
%:%7090=3556%:%
%:%7091=3556%:%
%:%7092=3557%:%
%:%7093=3557%:%
%:%7094=3558%:%
%:%7095=3558%:%
%:%7096=3559%:%
%:%7097=3560%:%
%:%7098=3561%:%
%:%7099=3561%:%
%:%7100=3562%:%
%:%7101=3562%:%
%:%7102=3562%:%
%:%7103=3563%:%
%:%7104=3563%:%
%:%7105=3563%:%
%:%7106=3564%:%
%:%7107=3564%:%
%:%7108=3565%:%
%:%7109=3565%:%
%:%7110=3566%:%
%:%7111=3566%:%
%:%7112=3567%:%
%:%7113=3567%:%
%:%7114=3568%:%
%:%7115=3568%:%
%:%7117=3570%:%
%:%7118=3571%:%
%:%7119=3571%:%
%:%7120=3572%:%
%:%7121=3572%:%
%:%7122=3573%:%
%:%7123=3573%:%
%:%7124=3574%:%
%:%7125=3574%:%
%:%7126=3575%:%
%:%7127=3575%:%
%:%7128=3576%:%
%:%7129=3577%:%
%:%7130=3578%:%
%:%7131=3579%:%
%:%7132=3580%:%
%:%7133=3580%:%
%:%7134=3580%:%
%:%7135=3581%:%
%:%7136=3581%:%
%:%7137=3582%:%
%:%7138=3583%:%
%:%7139=3584%:%
%:%7140=3584%:%
%:%7141=3585%:%
%:%7142=3586%:%
%:%7143=3586%:%
%:%7144=3587%:%
%:%7145=3587%:%
%:%7146=3588%:%
%:%7147=3589%:%
%:%7148=3589%:%
%:%7149=3590%:%
%:%7150=3590%:%
%:%7151=3591%:%
%:%7152=3591%:%
%:%7153=3592%:%
%:%7154=3592%:%
%:%7155=3592%:%
%:%7156=3593%:%
%:%7157=3593%:%
%:%7158=3594%:%
%:%7159=3594%:%
%:%7160=3595%:%
%:%7161=3595%:%
%:%7162=3596%:%
%:%7163=3596%:%
%:%7164=3597%:%
%:%7165=3597%:%
%:%7166=3598%:%
%:%7167=3598%:%
%:%7168=3599%:%
%:%7169=3600%:%
%:%7170=3600%:%
%:%7171=3601%:%
%:%7172=3601%:%
%:%7173=3601%:%
%:%7174=3602%:%
%:%7175=3602%:%
%:%7176=3603%:%
%:%7177=3604%:%
%:%7178=3605%:%
%:%7179=3606%:%
%:%7180=3607%:%
%:%7181=3608%:%
%:%7182=3609%:%
%:%7183=3610%:%
%:%7184=3611%:%
%:%7185=3612%:%
%:%7186=3613%:%
%:%7187=3614%:%
%:%7188=3615%:%
%:%7189=3616%:%
%:%7190=3616%:%
%:%7191=3617%:%
%:%7192=3617%:%
%:%7193=3618%:%
%:%7194=3618%:%
%:%7195=3619%:%
%:%7196=3620%:%
%:%7197=3621%:%
%:%7198=3621%:%
%:%7199=3622%:%
%:%7200=3622%:%
%:%7201=3623%:%
%:%7202=3624%:%
%:%7203=3624%:%
%:%7204=3624%:%
%:%7205=3625%:%
%:%7206=3625%:%
%:%7207=3626%:%
%:%7208=3626%:%
%:%7209=3627%:%
%:%7210=3628%:%
%:%7211=3628%:%
%:%7212=3629%:%
%:%7213=3629%:%
%:%7214=3629%:%
%:%7215=3630%:%
%:%7216=3630%:%
%:%7217=3630%:%
%:%7218=3631%:%
%:%7219=3631%:%
%:%7220=3632%:%
%:%7221=3633%:%
%:%7222=3633%:%
%:%7223=3634%:%
%:%7224=3634%:%
%:%7225=3635%:%
%:%7226=3635%:%
%:%7227=3636%:%
%:%7228=3636%:%
%:%7229=3637%:%
%:%7230=3637%:%
%:%7231=3638%:%
%:%7232=3638%:%
%:%7233=3639%:%
%:%7234=3639%:%
%:%7235=3640%:%
%:%7236=3641%:%
%:%7237=3641%:%
%:%7238=3642%:%
%:%7239=3643%:%
%:%7240=3643%:%
%:%7241=3644%:%
%:%7242=3644%:%
%:%7243=3645%:%
%:%7244=3645%:%
%:%7245=3646%:%
%:%7246=3646%:%
%:%7247=3647%:%
%:%7248=3648%:%
%:%7249=3649%:%
%:%7251=3651%:%
%:%7252=3652%:%
%:%7253=3653%:%
%:%7254=3653%:%
%:%7255=3654%:%
%:%7256=3655%:%
%:%7257=3656%:%
%:%7258=3656%:%
%:%7259=3657%:%
%:%7260=3657%:%
%:%7261=3658%:%
%:%7262=3658%:%
%:%7263=3659%:%
%:%7264=3659%:%
%:%7265=3660%:%
%:%7266=3660%:%
%:%7267=3661%:%
%:%7268=3661%:%
%:%7269=3661%:%
%:%7270=3662%:%
%:%7271=3662%:%
%:%7272=3663%:%
%:%7273=3664%:%
%:%7274=3664%:%
%:%7275=3665%:%
%:%7276=3665%:%
%:%7277=3666%:%
%:%7278=3667%:%
%:%7279=3667%:%
%:%7280=3668%:%
%:%7281=3669%:%
%:%7282=3669%:%
%:%7283=3669%:%
%:%7284=3670%:%
%:%7285=3670%:%
%:%7286=3671%:%
%:%7287=3672%:%
%:%7288=3672%:%
%:%7289=3672%:%
%:%7290=3673%:%
%:%7291=3673%:%
%:%7292=3674%:%
%:%7293=3675%:%
%:%7294=3675%:%
%:%7295=3676%:%
%:%7296=3677%:%
%:%7297=3678%:%
%:%7298=3678%:%
%:%7299=3679%:%
%:%7300=3679%:%
%:%7301=3680%:%
%:%7302=3680%:%
%:%7303=3681%:%
%:%7304=3681%:%
%:%7305=3682%:%
%:%7306=3682%:%
%:%7309=3685%:%
%:%7310=3686%:%
%:%7311=3686%:%
%:%7312=3687%:%
%:%7313=3687%:%
%:%7314=3688%:%
%:%7315=3688%:%
%:%7316=3689%:%
%:%7317=3689%:%
%:%7318=3689%:%
%:%7319=3690%:%
%:%7320=3690%:%
%:%7321=3691%:%
%:%7322=3691%:%
%:%7323=3691%:%
%:%7324=3692%:%
%:%7325=3692%:%
%:%7326=3692%:%
%:%7327=3693%:%
%:%7328=3693%:%
%:%7329=3694%:%
%:%7330=3694%:%
%:%7331=3694%:%
%:%7332=3695%:%
%:%7333=3695%:%
%:%7334=3696%:%
%:%7335=3696%:%
%:%7336=3696%:%
%:%7337=3697%:%
%:%7338=3697%:%
%:%7339=3697%:%
%:%7340=3698%:%
%:%7341=3698%:%
%:%7342=3699%:%
%:%7343=3699%:%
%:%7344=3700%:%
%:%7345=3700%:%
%:%7346=3700%:%
%:%7347=3701%:%
%:%7348=3701%:%
%:%7349=3702%:%
%:%7350=3703%:%
%:%7351=3704%:%
%:%7352=3704%:%
%:%7353=3705%:%
%:%7354=3705%:%
%:%7355=3706%:%
%:%7356=3706%:%
%:%7357=3707%:%
%:%7358=3708%:%
%:%7359=3708%:%
%:%7360=3709%:%
%:%7361=3709%:%
%:%7362=3710%:%
%:%7363=3710%:%
%:%7364=3711%:%
%:%7365=3711%:%
%:%7366=3712%:%
%:%7367=3712%:%
%:%7368=3713%:%
%:%7369=3713%:%
%:%7370=3714%:%
%:%7371=3714%:%
%:%7372=3714%:%
%:%7373=3715%:%
%:%7374=3715%:%
%:%7375=3715%:%
%:%7377=3717%:%
%:%7378=3718%:%
%:%7379=3718%:%
%:%7380=3719%:%
%:%7381=3720%:%
%:%7382=3720%:%
%:%7383=3721%:%
%:%7384=3721%:%
%:%7385=3722%:%
%:%7386=3722%:%
%:%7387=3723%:%
%:%7388=3723%:%
%:%7389=3724%:%
%:%7390=3724%:%
%:%7391=3725%:%
%:%7392=3725%:%
%:%7393=3726%:%
%:%7394=3727%:%
%:%7395=3727%:%
%:%7396=3728%:%
%:%7397=3728%:%
%:%7398=3729%:%
%:%7399=3729%:%
%:%7400=3730%:%
%:%7401=3730%:%
%:%7402=3731%:%
%:%7403=3731%:%
%:%7404=3732%:%
%:%7405=3732%:%
%:%7407=3734%:%
%:%7408=3735%:%
%:%7409=3735%:%
%:%7410=3736%:%
%:%7411=3737%:%
%:%7412=3738%:%
%:%7413=3739%:%
%:%7414=3740%:%
%:%7415=3741%:%
%:%7416=3741%:%
%:%7417=3742%:%
%:%7418=3742%:%
%:%7419=3743%:%
%:%7420=3743%:%
%:%7421=3743%:%
%:%7422=3744%:%
%:%7423=3744%:%
%:%7424=3745%:%
%:%7425=3745%:%
%:%7426=3745%:%
%:%7427=3746%:%
%:%7428=3747%:%
%:%7429=3748%:%
%:%7430=3748%:%
%:%7431=3749%:%
%:%7432=3749%:%
%:%7433=3750%:%
%:%7434=3750%:%
%:%7435=3751%:%
%:%7436=3752%:%
%:%7437=3752%:%
%:%7438=3753%:%
%:%7439=3753%:%
%:%7440=3754%:%
%:%7441=3754%:%
%:%7442=3755%:%
%:%7443=3755%:%
%:%7444=3756%:%
%:%7445=3756%:%
%:%7446=3757%:%
%:%7447=3757%:%
%:%7448=3758%:%
%:%7449=3758%:%
%:%7450=3759%:%
%:%7451=3759%:%
%:%7452=3760%:%
%:%7453=3761%:%
%:%7454=3761%:%
%:%7455=3762%:%
%:%7456=3762%:%
%:%7457=3763%:%
%:%7458=3764%:%
%:%7459=3764%:%
%:%7460=3765%:%
%:%7461=3765%:%
%:%7462=3766%:%
%:%7463=3766%:%
%:%7464=3767%:%
%:%7465=3768%:%
%:%7466=3769%:%
%:%7467=3769%:%
%:%7468=3770%:%
%:%7469=3770%:%
%:%7470=3770%:%
%:%7471=3771%:%
%:%7472=3771%:%
%:%7474=3773%:%
%:%7475=3774%:%
%:%7476=3774%:%
%:%7477=3775%:%
%:%7478=3775%:%
%:%7479=3776%:%
%:%7480=3777%:%
%:%7481=3777%:%
%:%7482=3778%:%
%:%7483=3778%:%
%:%7484=3779%:%
%:%7485=3780%:%
%:%7486=3780%:%
%:%7487=3781%:%
%:%7490=3784%:%
%:%7491=3785%:%
%:%7494=3788%:%
%:%7495=3789%:%
%:%7496=3789%:%
%:%7497=3790%:%
%:%7498=3791%:%
%:%7499=3792%:%
%:%7500=3792%:%
%:%7501=3793%:%
%:%7502=3793%:%
%:%7503=3794%:%
%:%7504=3794%:%
%:%7505=3795%:%
%:%7506=3795%:%
%:%7507=3796%:%
%:%7508=3796%:%
%:%7509=3797%:%
%:%7510=3798%:%
%:%7511=3798%:%
%:%7512=3799%:%
%:%7513=3799%:%
%:%7514=3799%:%
%:%7515=3800%:%
%:%7516=3801%:%
%:%7517=3801%:%
%:%7518=3802%:%
%:%7519=3802%:%
%:%7520=3803%:%
%:%7521=3803%:%
%:%7522=3804%:%
%:%7523=3804%:%
%:%7524=3805%:%
%:%7525=3805%:%
%:%7526=3806%:%
%:%7527=3807%:%
%:%7528=3808%:%
%:%7529=3808%:%
%:%7530=3808%:%
%:%7531=3809%:%
%:%7532=3809%:%
%:%7533=3810%:%
%:%7534=3810%:%
%:%7535=3811%:%
%:%7536=3811%:%
%:%7537=3811%:%
%:%7538=3812%:%
%:%7539=3812%:%
%:%7540=3813%:%
%:%7541=3813%:%
%:%7542=3813%:%
%:%7543=3814%:%
%:%7544=3814%:%
%:%7545=3815%:%
%:%7546=3815%:%
%:%7547=3816%:%
%:%7548=3816%:%
%:%7549=3816%:%
%:%7550=3817%:%
%:%7551=3817%:%
%:%7552=3818%:%
%:%7553=3818%:%
%:%7554=3818%:%
%:%7555=3819%:%
%:%7556=3819%:%
%:%7557=3820%:%
%:%7558=3820%:%
%:%7559=3821%:%
%:%7560=3822%:%
%:%7561=3822%:%
%:%7562=3822%:%
%:%7563=3823%:%
%:%7564=3823%:%
%:%7565=3824%:%
%:%7566=3824%:%
%:%7567=3825%:%
%:%7568=3826%:%
%:%7569=3826%:%
%:%7570=3826%:%
%:%7571=3827%:%
%:%7572=3827%:%
%:%7573=3828%:%
%:%7574=3828%:%
%:%7575=3829%:%
%:%7576=3829%:%
%:%7577=3830%:%
%:%7578=3830%:%
%:%7579=3830%:%
%:%7580=3831%:%
%:%7581=3831%:%
%:%7582=3832%:%
%:%7583=3832%:%
%:%7584=3832%:%
%:%7585=3833%:%
%:%7586=3833%:%
%:%7587=3834%:%
%:%7588=3834%:%
%:%7589=3835%:%
%:%7590=3835%:%
%:%7591=3836%:%
%:%7592=3837%:%
%:%7593=3837%:%
%:%7594=3838%:%
%:%7595=3838%:%
%:%7596=3839%:%
%:%7597=3839%:%
%:%7598=3840%:%
%:%7599=3840%:%
%:%7600=3841%:%
%:%7601=3841%:%
%:%7602=3842%:%
%:%7603=3842%:%
%:%7604=3842%:%
%:%7605=3843%:%
%:%7606=3843%:%
%:%7607=3844%:%
%:%7608=3844%:%
%:%7609=3845%:%
%:%7610=3845%:%
%:%7611=3846%:%
%:%7612=3846%:%
%:%7613=3846%:%
%:%7614=3847%:%
%:%7615=3847%:%
%:%7616=3848%:%
%:%7617=3848%:%
%:%7618=3848%:%
%:%7619=3849%:%
%:%7620=3849%:%
%:%7621=3850%:%
%:%7622=3851%:%
%:%7623=3851%:%
%:%7624=3852%:%
%:%7625=3852%:%
%:%7626=3853%:%
%:%7627=3853%:%
%:%7629=3855%:%
%:%7630=3856%:%
%:%7631=3856%:%
%:%7632=3857%:%
%:%7633=3857%:%
%:%7634=3858%:%
%:%7635=3859%:%
%:%7636=3859%:%
%:%7637=3860%:%
%:%7638=3860%:%
%:%7639=3861%:%
%:%7640=3861%:%
%:%7641=3862%:%
%:%7642=3862%:%
%:%7643=3862%:%
%:%7644=3863%:%
%:%7645=3863%:%
%:%7646=3864%:%
%:%7647=3864%:%
%:%7648=3865%:%
%:%7649=3865%:%
%:%7650=3866%:%
%:%7651=3866%:%
%:%7652=3867%:%
%:%7653=3868%:%
%:%7654=3868%:%
%:%7655=3869%:%
%:%7656=3869%:%
%:%7657=3869%:%
%:%7658=3870%:%
%:%7659=3870%:%
%:%7660=3871%:%
%:%7661=3871%:%
%:%7662=3872%:%
%:%7663=3872%:%
%:%7664=3872%:%
%:%7665=3873%:%
%:%7666=3873%:%
%:%7667=3874%:%
%:%7668=3874%:%
%:%7669=3875%:%
%:%7670=3875%:%
%:%7671=3875%:%
%:%7672=3876%:%
%:%7673=3876%:%
%:%7674=3877%:%
%:%7675=3877%:%
%:%7676=3878%:%
%:%7677=3878%:%
%:%7678=3879%:%
%:%7679=3879%:%
%:%7680=3879%:%
%:%7681=3880%:%
%:%7682=3880%:%
%:%7683=3881%:%
%:%7689=3881%:%
%:%7692=3882%:%
%:%7693=3883%:%
%:%7694=3883%:%
%:%7697=3884%:%
%:%7701=3884%:%
%:%7702=3884%:%
%:%7707=3884%:%
%:%7710=3885%:%
%:%7711=3886%:%
%:%7712=3886%:%
%:%7715=3887%:%
%:%7719=3887%:%
%:%7720=3887%:%
%:%7725=3887%:%
%:%7728=3888%:%
%:%7729=3889%:%
%:%7730=3889%:%
%:%7731=3890%:%
%:%7735=3894%:%
%:%7742=3895%:%
%:%7743=3895%:%
%:%7744=3896%:%
%:%7745=3896%:%
%:%7746=3897%:%
%:%7747=3897%:%
%:%7748=3898%:%
%:%7749=3898%:%
%:%7750=3899%:%
%:%7751=3899%:%
%:%7753=3901%:%
%:%7754=3902%:%
%:%7755=3902%:%
%:%7756=3903%:%
%:%7757=3903%:%
%:%7758=3904%:%
%:%7759=3904%:%
%:%7760=3905%:%
%:%7761=3905%:%
%:%7762=3906%:%
%:%7763=3907%:%
%:%7764=3907%:%
%:%7765=3908%:%
%:%7766=3908%:%
%:%7767=3909%:%
%:%7768=3909%:%
%:%7769=3910%:%
%:%7770=3910%:%
%:%7771=3911%:%
%:%7772=3911%:%
%:%7773=3912%:%
%:%7774=3912%:%
%:%7775=3913%:%
%:%7776=3913%:%
%:%7777=3914%:%
%:%7778=3914%:%
%:%7779=3915%:%
%:%7780=3916%:%
%:%7781=3916%:%
%:%7782=3917%:%
%:%7783=3917%:%
%:%7784=3918%:%
%:%7785=3918%:%
%:%7786=3918%:%
%:%7787=3918%:%
%:%7788=3919%:%
%:%7789=3919%:%
%:%7790=3920%:%
%:%7791=3920%:%
%:%7793=3922%:%
%:%7794=3923%:%
%:%7795=3923%:%
%:%7796=3924%:%
%:%7797=3924%:%
%:%7798=3925%:%
%:%7799=3925%:%
%:%7800=3925%:%
%:%7801=3926%:%
%:%7802=3926%:%
%:%7803=3927%:%
%:%7804=3927%:%
%:%7805=3928%:%
%:%7806=3928%:%
%:%7807=3929%:%
%:%7808=3929%:%
%:%7809=3930%:%
%:%7810=3930%:%
%:%7811=3931%:%
%:%7812=3931%:%
%:%7813=3931%:%
%:%7814=3932%:%
%:%7815=3932%:%
%:%7816=3933%:%
%:%7817=3933%:%
%:%7818=3934%:%
%:%7819=3935%:%
%:%7820=3936%:%
%:%7821=3936%:%
%:%7822=3937%:%
%:%7823=3938%:%
%:%7824=3938%:%
%:%7825=3939%:%
%:%7826=3940%:%
%:%7827=3941%:%
%:%7828=3942%:%
%:%7829=3942%:%
%:%7830=3943%:%
%:%7831=3944%:%
%:%7832=3944%:%
%:%7833=3945%:%
%:%7834=3946%:%
%:%7835=3946%:%
%:%7836=3947%:%
%:%7837=3947%:%
%:%7838=3947%:%
%:%7839=3948%:%
%:%7840=3948%:%
%:%7842=3950%:%
%:%7843=3951%:%
%:%7844=3951%:%
%:%7845=3952%:%
%:%7846=3953%:%
%:%7847=3954%:%
%:%7848=3954%:%
%:%7849=3954%:%
%:%7850=3955%:%
%:%7851=3955%:%
%:%7852=3956%:%
%:%7853=3956%:%
%:%7854=3957%:%
%:%7855=3958%:%
%:%7856=3959%:%
%:%7857=3959%:%
%:%7858=3960%:%
%:%7859=3960%:%
%:%7860=3961%:%
%:%7861=3961%:%
%:%7862=3962%:%
%:%7863=3962%:%
%:%7864=3963%:%
%:%7865=3963%:%
%:%7866=3964%:%
%:%7867=3964%:%
%:%7868=3965%:%
%:%7869=3965%:%
%:%7870=3966%:%
%:%7871=3966%:%
%:%7872=3966%:%
%:%7873=3967%:%
%:%7874=3967%:%
%:%7875=3968%:%
%:%7876=3968%:%
%:%7877=3969%:%
%:%7878=3969%:%
%:%7879=3970%:%
%:%7880=3970%:%
%:%7881=3970%:%
%:%7882=3971%:%
%:%7883=3971%:%
%:%7884=3972%:%
%:%7885=3972%:%
%:%7886=3973%:%
%:%7887=3973%:%
%:%7888=3973%:%
%:%7889=3974%:%
%:%7890=3974%:%
%:%7891=3975%:%
%:%7892=3975%:%
%:%7893=3975%:%
%:%7894=3976%:%
%:%7895=3976%:%
%:%7896=3976%:%
%:%7897=3977%:%
%:%7898=3977%:%
%:%7899=3977%:%
%:%7900=3978%:%
%:%7901=3978%:%
%:%7902=3979%:%
%:%7903=3979%:%
%:%7904=3980%:%
%:%7905=3980%:%
%:%7906=3981%:%
%:%7907=3981%:%
%:%7908=3982%:%
%:%7909=3982%:%
%:%7910=3983%:%
%:%7911=3983%:%
%:%7912=3984%:%
%:%7913=3984%:%
%:%7914=3985%:%
%:%7915=3985%:%
%:%7916=3985%:%
%:%7917=3986%:%
%:%7918=3987%:%
%:%7919=3987%:%
%:%7920=3988%:%
%:%7921=3988%:%
%:%7922=3989%:%
%:%7923=3989%:%
%:%7924=3990%:%
%:%7925=3990%:%
%:%7926=3991%:%
%:%7927=3991%:%
%:%7928=3992%:%
%:%7929=3992%:%
%:%7930=3993%:%
%:%7931=3993%:%
%:%7932=3993%:%
%:%7933=3994%:%
%:%7934=3994%:%
%:%7935=3995%:%
%:%7936=3995%:%
%:%7937=3996%:%
%:%7938=3996%:%
%:%7939=3997%:%
%:%7940=3998%:%
%:%7941=3998%:%
%:%7942=3998%:%
%:%7943=3999%:%
%:%7944=3999%:%
%:%7945=3999%:%
%:%7946=4000%:%
%:%7947=4001%:%
%:%7948=4002%:%
%:%7949=4003%:%
%:%7950=4004%:%
%:%7951=4005%:%
%:%7952=4005%:%
%:%7953=4006%:%
%:%7954=4006%:%
%:%7955=4007%:%
%:%7956=4007%:%
%:%7957=4008%:%
%:%7958=4008%:%
%:%7959=4009%:%
%:%7960=4009%:%
%:%7961=4010%:%
%:%7962=4011%:%
%:%7963=4012%:%
%:%7964=4012%:%
%:%7965=4013%:%
%:%7966=4013%:%
%:%7967=4014%:%
%:%7968=4014%:%
%:%7969=4015%:%
%:%7970=4015%:%
%:%7971=4016%:%
%:%7972=4017%:%
%:%7973=4017%:%
%:%7974=4017%:%
%:%7975=4018%:%
%:%7976=4018%:%
%:%7977=4019%:%
%:%7978=4019%:%
%:%7979=4019%:%
%:%7980=4020%:%
%:%7981=4020%:%
%:%7982=4021%:%
%:%7983=4022%:%
%:%7984=4022%:%
%:%7985=4023%:%
%:%7986=4023%:%
%:%7987=4024%:%
%:%7988=4025%:%
%:%7989=4025%:%
%:%7990=4026%:%
%:%7991=4026%:%
%:%7992=4027%:%
%:%7993=4027%:%
%:%7994=4028%:%
%:%7995=4028%:%
%:%7996=4028%:%
%:%7997=4029%:%
%:%7998=4029%:%
%:%7999=4030%:%
%:%8000=4030%:%
%:%8001=4031%:%
%:%8002=4031%:%
%:%8003=4032%:%
%:%8004=4032%:%
%:%8005=4032%:%
%:%8006=4033%:%
%:%8007=4033%:%
%:%8008=4033%:%
%:%8009=4034%:%
%:%8010=4034%:%
%:%8011=4034%:%
%:%8012=4035%:%
%:%8013=4035%:%
%:%8014=4035%:%
%:%8015=4036%:%
%:%8016=4036%:%
%:%8017=4036%:%
%:%8018=4037%:%
%:%8019=4038%:%
%:%8020=4038%:%
%:%8021=4039%:%
%:%8022=4039%:%
%:%8023=4040%:%
%:%8024=4041%:%
%:%8025=4042%:%
%:%8026=4042%:%
%:%8027=4042%:%
%:%8029=4044%:%
%:%8030=4045%:%
%:%8031=4045%:%
%:%8032=4046%:%
%:%8033=4047%:%
%:%8034=4047%:%
%:%8035=4048%:%
%:%8036=4049%:%
%:%8037=4049%:%
%:%8038=4049%:%
%:%8039=4049%:%
%:%8040=4050%:%
%:%8041=4050%:%
%:%8042=4051%:%
%:%8043=4052%:%
%:%8044=4052%:%
%:%8045=4052%:%
%:%8046=4053%:%
%:%8047=4053%:%
%:%8048=4054%:%
%:%8049=4054%:%
%:%8050=4055%:%
%:%8051=4056%:%
%:%8052=4056%:%
%:%8053=4057%:%
%:%8054=4057%:%
%:%8055=4058%:%
%:%8056=4058%:%
%:%8057=4058%:%
%:%8058=4059%:%
%:%8059=4059%:%
%:%8060=4060%:%
%:%8061=4060%:%
%:%8062=4061%:%
%:%8063=4061%:%
%:%8064=4062%:%
%:%8065=4063%:%
%:%8071=4063%:%
%:%8074=4064%:%
%:%8075=4065%:%
%:%8076=4065%:%
%:%8077=4066%:%
%:%8078=4066%:%
%:%8079=4067%:%
%:%8080=4067%:%
%:%8081=4068%:%
%:%8082=4069%:%
%:%8083=4069%:%
%:%8084=4070%:%
%:%8086=4072%:%
%:%8089=4073%:%
%:%8093=4073%:%
%:%8094=4073%:%
%:%8095=4074%:%
%:%8096=4074%:%
%:%8101=4074%:%
%:%8104=4075%:%
%:%8105=4076%:%
%:%8106=4076%:%
%:%8107=4077%:%
%:%8111=4081%:%
%:%8118=4082%:%
%:%8119=4082%:%
%:%8120=4083%:%
%:%8121=4083%:%
%:%8122=4084%:%
%:%8123=4084%:%
%:%8124=4085%:%
%:%8125=4085%:%
%:%8126=4086%:%
%:%8127=4086%:%
%:%8129=4088%:%
%:%8130=4089%:%
%:%8131=4089%:%
%:%8132=4090%:%
%:%8133=4090%:%
%:%8134=4091%:%
%:%8135=4091%:%
%:%8136=4092%:%
%:%8137=4092%:%
%:%8138=4093%:%
%:%8139=4094%:%
%:%8140=4094%:%
%:%8141=4095%:%
%:%8142=4095%:%
%:%8143=4096%:%
%:%8144=4096%:%
%:%8145=4097%:%
%:%8146=4097%:%
%:%8147=4098%:%
%:%8148=4098%:%
%:%8149=4099%:%
%:%8150=4099%:%
%:%8151=4100%:%
%:%8152=4100%:%
%:%8153=4101%:%
%:%8154=4101%:%
%:%8155=4102%:%
%:%8156=4103%:%
%:%8157=4103%:%
%:%8158=4104%:%
%:%8159=4104%:%
%:%8160=4105%:%
%:%8161=4105%:%
%:%8162=4105%:%
%:%8163=4105%:%
%:%8164=4106%:%
%:%8165=4106%:%
%:%8166=4107%:%
%:%8167=4107%:%
%:%8168=4108%:%
%:%8169=4109%:%
%:%8170=4109%:%
%:%8171=4110%:%
%:%8172=4110%:%
%:%8173=4111%:%
%:%8174=4111%:%
%:%8175=4111%:%
%:%8176=4112%:%
%:%8177=4112%:%
%:%8178=4113%:%
%:%8179=4113%:%
%:%8180=4114%:%
%:%8181=4114%:%
%:%8182=4115%:%
%:%8183=4115%:%
%:%8184=4116%:%
%:%8185=4116%:%
%:%8186=4117%:%
%:%8187=4117%:%
%:%8188=4117%:%
%:%8189=4118%:%
%:%8190=4118%:%
%:%8191=4119%:%
%:%8192=4120%:%
%:%8193=4120%:%
%:%8194=4121%:%
%:%8195=4122%:%
%:%8196=4123%:%
%:%8197=4123%:%
%:%8198=4124%:%
%:%8199=4125%:%
%:%8200=4125%:%
%:%8201=4126%:%
%:%8202=4127%:%
%:%8203=4128%:%
%:%8204=4129%:%
%:%8205=4129%:%
%:%8206=4130%:%
%:%8207=4131%:%
%:%8208=4131%:%
%:%8209=4132%:%
%:%8210=4133%:%
%:%8211=4133%:%
%:%8212=4134%:%
%:%8213=4134%:%
%:%8214=4134%:%
%:%8215=4135%:%
%:%8216=4135%:%
%:%8217=4136%:%
%:%8218=4137%:%
%:%8219=4137%:%
%:%8220=4138%:%
%:%8221=4139%:%
%:%8222=4140%:%
%:%8223=4140%:%
%:%8224=4140%:%
%:%8225=4141%:%
%:%8226=4141%:%
%:%8227=4142%:%
%:%8228=4142%:%
%:%8229=4143%:%
%:%8230=4143%:%
%:%8231=4144%:%
%:%8232=4144%:%
%:%8233=4145%:%
%:%8234=4145%:%
%:%8235=4146%:%
%:%8236=4146%:%
%:%8237=4147%:%
%:%8238=4147%:%
%:%8239=4148%:%
%:%8240=4148%:%
%:%8241=4149%:%
%:%8242=4149%:%
%:%8243=4150%:%
%:%8244=4150%:%
%:%8245=4151%:%
%:%8246=4151%:%
%:%8247=4152%:%
%:%8248=4152%:%
%:%8249=4153%:%
%:%8250=4153%:%
%:%8251=4154%:%
%:%8252=4154%:%
%:%8253=4154%:%
%:%8254=4155%:%
%:%8255=4155%:%
%:%8256=4156%:%
%:%8257=4156%:%
%:%8258=4157%:%
%:%8259=4157%:%
%:%8260=4157%:%
%:%8261=4158%:%
%:%8262=4158%:%
%:%8263=4159%:%
%:%8264=4159%:%
%:%8265=4159%:%
%:%8266=4160%:%
%:%8267=4160%:%
%:%8268=4160%:%
%:%8269=4161%:%
%:%8270=4161%:%
%:%8271=4161%:%
%:%8272=4162%:%
%:%8273=4162%:%
%:%8274=4163%:%
%:%8275=4164%:%
%:%8276=4164%:%
%:%8277=4165%:%
%:%8278=4165%:%
%:%8279=4166%:%
%:%8280=4166%:%
%:%8281=4167%:%
%:%8282=4167%:%
%:%8283=4168%:%
%:%8284=4168%:%
%:%8285=4169%:%
%:%8286=4169%:%
%:%8287=4170%:%
%:%8288=4170%:%
%:%8289=4170%:%
%:%8290=4171%:%
%:%8291=4172%:%
%:%8292=4172%:%
%:%8293=4173%:%
%:%8294=4173%:%
%:%8295=4174%:%
%:%8296=4174%:%
%:%8297=4175%:%
%:%8298=4175%:%
%:%8299=4176%:%
%:%8300=4176%:%
%:%8301=4177%:%
%:%8302=4177%:%
%:%8303=4178%:%
%:%8304=4178%:%
%:%8305=4178%:%
%:%8306=4179%:%
%:%8307=4179%:%
%:%8308=4180%:%
%:%8309=4180%:%
%:%8310=4181%:%
%:%8311=4181%:%
%:%8312=4182%:%
%:%8313=4183%:%
%:%8314=4183%:%
%:%8315=4183%:%
%:%8316=4184%:%
%:%8317=4184%:%
%:%8318=4184%:%
%:%8319=4185%:%
%:%8320=4186%:%
%:%8321=4187%:%
%:%8322=4188%:%
%:%8323=4189%:%
%:%8324=4190%:%
%:%8325=4190%:%
%:%8326=4191%:%
%:%8327=4191%:%
%:%8328=4192%:%
%:%8329=4192%:%
%:%8330=4193%:%
%:%8331=4193%:%
%:%8332=4194%:%
%:%8333=4194%:%
%:%8334=4195%:%
%:%8335=4196%:%
%:%8336=4197%:%
%:%8337=4197%:%
%:%8338=4198%:%
%:%8339=4198%:%
%:%8340=4199%:%
%:%8341=4199%:%
%:%8342=4200%:%
%:%8343=4200%:%
%:%8344=4201%:%
%:%8345=4202%:%
%:%8346=4202%:%
%:%8347=4202%:%
%:%8348=4203%:%
%:%8349=4203%:%
%:%8350=4204%:%
%:%8351=4204%:%
%:%8352=4205%:%
%:%8353=4206%:%
%:%8354=4206%:%
%:%8355=4207%:%
%:%8356=4207%:%
%:%8357=4208%:%
%:%8358=4209%:%
%:%8359=4210%:%
%:%8360=4210%:%
%:%8361=4211%:%
%:%8362=4211%:%
%:%8363=4211%:%
%:%8364=4212%:%
%:%8365=4212%:%
%:%8366=4213%:%
%:%8367=4214%:%
%:%8368=4214%:%
%:%8369=4215%:%
%:%8370=4215%:%
%:%8371=4216%:%
%:%8372=4217%:%
%:%8373=4217%:%
%:%8374=4218%:%
%:%8375=4218%:%
%:%8376=4219%:%
%:%8377=4219%:%
%:%8379=4221%:%
%:%8380=4222%:%
%:%8381=4222%:%
%:%8382=4223%:%
%:%8383=4223%:%
%:%8384=4224%:%
%:%8385=4224%:%
%:%8390=4229%:%
%:%8391=4230%:%
%:%8392=4230%:%
%:%8393=4231%:%
%:%8394=4232%:%
%:%8395=4232%:%
%:%8396=4232%:%
%:%8397=4233%:%
%:%8398=4233%:%
%:%8399=4234%:%
%:%8400=4234%:%
%:%8401=4235%:%
%:%8402=4235%:%
%:%8403=4236%:%
%:%8404=4236%:%
%:%8405=4237%:%
%:%8406=4237%:%
%:%8407=4238%:%
%:%8408=4238%:%
%:%8411=4241%:%
%:%8412=4242%:%
%:%8413=4242%:%
%:%8414=4243%:%
%:%8415=4244%:%
%:%8416=4244%:%
%:%8417=4245%:%
%:%8418=4245%:%
%:%8419=4246%:%
%:%8420=4246%:%
%:%8421=4247%:%
%:%8422=4248%:%
%:%8423=4248%:%
%:%8424=4249%:%
%:%8425=4249%:%
%:%8426=4250%:%
%:%8427=4251%:%
%:%8428=4251%:%
%:%8429=4252%:%
%:%8430=4252%:%
%:%8431=4253%:%
%:%8432=4253%:%
%:%8433=4253%:%
%:%8434=4254%:%
%:%8435=4254%:%
%:%8436=4254%:%
%:%8437=4255%:%
%:%8438=4255%:%
%:%8439=4255%:%
%:%8440=4256%:%
%:%8441=4256%:%
%:%8442=4256%:%
%:%8443=4257%:%
%:%8444=4257%:%
%:%8445=4257%:%
%:%8446=4258%:%
%:%8447=4259%:%
%:%8448=4259%:%
%:%8449=4260%:%
%:%8450=4260%:%
%:%8451=4261%:%
%:%8452=4262%:%
%:%8453=4263%:%
%:%8454=4263%:%
%:%8455=4263%:%
%:%8458=4266%:%
%:%8459=4267%:%
%:%8460=4267%:%
%:%8461=4268%:%
%:%8462=4269%:%
%:%8463=4269%:%
%:%8464=4270%:%
%:%8465=4271%:%
%:%8466=4271%:%
%:%8467=4271%:%
%:%8468=4271%:%
%:%8469=4272%:%
%:%8470=4272%:%
%:%8471=4273%:%
%:%8472=4274%:%
%:%8473=4274%:%
%:%8474=4274%:%
%:%8475=4275%:%
%:%8476=4275%:%
%:%8477=4276%:%
%:%8478=4276%:%
%:%8479=4277%:%
%:%8480=4278%:%
%:%8481=4278%:%
%:%8482=4279%:%
%:%8483=4279%:%
%:%8484=4280%:%
%:%8485=4280%:%
%:%8486=4280%:%
%:%8487=4281%:%
%:%8488=4281%:%
%:%8489=4282%:%
%:%8490=4282%:%
%:%8491=4283%:%
%:%8492=4283%:%
%:%8493=4284%:%
%:%8494=4285%:%
%:%8500=4285%:%
%:%8503=4286%:%
%:%8504=4287%:%
%:%8505=4287%:%
%:%8506=4288%:%
%:%8507=4288%:%
%:%8508=4289%:%
%:%8509=4289%:%
%:%8510=4290%:%
%:%8511=4291%:%
%:%8512=4291%:%
%:%8513=4292%:%
%:%8515=4294%:%
%:%8518=4295%:%
%:%8522=4295%:%
%:%8523=4295%:%
%:%8524=4296%:%
%:%8525=4296%:%
%:%8530=4296%:%
%:%8533=4297%:%
%:%8534=4298%:%
%:%8535=4298%:%
%:%8536=4299%:%
%:%8539=4300%:%
%:%8543=4300%:%
%:%8544=4300%:%
%:%8549=4300%:%
%:%8552=4301%:%
%:%8553=4302%:%
%:%8554=4302%:%
%:%8555=4303%:%
%:%8556=4304%:%
%:%8559=4305%:%
%:%8563=4305%:%
%:%8564=4305%:%
%:%8565=4306%:%
%:%8566=4306%:%
%:%8571=4306%:%
%:%8574=4307%:%
%:%8575=4308%:%
%:%8576=4308%:%
%:%8577=4309%:%
%:%8581=4313%:%
%:%8588=4314%:%
%:%8589=4314%:%
%:%8590=4315%:%
%:%8591=4315%:%
%:%8592=4316%:%
%:%8593=4316%:%
%:%8594=4316%:%
%:%8595=4317%:%
%:%8596=4317%:%
%:%8597=4317%:%
%:%8598=4318%:%
%:%8599=4318%:%
%:%8600=4319%:%
%:%8601=4319%:%
%:%8602=4320%:%
%:%8603=4320%:%
%:%8604=4320%:%
%:%8605=4321%:%
%:%8606=4321%:%
%:%8607=4321%:%
%:%8608=4322%:%
%:%8609=4322%:%
%:%8610=4323%:%
%:%8611=4323%:%
%:%8612=4324%:%
%:%8613=4324%:%
%:%8614=4324%:%
%:%8615=4325%:%
%:%8616=4325%:%
%:%8617=4325%:%
%:%8618=4326%:%
%:%8619=4326%:%
%:%8620=4327%:%
%:%8621=4327%:%
%:%8622=4328%:%
%:%8623=4328%:%
%:%8624=4328%:%
%:%8625=4329%:%
%:%8626=4329%:%
%:%8627=4329%:%
%:%8628=4330%:%
%:%8629=4330%:%
%:%8630=4331%:%
%:%8631=4331%:%
%:%8632=4332%:%
%:%8633=4332%:%
%:%8634=4332%:%
%:%8635=4333%:%
%:%8636=4333%:%
%:%8637=4333%:%
%:%8638=4334%:%
%:%8639=4334%:%
%:%8640=4335%:%
%:%8641=4335%:%
%:%8642=4336%:%
%:%8643=4336%:%
%:%8644=4336%:%
%:%8645=4337%:%
%:%8646=4337%:%
%:%8647=4337%:%
%:%8648=4338%:%
%:%8649=4338%:%
%:%8650=4339%:%
%:%8651=4339%:%
%:%8652=4340%:%
%:%8653=4340%:%
%:%8654=4340%:%
%:%8655=4341%:%
%:%8656=4341%:%
%:%8657=4341%:%
%:%8658=4342%:%
%:%8659=4342%:%
%:%8660=4343%:%
%:%8661=4343%:%
%:%8662=4344%:%
%:%8663=4344%:%
%:%8664=4344%:%
%:%8665=4345%:%
%:%8666=4345%:%
%:%8667=4345%:%
%:%8668=4346%:%
%:%8669=4346%:%
%:%8670=4347%:%
%:%8671=4347%:%
%:%8672=4348%:%
%:%8673=4348%:%
%:%8674=4348%:%
%:%8675=4349%:%
%:%8676=4349%:%
%:%8677=4349%:%
%:%8678=4350%:%
%:%8679=4350%:%
%:%8680=4351%:%
%:%8681=4351%:%
%:%8682=4352%:%
%:%8683=4352%:%
%:%8684=4352%:%
%:%8685=4353%:%
%:%8686=4353%:%
%:%8687=4353%:%
%:%8688=4354%:%
%:%8689=4354%:%
%:%8690=4355%:%
%:%8691=4355%:%
%:%8692=4356%:%
%:%8693=4356%:%
%:%8694=4356%:%
%:%8695=4357%:%
%:%8696=4357%:%
%:%8697=4357%:%
%:%8698=4358%:%
%:%8699=4358%:%
%:%8700=4359%:%
%:%8701=4359%:%
%:%8702=4360%:%
%:%8703=4360%:%
%:%8704=4360%:%
%:%8705=4361%:%
%:%8706=4361%:%
%:%8707=4361%:%
%:%8708=4362%:%
%:%8709=4362%:%
%:%8710=4363%:%
%:%8711=4363%:%
%:%8712=4364%:%
%:%8713=4364%:%
%:%8714=4364%:%
%:%8715=4365%:%
%:%8716=4365%:%
%:%8717=4365%:%
%:%8718=4366%:%
%:%8724=4366%:%
%:%8727=4367%:%
%:%8728=4368%:%
%:%8729=4368%:%
%:%8730=4369%:%
%:%8731=4370%:%
%:%8732=4371%:%
%:%8733=4372%:%
%:%8734=4373%:%
%:%8735=4374%:%
%:%8736=4375%:%
%:%8737=4376%:%
%:%8738=4377%:%
%:%8741=4378%:%
%:%8745=4378%:%
%:%8746=4378%:%
%:%8747=4379%:%
%:%8752=4379%:%
%:%8755=4380%:%
%:%8756=4381%:%
%:%8757=4381%:%
%:%8758=4382%:%
%:%8759=4383%:%
%:%8762=4384%:%
%:%8766=4384%:%
%:%8767=4384%:%
%:%8768=4384%:%
%:%8773=4384%:%
%:%8776=4385%:%
%:%8777=4386%:%
%:%8778=4386%:%
%:%8779=4387%:%
%:%8780=4388%:%
%:%8781=4389%:%
%:%8782=4390%:%
%:%8783=4391%:%
%:%8784=4392%:%
%:%8785=4393%:%
%:%8786=4394%:%
%:%8787=4395%:%
%:%8790=4396%:%
%:%8794=4396%:%
%:%8795=4396%:%
%:%8796=4397%:%
%:%8797=4397%:%
%:%8798=4398%:%
%:%8799=4399%:%
%:%8800=4399%:%
%:%8801=4400%:%
%:%8802=4400%:%
%:%8803=4400%:%
%:%8804=4401%:%
%:%8805=4402%:%
%:%8806=4402%:%
%:%8807=4403%:%
%:%8808=4403%:%
%:%8809=4404%:%
%:%8810=4405%:%
%:%8811=4405%:%
%:%8812=4406%:%
%:%8813=4406%:%
%:%8814=4406%:%
%:%8815=4407%:%
%:%8816=4408%:%
%:%8817=4408%:%
%:%8818=4409%:%
%:%8819=4409%:%
%:%8820=4410%:%
%:%8821=4411%:%
%:%8822=4411%:%
%:%8823=4412%:%
%:%8824=4412%:%
%:%8825=4412%:%
%:%8826=4413%:%
%:%8827=4414%:%
%:%8828=4414%:%
%:%8829=4415%:%
%:%8830=4415%:%
%:%8831=4415%:%
%:%8832=4416%:%
%:%8833=4417%:%
%:%8839=4417%:%
%:%8842=4418%:%
%:%8843=4419%:%
%:%8844=4419%:%
%:%8845=4420%:%
%:%8847=4422%:%
%:%8854=4423%:%
%:%8855=4423%:%
%:%8856=4424%:%
%:%8857=4424%:%
%:%8858=4425%:%
%:%8859=4425%:%
%:%8860=4425%:%
%:%8861=4426%:%
%:%8862=4426%:%
%:%8863=4427%:%
%:%8864=4427%:%
%:%8865=4428%:%
%:%8866=4428%:%
%:%8867=4429%:%
%:%8868=4429%:%
%:%8869=4429%:%
%:%8870=4430%:%
%:%8871=4430%:%
%:%8872=4430%:%
%:%8873=4431%:%
%:%8874=4431%:%
%:%8875=4432%:%
%:%8876=4432%:%
%:%8877=4433%:%
%:%8878=4433%:%
%:%8879=4433%:%
%:%8880=4434%:%
%:%8881=4434%:%
%:%8882=4434%:%
%:%8883=4435%:%
%:%8884=4435%:%
%:%8885=4436%:%
%:%8886=4436%:%
%:%8887=4437%:%
%:%8888=4437%:%
%:%8889=4437%:%
%:%8890=4438%:%
%:%8891=4438%:%
%:%8892=4439%:%
%:%8893=4439%:%
%:%8894=4440%:%
%:%8895=4440%:%
%:%8896=4441%:%
%:%8897=4441%:%
%:%8898=4441%:%
%:%8899=4442%:%
%:%8900=4442%:%
%:%8901=4443%:%
%:%8902=4443%:%
%:%8903=4444%:%
%:%8904=4444%:%
%:%8905=4445%:%
%:%8906=4445%:%
%:%8907=4445%:%
%:%8908=4446%:%
%:%8909=4446%:%
%:%8910=4446%:%
%:%8911=4447%:%
%:%8912=4447%:%
%:%8913=4448%:%
%:%8914=4448%:%
%:%8915=4449%:%
%:%8916=4449%:%
%:%8917=4449%:%
%:%8918=4450%:%
%:%8919=4450%:%
%:%8920=4450%:%
%:%8921=4451%:%
%:%8922=4451%:%
%:%8923=4452%:%
%:%8924=4452%:%
%:%8925=4453%:%
%:%8926=4453%:%
%:%8927=4453%:%
%:%8928=4454%:%
%:%8929=4454%:%
%:%8930=4455%:%
%:%8931=4455%:%
%:%8932=4456%:%
%:%8933=4456%:%
%:%8934=4457%:%
%:%8935=4457%:%
%:%8936=4457%:%
%:%8937=4458%:%
%:%8938=4458%:%
%:%8939=4458%:%
%:%8940=4459%:%
%:%8941=4459%:%
%:%8942=4460%:%
%:%8943=4460%:%
%:%8944=4461%:%
%:%8945=4461%:%
%:%8946=4461%:%
%:%8947=4462%:%
%:%8948=4462%:%
%:%8949=4463%:%
%:%8950=4463%:%
%:%8951=4464%:%
%:%8952=4464%:%
%:%8953=4465%:%
%:%8954=4465%:%
%:%8955=4466%:%
%:%8956=4466%:%
%:%8957=4467%:%
%:%8958=4468%:%
%:%8964=4468%:%
%:%8967=4469%:%
%:%8968=4470%:%
%:%8969=4470%:%
%:%8970=4471%:%
%:%8971=4472%:%
%:%8972=4473%:%
%:%8973=4474%:%
%:%8974=4475%:%
%:%8975=4476%:%
%:%8976=4477%:%
%:%8977=4478%:%
%:%8978=4479%:%
%:%8981=4480%:%
%:%8985=4480%:%
%:%8986=4480%:%
%:%8987=4481%:%
%:%8988=4482%:%
%:%8989=4483%:%
%:%8990=4484%:%
%:%8995=4484%:%
%:%8998=4485%:%
%:%8999=4486%:%
%:%9000=4486%:%
%:%9001=4487%:%
%:%9002=4487%:%
%:%9003=4488%:%
%:%9004=4488%:%
%:%9005=4489%:%
%:%9006=4489%:%
%:%9007=4490%:%
%:%9008=4490%:%
%:%9009=4491%:%
%:%9010=4491%:%
%:%9011=4492%:%
%:%9012=4493%:%
%:%9013=4493%:%
%:%9014=4494%:%
%:%9015=4495%:%
%:%9016=4496%:%
%:%9019=4497%:%
%:%9023=4497%:%
%:%9024=4497%:%
%:%9025=4498%:%
%:%9026=4498%:%
%:%9027=4499%:%
%:%9032=4499%:%
%:%9035=4506%:%
%:%9036=4507%:%
%:%9037=4507%:%
%:%9038=4508%:%
%:%9039=4508%:%
%:%9040=4509%:%
%:%9041=4510%:%
%:%9042=4510%:%
%:%9044=4512%:%
%:%9045=4513%:%
%:%9046=4514%:%
%:%9047=4515%:%
%:%9048=4515%:%
%:%9049=4516%:%
%:%9053=4520%:%
%:%9056=4521%:%
%:%9060=4521%:%
%:%9061=4521%:%
%:%9066=4521%:%
%:%9069=4522%:%
%:%9070=4523%:%
%:%9071=4523%:%
%:%9072=4524%:%
%:%9073=4524%:%
%:%9074=4525%:%
%:%9075=4526%:%
%:%9076=4526%:%
%:%9077=4527%:%
%:%9081=4531%:%
%:%9084=4532%:%
%:%9088=4532%:%
%:%9089=4532%:%
%:%9090=4533%:%
%:%9091=4534%:%
%:%9096=4534%:%
%:%9099=4535%:%
%:%9100=4536%:%
%:%9101=4536%:%
%:%9104=4537%:%
%:%9108=4537%:%
%:%9109=4537%:%
%:%9110=4537%:%
%:%9115=4537%:%
%:%9118=4538%:%
%:%9119=4538%:%
%:%9120=4539%:%
%:%9121=4540%:%
%:%9122=4540%:%
%:%9125=4541%:%
%:%9129=4541%:%
%:%9130=4541%:%
%:%9131=4541%:%
%:%9136=4541%:%
%:%9139=4542%:%
%:%9140=4542%:%
%:%9141=4543%:%
%:%9142=4544%:%
%:%9143=4544%:%
%:%9144=4545%:%
%:%9147=4546%:%
%:%9151=4546%:%
%:%9152=4546%:%
%:%9153=4546%:%
%:%9158=4546%:%
%:%9161=4547%:%
%:%9162=4547%:%
%:%9163=4548%:%
%:%9164=4549%:%
%:%9165=4549%:%
%:%9168=4552%:%
%:%9169=4553%:%
%:%9170=4554%:%
%:%9171=4554%:%
%:%9173=4556%:%
%:%9174=4557%:%
%:%9175=4558%:%
%:%9176=4558%:%
%:%9177=4559%:%
%:%9178=4560%:%
%:%9179=4560%:%
%:%9180=4561%:%
%:%9181=4562%:%
%:%9182=4563%:%
%:%9183=4564%:%
%:%9184=4565%:%
%:%9185=4566%:%
%:%9186=4567%:%
%:%9187=4568%:%
%:%9188=4569%:%
%:%9189=4570%:%
%:%9190=4571%:%
%:%9191=4572%:%
%:%9192=4573%:%
%:%9193=4573%:%
%:%9194=4574%:%
%:%9195=4575%:%
%:%9196=4576%:%
%:%9197=4577%:%
%:%9198=4578%:%
%:%9199=4579%:%
%:%9200=4580%:%
%:%9201=4581%:%
%:%9204=4582%:%
%:%9208=4582%:%
%:%9209=4582%:%
%:%9210=4583%:%
%:%9211=4584%:%
%:%9212=4584%:%
%:%9213=4585%:%
%:%9214=4586%:%
%:%9215=4587%:%
%:%9220=4587%:%
%:%9223=4588%:%
%:%9224=4589%:%
%:%9225=4589%:%
%:%9226=4590%:%
%:%9227=4590%:%
%:%9228=4591%:%
%:%9229=4592%:%
%:%9230=4593%:%
%:%9231=4594%:%
%:%9232=4594%:%
%:%9235=4595%:%
%:%9239=4595%:%
%:%9240=4595%:%
%:%9241=4596%:%
%:%9242=4596%:%
%:%9243=4597%:%
%:%9244=4598%:%
%:%9245=4598%:%
%:%9250=4598%:%
%:%9253=4599%:%
%:%9254=4600%:%
%:%9255=4600%:%
%:%9256=4601%:%
%:%9258=4603%:%
%:%9259=4604%:%
%:%9260=4605%:%
%:%9261=4606%:%
%:%9262=4607%:%
%:%9265=4608%:%
%:%9269=4608%:%
%:%9270=4608%:%
%:%9271=4609%:%
%:%9272=4609%:%
%:%9273=4610%:%
%:%9274=4611%:%
%:%9275=4612%:%
%:%9276=4613%:%
%:%9277=4614%:%
%:%9278=4615%:%
%:%9279=4616%:%
%:%9280=4617%:%
%:%9281=4618%:%
%:%9282=4619%:%
%:%9287=4619%:%
%:%9290=4634%:%
%:%9291=4635%:%
%:%9292=4635%:%
%:%9293=4636%:%
%:%9294=4636%:%
%:%9295=4637%:%
%:%9296=4637%:%
%:%9303=4638%:%
